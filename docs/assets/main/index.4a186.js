window.__require=function e(t,o,n){function r(s,a){if(!o[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var l=o[s]={exports:{}};t[s][0].call(l.exports,function(e){return r(t[s][1][e]||e)},l,l.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<n.length;s++)r(n[s]);return r}({AnimationSettings:[function(e,t,o){"use strict";cc._RF.push(t,"13f76VL0CtFBLEWnhcGu5ul","AnimationSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnimationSettings=void 0;var n=e("./AnimationType"),r=function(){function e(){}return e.fadeOverlay=function(e){return{type:n.AnimationType.FADE,node:e,duration:.25,targetOpacity:140}},e.tileFall=function(e,t){return{type:n.AnimationType.GRAVITY_FALL,node:e,duration:.3,targetY:t,bounce:15,bounceDuration:.12,settleDuration:.12,easing:"quadIn"}},e.tileDestroy=function(e){return{type:n.AnimationType.DESTRUCTION,node:e,squashDuration:.05,squashScale:.95,popDuration:.03,popScale:1.2,shrinkDuration:.3,shrinkOpacity:0,shrinkScale:.2}},e.tileShake=function(e){return{type:n.AnimationType.SHAKE,node:e,amplitude:8}},e}();o.AnimationSettings=r,cc._RF.pop()},{"./AnimationType":"AnimationType"}],AnimationSystem:[function(e,t,o){"use strict";cc._RF.push(t,"bf5e3gysNtMo6IwY0sL61qx","AnimationSystem"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnimationSystem=void 0;var n=e("../../../../core/utils/assert"),r=e("./DestructionAnimation"),i=e("./FadeAnimation"),s=e("./GravityFallAnimation"),a=e("./ShakeAnimation"),c=function(){function e(){this.animations=new Map,this.register()}return e.prototype.register=function(){this.add(new r.DestructionAnimation),this.add(new i.FadeAnimation),this.add(new s.GravityFallAnimation),this.add(new a.ShakeAnimation)},e.prototype.add=function(e){this.animations.set(e.type,e)},e.prototype.play=function(e){var t=this.animations.get(e.type);return n.assertNotNull(t,this,"animation"),t.play(e)},e}();o.AnimationSystem=c,cc._RF.pop()},{"../../../../core/utils/assert":"assert","./DestructionAnimation":"DestructionAnimation","./FadeAnimation":"FadeAnimation","./GravityFallAnimation":"GravityFallAnimation","./ShakeAnimation":"ShakeAnimation"}],AnimationType:[function(e,t,o){"use strict";cc._RF.push(t,"979d9lb321ALprJzeO9CLWi","AnimationType"),Object.defineProperty(o,"__esModule",{value:!0}),o.AnimationType=void 0,function(e){e[e.FADE=0]="FADE",e[e.DESTRUCTION=1]="DESTRUCTION",e[e.GRAVITY_FALL=2]="GRAVITY_FALL",e[e.SHAKE=3]="SHAKE"}(o.AnimationType||(o.AnimationType={})),cc._RF.pop()},{}],BaseConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"062f5ambD5N9JvTzMqt3cqH","BaseConfigProvider"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseConfigProvider=void 0;var n=e("../utils/assert"),r=function(){function e(){}return e.prototype.get=function(){return n.assertNotNull(this.config,this,"config"),this.config},e}();o.BaseConfigProvider=r,cc._RF.pop()},{"../utils/assert":"assert"}],BaseController:[function(e,t,o){"use strict";cc._RF.push(t,"badd4D/MYpB0pfYbiXf2xQf","BaseController"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseController=void 0;var n=function(){function e(){this._initialized=!1}return e.prototype.init=function(){this._initialized||(this._initialized=!0,this.onInit())},e.prototype.dispose=function(){this._initialized&&this.onDispose()},e.prototype.onDispose=function(){},e}();o.BaseController=n,cc._RF.pop()},{}],BoardController:[function(e,t,o){"use strict";cc._RF.push(t,"822885m60hJ9aKNQsvvr2h0","BoardController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoardController=void 0;var r=e("../../../../core/events/SubscriptionGroup"),i=e("../../../domain/board/events/BoardProcessedEvent"),s=e("../../../domain/board/events/BoardProcessingEvent"),a=e("../../../domain/board/events/TileClickRejectedEvent"),c=e("../../../presentation/core/events/TileClickedEvent"),u=function(e){function t(t){var o=e.call(this)||this;return o._subscriptions=new r.SubscriptionGroup,o.onTileClicked=function(e){if("IDLE"===o._gameStateModel.state){var t=o._searchService.findCluster(e.position);if(t.length<o._gameConfig.clusterSize)o._eventBus.emit(new a.TileClickRejectedEvent(e.position));else{o._eventBus.emit(new s.BoardProcessingEvent);var n=o._clearService.clear(t),r=o._searchService.findDrops();o._moveService.move(r);var c=o._spawnService.spawn(),u=o._boardModel.flush();o._eventBus.emit(new i.BoardChangedEvent(n,r,c,u))}}},o._gameConfig=t.gameConfig,o._eventBus=t.eventBus,o._gameStateModel=t.gameStateModel,o._boardModel=t.boardModel,o._spawnService=t.spawnService,o._searchService=t.searchService,o._clearService=t.clearService,o._moveService=t.moveService,o}return n(t,e),t.prototype.onInit=function(){this._subscriptions.add(this._eventBus.on(c.TileClickedEvent,this.onTileClicked))},t.prototype.dispose=function(){this._subscriptions.clear()},t}(e("../../core/controllers/BaseController").BaseController);o.BoardController=u,cc._RF.pop()},{"../../../../core/events/SubscriptionGroup":"SubscriptionGroup","../../../domain/board/events/BoardProcessedEvent":"BoardProcessedEvent","../../../domain/board/events/BoardProcessingEvent":"BoardProcessingEvent","../../../domain/board/events/TileClickRejectedEvent":"TileClickRejectedEvent","../../../presentation/core/events/TileClickedEvent":"TileClickedEvent","../../core/controllers/BaseController":"BaseController"}],BoardFxLayer:[function(e,t,o){"use strict";cc._RF.push(t,"42649YVYJFMy68BkAClmhK6","BoardFxLayer");var n=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardFxLayer=void 0;var i=e("../../core/animations/AnimationSettings"),s=e("../view/TileView"),a=function(){function e(e,t,o,n){this.animationSystem=e,this.backgroundLayer=t,this.fxLayer=o,this.tileAssets=n,this.pool=[]}return e.prototype.clone=function(e){var t=this.pool.pop(),o=e.node;t&&cc.isValid(t)||(t=cc.instantiate(o)),t.setParent(this.fxLayer),t.active=!0,t.setPosition(o.getPosition()),t.scale=o.scale,t.opacity=o.opacity;var n=t.getComponent(s.TileView);return n.set(e.get().clone()),n},e.prototype.release=function(e){cc.isValid(e)&&(cc.Tween.stopAllByTarget(e),e.active=!1,e.removeFromParent(!1),this.pool.push(e))},e.prototype.destroy=function(e){return n(this,void 0,Promise,function(){var t;return r(this,function(o){switch(o.label){case 0:return(t=this.clone(e)).node.setParent(this.backgroundLayer),[4,this.animationSystem.play(i.AnimationSettings.tileDestroy(t.node))];case 1:return o.sent(),this.release(t.node),[2]}})})},e.prototype.drop=function(e,t){return n(this,void 0,Promise,function(){var o;return r(this,function(n){switch(n.label){case 0:return(o=this.clone(e)).node.setParent(this.fxLayer),[4,this.animationSystem.play(i.AnimationSettings.tileFall(o.node,t.y))];case 1:return n.sent(),this.release(o.node),[2]}})})},e.prototype.spawn=function(e,t,o,s){return n(this,void 0,Promise,function(){var n;return r(this,function(r){switch(r.label){case 0:return(n=this.clone(e)).set(this.tileAssets.get(s)),n.node.setPosition(t),[4,this.animationSystem.play(i.AnimationSettings.tileFall(n.node,o.y))];case 1:return r.sent(),this.release(n.node),[2]}})})},e.prototype.shake=function(e){return n(this,void 0,Promise,function(){var t;return r(this,function(o){switch(o.label){case 0:return t=this.clone(e),[4,this.animationSystem.play(i.AnimationSettings.tileShake(t.node))];case 1:return o.sent(),this.release(t.node),[2]}})})},e}();o.BoardFxLayer=a,cc._RF.pop()},{"../../core/animations/AnimationSettings":"AnimationSettings","../view/TileView":"TileView"}],BoardMap:[function(e,t,o){"use strict";cc._RF.push(t,"17134ZLr7FNdqySxDkq2Kox","BoardMap"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardMap=void 0;var n=e("../../../domain/board/models/TilePosition"),r=function(){function e(e,t){this._boardWidth=e,this._boardHeight=t,this._map=new Map}return e.prototype.get=function(e){var t=this._map.get(this.key(e));return null!==t&&void 0!==t?t:null},e.prototype.set=function(e,t){this._map.set(this.key(e),t)},e.prototype.delete=function(e){this._map.delete(this.key(e))},e.prototype.key=function(e){return n.TilePosition.key(e,this._boardWidth)},e}();o.BoardMap=r,cc._RF.pop()},{"../../../domain/board/models/TilePosition":"TilePosition"}],BoardModel:[function(e,t,o){"use strict";cc._RF.push(t,"c0cfdX5W71DYbOfvKjFE2e8","BoardModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardModel=void 0;var n=e("../../../../core/collections/Matrix"),r=e("./TilePosition"),i=e("./TileType"),s=function(){function e(e,t){this._board=new n.Matrix(e,t,function(){return i.TileType.NONE}),this._changes=new Map}return Object.defineProperty(e.prototype,"width",{get:function(){return this._board.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._board.height},enumerable:!1,configurable:!0}),e.prototype.flush=function(){var e=Array.from(this._changes.values());return this._changes.clear(),e},e.prototype.get=function(e){return this._board.get(e.x,e.y)},e.prototype.empty=function(e){return this._board.get(e.x,e.y)==i.TileType.NONE},e.prototype.spawn=function(e){this.setType(e.at,e.type)},e.prototype.move=function(e){var t=this.get(e.from);this.setType(e.to,t),this.setType(e.from,i.TileType.NONE)},e.prototype.destroy=function(e){this.setType(e,i.TileType.NONE)},e.prototype.setType=function(e,t){var o=this.get(e);o!==t&&(this.pushChange(e,o,t),this._board.set(e.x,e.y,t))},e.prototype.pushChange=function(e,t,o){var n=r.TilePosition.key(e,this.width),i=this._changes.get(n);i?i.after=o:(i={position:e,before:t,after:o},this._changes.set(n,i))},e}();o.BoardModel=s,cc._RF.pop()},{"../../../../core/collections/Matrix":"Matrix","./TilePosition":"TilePosition","./TileType":"TileType"}],BoardProcessedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"be7a8ThjkJAZZsa9GwbrkxW","BoardProcessedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardChangedEvent=void 0;var n=function(){return function(e,t,o,n){this.destroyed=e,this.dropped=t,this.spawned=o,this.changes=n}}();o.BoardChangedEvent=n,cc._RF.pop()},{}],BoardProcessingEvent:[function(e,t,o){"use strict";cc._RF.push(t,"7301avaHaVDVqt3Td2USTNf","BoardProcessingEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardProcessingEvent=void 0;var n=function(){return function(){}}();o.BoardProcessingEvent=n,cc._RF.pop()},{}],BoardRuntime:[function(e,t,o){"use strict";cc._RF.push(t,"572aergUVNGKqkxCw45gKM7","BoardRuntime"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardRuntime=o.TileLockReason=void 0;var n,r=e("../../../../core/collections/Matrix");(function(e){e[e.NONE=0]="NONE",e[e.DESTROY=1]="DESTROY",e[e.DROP=2]="DROP",e[e.SPAWN=4]="SPAWN",e[e.SWAP=8]="SWAP"})(n=o.TileLockReason||(o.TileLockReason={}));var i=function(){function e(e,t){this.locks=new r.Matrix(e,t,function(){return n.NONE})}return e.prototype.isLocked=function(e){return this.locks.get(e.x,e.y)!==n.NONE},e.prototype.lock=function(e,t){var o=this.locks.get(e.x,e.y);this.locks.set(e.x,e.y,o|t)},e.prototype.unlock=function(e,t){var o=this.locks.get(e.x,e.y);this.locks.set(e.x,e.y,o&~t)},e.prototype.clear=function(e){this.locks.set(e.x,e.y,n.NONE)},e.prototype.snapshot=function(){for(var e=[],t=0;t<this.locks.width;t++)for(var o=0;o<this.locks.height;o++)this.locks.get(t,o)!==n.NONE&&e.push({x:t,y:o});return e},e}();o.BoardRuntime=i,cc._RF.pop()},{"../../../../core/collections/Matrix":"Matrix"}],BoardSyncedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"41b9argyZFG0aJxv/Hrpryd","BoardSyncedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardSyncedEvent=void 0;var n=function(){return function(){}}();o.BoardSyncedEvent=n,cc._RF.pop()},{}],BoardViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"493d5P3Og5P2pe7KPcaugF9","BoardViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"bb883j+cbZB3Jz/i+gZlUKc","BoardView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},i=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardView=void 0;var a=e("../../../domain/board/events/BoardProcessedEvent"),c=e("../../../domain/board/events/TileClickRejectedEvent"),u=e("../../../domain/board/models/TileType"),l=e("../../core/assets/TileAssets"),p=e("../../core/events/BoardSyncedEvent"),d=e("../../core/view/EventView"),f=e("../fx/BoardFxLayer"),h=e("./BoardMap"),v=e("./TileView"),y=cc._decorator,_=y.ccclass,b=y.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefab=null,t.backgroundLayer=null,t.tileLayer=null,t.fxLayer=null,t.tileAssets=null,t.onBoardChanged=function(e){return i(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.animate(e)];case 1:return t.sent(),this.syncBoard(e.changes),[2]}})})},t.onTileClickRejected=function(e){return i(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.animateShake(e.position)];case 1:return t.sent(),[2]}})})},t}return n(t,e),t.prototype.onInit=function(){this.boardMap=new h.BoardMap(this.context.boardWidth,this.context.boardHeight),this.fx=new f.BoardFxLayer(this.context.animationSystem,this.backgroundLayer,this.fxLayer,this.tileAssets),this.drawBoard(this.context.initialBoard),this.on(a.BoardChangedEvent,this.onBoardChanged),this.on(c.TileClickRejectedEvent,this.onTileClickRejected)},t.prototype.syncBoard=function(e){this.drawBoard(e),this.emit(new p.BoardSyncedEvent)},t.prototype.drawBoard=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t],r=this.boardMap.get(n.position);if(n.after!==u.TileType.NONE){r||(r=this.createTile(n.position),this.boardMap.set(n.position,r)),r.set(this.tileAssets.get(n.after));var i=this.getLocalPosition(n.position,r.node);r.node.setPosition(i),r.show()}else r&&(r.node.destroy(),this.boardMap.delete(n.position))}},t.prototype.animate=function(e){return i(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.animateDestroy(e.destroyed),this.animateDrop(e.dropped),this.animateSpawn(e.spawned)])];case 1:return t.sent(),[2]}})})},t.prototype.animateDestroy=function(e){return i(this,void 0,void 0,function(){var t,o,n,r,i;return s(this,function(s){switch(s.label){case 0:for(t=[],o=0,n=e;o<n.length;o++)r=n[o],(i=this.boardMap.get(r))&&(i.hide(),t.push(this.fx.destroy(i)));return[4,Promise.all(t)];case 1:return s.sent(),[2]}})})},t.prototype.animateDrop=function(e){return i(this,void 0,void 0,function(){var t,o,n,r,i,a;return s(this,function(s){switch(s.label){case 0:for(t=[],o=0,n=e;o<n.length;o++)r=n[o],(i=this.boardMap.get(r.from))&&(i.hide(),a=this.getLocalPosition(r.to,i.node),t.push(this.fx.drop(i,a)));return[4,Promise.all(t)];case 1:return s.sent(),[2]}})})},t.prototype.animateSpawn=function(e){return i(this,void 0,void 0,function(){var t,o,n,r,i,a,c;return s(this,function(s){switch(s.label){case 0:for(t=[],o=0,n=e;o<n.length;o++)r=n[o],(i=this.boardMap.get(r.at))&&(a=this.getLocalPosition(r.at,i.node),(c=a.clone()).y+=2*i.node.height,t.push(this.fx.spawn(i,c,a,r.type)));return[4,Promise.all(t)];case 1:return s.sent(),[2]}})})},t.prototype.animateShake=function(e){return i(this,void 0,void 0,function(){var t;return s(this,function(o){switch(o.label){case 0:return(t=this.boardMap.get(e))?(t.hide(),[4,this.fx.shake(t)]):[2];case 1:return o.sent(),t.show(),[2]}})})},t.prototype.getLocalPosition=function(e,t){var o=-(this.context.boardWidth-1)*t.width/2,n=(this.context.boardHeight-1)*t.height/2;return cc.v3(o+e.x*t.width,n-e.y*t.height,0)},t.prototype.createTile=function(e){var t=cc.instantiate(this.tilePrefab);t.setParent(this.tileLayer);var o=t.getComponent(v.TileView);return o.init({eventBus:this.eventBus,position:e}),o},r([b(cc.Prefab)],t.prototype,"tilePrefab",void 0),r([b(cc.Node)],t.prototype,"backgroundLayer",void 0),r([b(cc.Node)],t.prototype,"tileLayer",void 0),r([b(cc.Node)],t.prototype,"fxLayer",void 0),r([b(l.TileAssets)],t.prototype,"tileAssets",void 0),t=r([_],t)}(d.EventView);o.BoardView=m,cc._RF.pop()},{"../../../domain/board/events/BoardProcessedEvent":"BoardProcessedEvent","../../../domain/board/events/TileClickRejectedEvent":"TileClickRejectedEvent","../../../domain/board/models/TileType":"TileType","../../core/assets/TileAssets":"TileAssets","../../core/events/BoardSyncedEvent":"BoardSyncedEvent","../../core/view/EventView":"EventView","../fx/BoardFxLayer":"BoardFxLayer","./BoardMap":"BoardMap","./TileView":"TileView"}],ContextView:[function(e,t,o){"use strict";cc._RF.push(t,"9c93bf+0u9PVaZ2BjXiiCzz","ContextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ContextView=void 0;var r=e("../../../../core/utils/assert"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._initialized=!1,t}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.onDestroy=function(){this.dispose()},t.prototype.validate=function(){},t.prototype.init=function(e){this._initialized||(r.assertNotNull(e,this,"context"),this.context=e,this.preInit(),this.onInit(),this.postInit(),this._initialized=!0)},t.prototype.postInit=function(){},t.prototype.dispose=function(){this._initialized&&(this.onDispose(),this._initialized=!1)},t.prototype.onDispose=function(){},t}(cc.Component);o.ContextView=i,cc._RF.pop()},{"../../../../core/utils/assert":"assert"}],DefaultGameConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"6d7bf+9Gc9BaI6X/UYq/U6Y","DefaultGameConfigProvider");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DefaultGameConfigProvider=void 0;var s=e("../../../../../core/config/BaseConfigProvider"),a=e("../../../../domain/board/models/TileType"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.load=function(){return r(this,void 0,Promise,function(){return i(this,function(e){return this.config={boardWidth:9,boardHeight:9,allowedTypes:[a.TileType.RED,a.TileType.GREEN,a.TileType.BLUE,a.TileType.PURPLE,a.TileType.YELLOW],clusterSize:3,targetScore:500,maxMoves:20,scoreMultiplier:5},[2]})})},t}(s.BaseConfigProvider);o.DefaultGameConfigProvider=c,cc._RF.pop()},{"../../../../../core/config/BaseConfigProvider":"BaseConfigProvider","../../../../domain/board/models/TileType":"TileType"}],DestroyService:[function(e,t,o){"use strict";cc._RF.push(t,"2017bzN6wxEHaE6OOFvY8CH","DestroyService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.DestroyService=void 0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.clear=function(e){for(var t=[],o=0,n=e;o<n.length;o++){var r=n[o];this.boardModel.destroy(r),t.push(r)}return t},t}(e("./IBoardService").BoardService);o.DestroyService=r,cc._RF.pop()},{"./IBoardService":"IBoardService"}],DestructionAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"c42c5EMSsBEI4xJG/Pnf3N4","DestructionAnimation"),Object.defineProperty(o,"__esModule",{value:!0}),o.DestructionAnimation=void 0;var n=e("./AnimationType"),r=function(){function e(){this.type=n.AnimationType.DESTRUCTION}return e.prototype.play=function(e){return new Promise(function(t){if(cc.isValid(e.node)){var o=e.node.scale,n=e.node.opacity;cc.tween(e.node).to(e.squashDuration,{scale:o*e.squashScale},{easing:"sineOut"}).to(e.popDuration,{scale:o*e.popScale},{easing:"quadOut"}).parallel(cc.tween().to(e.shrinkDuration,{opacity:e.shrinkOpacity}),cc.tween().to(e.shrinkDuration,{scale:o*e.shrinkScale})).call(function(){e.node.scale=o,e.node.opacity=n,e.node.active=!1,t()}).start()}else t()})},e}();o.DestructionAnimation=r,cc._RF.pop()},{"./AnimationType":"AnimationType"}],DestructionSettings:[function(e,t,o){"use strict";cc._RF.push(t,"8119fn1i49KhJyj8rDe0VOA","DestructionSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DomainContext:[function(e,t,o){"use strict";cc._RF.push(t,"daa40NBlt9GXbV3dk3kejOc","DomainContext"),Object.defineProperty(o,"__esModule",{value:!0}),o.DomainContext=void 0;var n=e("../../../../core/events/EventBus"),r=e("../../../domain/board/models/BoardModel"),i=e("../../../domain/board/services/DestroyService"),s=e("../../../domain/board/services/MoveService"),a=e("../../../domain/board/services/SearchService"),c=e("../../../domain/board/services/SpawnService"),u=e("../../../domain/state/models/GameStateModel"),l=e("../../../domain/state/services/ScoreService"),p=e("../../board/controllers/BoardController"),d=e("../../board/runtime/BoardRuntime"),f=e("../../state/controllers/GameStateController"),h=function(){function e(e){this.gameConfig=e,this.eventBus=new n.EventBus,this.gameStateModel=new u.GameStateModel(e.maxMoves,e.targetScore,0),this.scoreService=new l.ScoreService(e.scoreMultiplier),this.gameStateController=new f.GameStateController(this),this.boardModel=new r.BoardModel(e.boardWidth,e.boardHeight),this.boardRuntime=new d.BoardRuntime(e.boardWidth,e.boardHeight),this.spawnService=new c.SpawnService(this.boardModel,e.allowedTypes),this.searchService=new a.SearchService(this.boardModel),this.clearService=new i.DestroyService(this.boardModel),this.moveService=new s.MoveService(this.boardModel),this.boardController=new p.BoardController(this),this.spawnService.spawn(),this.initialBoard=this.boardModel.flush()}return e.prototype.init=function(){this.gameStateController.init(),this.boardController.init()},e.prototype.dispose=function(){this.boardController.dispose(),this.gameStateController.dispose(),this.eventBus.clear()},e}();o.DomainContext=h,cc._RF.pop()},{"../../../../core/events/EventBus":"EventBus","../../../domain/board/models/BoardModel":"BoardModel","../../../domain/board/services/DestroyService":"DestroyService","../../../domain/board/services/MoveService":"MoveService","../../../domain/board/services/SearchService":"SearchService","../../../domain/board/services/SpawnService":"SpawnService","../../../domain/state/models/GameStateModel":"GameStateModel","../../../domain/state/services/ScoreService":"ScoreService","../../board/controllers/BoardController":"BoardController","../../board/runtime/BoardRuntime":"BoardRuntime","../../state/controllers/GameStateController":"GameStateController"}],DynamicTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"243ecVuTBJBlo2DFPE2Htsc","DynamicTextViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DynamicTextView:[function(e,t,o){"use strict";cc._RF.push(t,"0f168cD/SdDKqVh9wvhZVsP","DynamicTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.DynamicTextView=void 0;var i=e("../../../../core/utils/assert"),s=e("./EventView"),a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetLabel=null,t.onValueChanged=function(e){t.render(e.value)},t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),i.assertNotNull(this.targetLabel,this,"targetLabel")},t.prototype.preInit=function(){e.prototype.preInit.call(this),i.assertNumber(this.context.initialValue,this,"initialValue")},t.prototype.onInit=function(){this.render(this.context.initialValue)},t.prototype.postInit=function(){this.on(this.eventType(),this.onValueChanged)},t.prototype.render=function(e){this.targetLabel.string=this.format(e)},r([u(cc.Label)],t.prototype,"targetLabel",void 0),t=r([c],t)}(s.EventView);o.DynamicTextView=l,cc._RF.pop()},{"../../../../core/utils/assert":"assert","./EventView":"EventView"}],EventBus:[function(e,t,o){"use strict";cc._RF.push(t,"4dd3bCOr0RC6b0g0I2ZgBu1","EventBus"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventBus=void 0;var n=function(){function e(){this._listeners=new Map}return e.prototype.on=function(e,t){var o,n=this,r=null!==(o=this._listeners.get(e))&&void 0!==o?o:[];return r.push(t),this._listeners.set(e,r),{unsubscribe:function(){return n.off(e,t)}}},e.prototype.off=function(e,t){var o=this._listeners.get(e);if(o){var n=o.indexOf(t);-1!==n&&o.splice(n,1)}},e.prototype.emit=function(e){var t=this._listeners.get(e.constructor);if(t)for(var o=0,n=t;o<n.length;o++){(0,n[o])(e)}},e.prototype.clear=function(){this._listeners.clear()},e}();o.EventBus=n,cc._RF.pop()},{}],EventViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"c34d1GkKTNIir2ulEw3eXmO","EventViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],EventView:[function(e,t,o){"use strict";cc._RF.push(t,"9dc55NMdhVDNaqP2Y3DA+nU","EventView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.EventView=void 0;var r=e("../../../../core/events/SubscriptionGroup"),i=e("../../../../core/utils/assert"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._subscriptions=new r.SubscriptionGroup,t}return n(t,e),t.prototype.preInit=function(){i.assertNotNull(this.context.eventBus,this,"eventBus"),this.eventBus=this.context.eventBus},t.prototype.onDispose=function(){e.prototype.onDispose.call(this),this._subscriptions.clear()},t.prototype.on=function(e,t){var o=this.eventBus.on(e,t);this._subscriptions.add(o)},t.prototype.emit=function(e){this.eventBus.emit(e)},t}(e("./ContextView").ContextView);o.EventView=s,cc._RF.pop()},{"../../../../core/events/SubscriptionGroup":"SubscriptionGroup","../../../../core/utils/assert":"assert","./ContextView":"ContextView"}],FadeAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"dd159s0rEZA2ZSzKYdWGc6C","FadeAnimation"),Object.defineProperty(o,"__esModule",{value:!0}),o.FadeAnimation=void 0;var n=e("./AnimationType"),r=function(){function e(){this.type=n.AnimationType.FADE}return e.prototype.play=function(e){return new Promise(function(t){cc.isValid(e.node)?cc.tween(e.node).to(e.duration,{opacity:e.targetOpacity},{easing:"quadOut"}).call(t).start():t()})},e}();o.FadeAnimation=r,cc._RF.pop()},{"./AnimationType":"AnimationType"}],FadeSettings:[function(e,t,o){"use strict";cc._RF.push(t,"a2c91O6FmtG0rsgupz9InLy","FadeSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GameConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"2ed19M0P9lLlIQPuWAJuIRx","GameConfigLoader");var n=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigLoader=void 0;var i=e("../../../../core/config/providers/JsonConfigProvider"),s=e("../../GameSettings"),a=e("./GameConfigMode"),c=e("./GameConfigValidator"),u=e("./providers/DefaultGameConfigProvider"),l=function(){function e(){}return e.prototype.load=function(e){return n(this,void 0,Promise,function(){var t;return r(this,function(o){switch(o.label){case 0:return[4,(t=this.createProvider(e)).load()];case 1:return o.sent(),[2,t.get()]}})})},e.prototype.createProvider=function(e){switch(e){case a.GameConfigMode.JSON:var t=s.GameSettings.configJsonPath,o=new c.GameConfigValidator;return new i.JsonConfigProvider(t,o);case a.GameConfigMode.DEFAULT:default:return new u.DefaultGameConfigProvider}},e}();o.GameConfigLoader=l,cc._RF.pop()},{"../../../../core/config/providers/JsonConfigProvider":"JsonConfigProvider","../../GameSettings":"GameSettings","./GameConfigMode":"GameConfigMode","./GameConfigValidator":"GameConfigValidator","./providers/DefaultGameConfigProvider":"DefaultGameConfigProvider"}],GameConfigMode:[function(e,t,o){"use strict";cc._RF.push(t,"11ad46VR7dPWad1bmCWMooe","GameConfigMode"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigMode=void 0,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.JSON=1]="JSON"}(o.GameConfigMode||(o.GameConfigMode={})),cc._RF.pop()},{}],GameConfigValidator:[function(e,t,o){"use strict";cc._RF.push(t,"041e3xL6eVI+o3GAT8qc0ku","GameConfigValidator"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigValidator=void 0;var n=e("../../../../core/utils/assert"),r=e("../../../../core/utils/ensure"),i=e("../../../domain/board/models/TileType"),s=function(){function e(){}return e.prototype.validate=function(e){var t=this;n.assertObject(e,this,"raw");var o=r.ensureNumber(e.boardWidth,this,"boardWidth"),s=r.ensureNumber(e.boardHeight,this,"boardHeight"),a=r.ensureNumber(e.clusterSize,this,"clusterSize"),c=r.ensureNumber(e.targetScore,this,"targetScore"),u=r.ensureNumber(e.maxMoves,this,"maxMoves"),l=r.ensureNumber(e.scoreMultiplier,this,"scoreMultiplier");return n.assertNonEmptyArray(e.allowedTypes,this,"allowedTypes"),{boardWidth:o,boardHeight:s,allowedTypes:e.allowedTypes.map(function(e,o){return n.assertEnumValue(i.TileType,e,t,"allowedTypes["+o+"]")}),clusterSize:a,targetScore:c,maxMoves:u,scoreMultiplier:l}},e}();o.GameConfigValidator=s,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/ensure":"ensure","../../../domain/board/models/TileType":"TileType"}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"1b26eLVJPZKR4fSnAImer1v","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GameEntry:[function(e,t,o){"use strict";cc._RF.push(t,"b0ca3TD77RJ4Zf8PJxueHcl","GameEntry");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},i=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameEntry=void 0;var a=e("../../../presentation/core/installer/ViewInstaller"),c=e("../../GameSettings"),u=e("../config/GameConfigLoader"),l=e("../context/DomainContext"),p=e("../context/PresentationContext"),d=cc._decorator,f=d.ccclass,h=d.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.viewInstaller=null,t.domainContext=null,t.presentationContext=null,t}return n(t,e),t.prototype.start=function(){return i(this,void 0,Promise,function(){var e,t;return s(this,function(o){switch(o.label){case 0:return e=c.GameSettings.configMode,[4,(new u.GameConfigLoader).load(e)];case 1:return t=o.sent(),this.domainContext=new l.DomainContext(t),this.domainContext.init(),this.presentationContext=new p.PresentationContext(this.domainContext),this.viewInstaller.init(this.presentationContext),[2]}})})},t.prototype.onDestroy=function(){null!==this.domainContext&&(this.domainContext.dispose(),this.domainContext=null)},r([h(a.ViewInstaller)],t.prototype,"viewInstaller",void 0),t=r([f],t)}(cc.Component);o.GameEntry=v,cc._RF.pop()},{"../../../presentation/core/installer/ViewInstaller":"ViewInstaller","../../GameSettings":"GameSettings","../config/GameConfigLoader":"GameConfigLoader","../context/DomainContext":"DomainContext","../context/PresentationContext":"PresentationContext"}],GameSettings:[function(e,t,o){"use strict";cc._RF.push(t,"32a0eyP4c5Kj4/WxaGwk34f","GameSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameSettings=void 0;var n=e("./core/config/GameConfigMode");o.GameSettings={configMode:n.GameConfigMode.JSON,configJsonPath:"configs/game-config"},cc._RF.pop()},{"./core/config/GameConfigMode":"GameConfigMode"}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"8abc8oftaBD6qCBxj9JRRs9","GameStateController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.GameStateController=void 0;var r=e("../../../../core/events/SubscriptionGroup"),i=e("../../../domain/board/events/BoardProcessedEvent"),s=e("../../../domain/board/events/BoardProcessingEvent"),a=e("../../../domain/state/events/MovesUpdatedEvent"),c=e("../../../domain/state/events/ScoreUpdatedEvent"),u=e("../../../presentation/core/events/BoardSyncedEvent"),l=function(e){function t(t){var o=e.call(this)||this;return o._subscriptions=new r.SubscriptionGroup,o.onBoardProcessing=function(e){o._gameStateModel.setState("PROCESSING")},o.onBoardProcessed=function(e){e.destroyed.length<1?o._gameStateModel.setState("IDLE"):(o._gameStateModel.addScore(o._scoreService.calculate(e.destroyed.length)),o._gameStateModel.useMove(),o._eventBus.emit(new c.ScoreUpdatedEvent(o._gameStateModel.currentScore)),o._eventBus.emit(new a.MovesUpdatedEvent(o._gameStateModel.movesLeft)),o._gameStateModel.setState("ANIMATING"))},o.onBoardSynced=function(e){o._gameStateModel.setState("IDLE")},o._gameConfig=t.gameConfig,o._eventBus=t.eventBus,o._gameStateModel=t.gameStateModel,o._scoreService=t.scoreService,o}return n(t,e),t.prototype.onInit=function(){this._subscriptions.add(this._eventBus.on(i.BoardChangedEvent,this.onBoardProcessed)),this._subscriptions.add(this._eventBus.on(u.BoardSyncedEvent,this.onBoardSynced)),this._subscriptions.add(this._eventBus.on(s.BoardProcessingEvent,this.onBoardProcessing))},t.prototype.dispose=function(){this._subscriptions.clear()},t}(e("../../core/controllers/BaseController").BaseController);o.GameStateController=l,cc._RF.pop()},{"../../../../core/events/SubscriptionGroup":"SubscriptionGroup","../../../domain/board/events/BoardProcessedEvent":"BoardProcessedEvent","../../../domain/board/events/BoardProcessingEvent":"BoardProcessingEvent","../../../domain/state/events/MovesUpdatedEvent":"MovesUpdatedEvent","../../../domain/state/events/ScoreUpdatedEvent":"ScoreUpdatedEvent","../../../presentation/core/events/BoardSyncedEvent":"BoardSyncedEvent","../../core/controllers/BaseController":"BaseController"}],GameStateModel:[function(e,t,o){"use strict";cc._RF.push(t,"99471UrmwxBoYieGRlv584Z","GameStateModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameStateModel=void 0;var n=function(){function e(e,t,o){this._movesLeft=e,this._targetScore=t,this._currentScore=o,this._state="IDLE"}return Object.defineProperty(e.prototype,"movesLeft",{get:function(){return this._movesLeft},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetScore",{get:function(){return this._targetScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScore",{get:function(){return this._currentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.addScore=function(e){this._currentScore+=e},e.prototype.useMove=function(){this._movesLeft--},e.prototype.setState=function(e){this._state=e},e}();o.GameStateModel=n,cc._RF.pop()},{}],GravityFallAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"b518992zBlNY5IJZLTvDQ1v","GravityFallAnimation"),Object.defineProperty(o,"__esModule",{value:!0}),o.GravityFallAnimation=void 0;var n=e("./AnimationType"),r=function(){function e(){this.type=n.AnimationType.GRAVITY_FALL}return e.prototype.play=function(e){return new Promise(function(t){cc.isValid(e.node)?cc.tween(e.node).to(e.duration,{y:e.targetY},{easing:e.easing}).to(e.bounceDuration,{y:e.targetY+e.bounce},{easing:"quadOut"}).to(e.settleDuration,{y:e.targetY},{easing:"quadIn"}).call(t).start():t()})},e}();o.GravityFallAnimation=r,cc._RF.pop()},{"./AnimationType":"AnimationType"}],GravityFallSettings:[function(e,t,o){"use strict";cc._RF.push(t,"1754bHwAURNfLQANX+lyivr","GravityFallSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IAnimationSettings:[function(e,t,o){"use strict";cc._RF.push(t,"76151XiVN5KsZZHbCCG5LCn","IAnimationSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"a7ed3ubAfNLQYwbiBaXzuEf","IAnimation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IBoardService:[function(e,t,o){"use strict";cc._RF.push(t,"84623Zdp3FDb4pT4zg1jwcO","IBoardService"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardService=void 0;var n=function(){return function(e){this.boardModel=e}}();o.BoardService=n,cc._RF.pop()},{}],IConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"58c4c78lEFJBK0t7vKUhhpW","IConfigProvider"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IConfigValidator:[function(e,t,o){"use strict";cc._RF.push(t,"fd0b3vkXQdNkKrm68/euUS2","IConfigValidator"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IConfig:[function(e,t,o){"use strict";cc._RF.push(t,"8a20aZkj7NIib5OJO2YOEVQ","IConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IDisposable:[function(e,t,o){"use strict";cc._RF.push(t,"0d1f2BKAyRKradOcgIbpJtI","IDisposable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IEvent:[function(e,t,o){"use strict";cc._RF.push(t,"8fa1c68GtVNRKFHm/nx3oTX","IEvent"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IInitializable:[function(e,t,o){"use strict";cc._RF.push(t,"ee3c8BQs6BEYJwkQjEK6TMK","IInitializable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IValidatable:[function(e,t,o){"use strict";cc._RF.push(t,"16605S+cj5B/rtndFr9BxXG","IValidatable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],JsonConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"f53f10PjOVPJaepW1ma/Plz","JsonConfigProvider");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__awaiter||function(e,t,o,n){function r(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):r(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(e){return function(t){return c([e,t])}}function c(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.JsonConfigProvider=void 0;var s=function(e){function t(t,o){var n=e.call(this)||this;return n._path=t,n._validator=o,n}return n(t,e),t.prototype.load=function(){return r(this,void 0,Promise,function(){var e;return i(this,function(t){switch(t.label){case 0:return[4,this.loadJsonAsset(this._path)];case 1:return e=t.sent(),this.config=this._validator.validate(e.json),[2]}})})},t.prototype.loadJsonAsset=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.JsonAsset,function(n,r){n||!r?o(new Error("[JsonGameConfigProvider] Failed to load: "+e+"\n"+n)):t(r)})})},t}(e("../BaseConfigProvider").BaseConfigProvider);o.JsonConfigProvider=s,cc._RF.pop()},{"../BaseConfigProvider":"BaseConfigProvider"}],Matrix:[function(e,t,o){"use strict";cc._RF.push(t,"320baWGsBZEno88utR9Y4nE","Matrix"),Object.defineProperty(o,"__esModule",{value:!0}),o.Matrix=void 0;var n=function(){function e(e,t,o){this._width=e,this._height=t,this._data=new Array(t);for(var n=0;n<t;n++){for(var r=new Array(e),i=0;i<e;i++)r[i]=o(i,n);this._data[n]=r}}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){return this._data[t][e]},e.prototype.set=function(e,t,o){this._data[t][e]=o},e.prototype.swap=function(e,t,o,n){var r=this._data[t][e];this._data[t][e]=this._data[n][o],this._data[n][o]=r},e.prototype.forEach=function(e){for(var t=0;t<this._height;t++)for(var o=0;o<this._width;o++)e(this._data[t][o],o,t)},e}();o.Matrix=n,cc._RF.pop()},{}],MoveService:[function(e,t,o){"use strict";cc._RF.push(t,"180c6G6rN9G/Iwx7rb1B39H","MoveService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.MoveService=void 0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.move=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t];this.boardModel.move(n)}},t}(e("./IBoardService").BoardService);o.MoveService=r,cc._RF.pop()},{"./IBoardService":"IBoardService"}],MovesTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"edbdcH0xDlCDLhdQ15+puc6","MovesTextViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],MovesTextView:[function(e,t,o){"use strict";cc._RF.push(t,"d8aafGKJJ1BEZQfGSesrZxi","MovesTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.MovesTextView=void 0;var i=e("../../../domain/state/events/MovesUpdatedEvent"),s=e("../../core/view/DynamicTextView"),a=cc._decorator.ccclass,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.eventType=function(){return i.MovesUpdatedEvent},t.prototype.format=function(e){return e.toString()},t=r([a],t)}(s.DynamicTextView);o.MovesTextView=c,cc._RF.pop()},{"../../../domain/state/events/MovesUpdatedEvent":"MovesUpdatedEvent","../../core/view/DynamicTextView":"DynamicTextView"}],MovesUpdatedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"78ef3eplVBFApDB+RThG7MX","MovesUpdatedEvent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.MovesUpdatedEvent=void 0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("../../../../core/events/ValueChangedEvent").ValueChangedEvent);o.MovesUpdatedEvent=r,cc._RF.pop()},{"../../../../core/events/ValueChangedEvent":"ValueChangedEvent"}],PresentationContext:[function(e,t,o){"use strict";cc._RF.push(t,"42e70c7wJdHjIwqH428F/4G","PresentationContext"),Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationContext=void 0;var n=function(){return function(e){this.eventBus=e.eventBus,this.movesLeft=e.gameStateModel.movesLeft,this.targetScore=e.gameStateModel.targetScore,this.currentScore=e.gameStateModel.currentScore,this.boardWidth=e.boardModel.width,this.boardHeight=e.boardModel.height,this.initialBoard=e.initialBoard}}();o.PresentationContext=n,cc._RF.pop()},{}],ScoreService:[function(e,t,o){"use strict";cc._RF.push(t,"ed1f8pLuO9IALBgNsqVtvjL","ScoreService"),Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreService=void 0;var n=function(){function e(e){this._scoreMultiplier=e}return e.prototype.calculate=function(e){return e*e*this._scoreMultiplier},e}();o.ScoreService=n,cc._RF.pop()},{}],ScoreTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"7af9aTEbmRII6sX9caFBjRn","ScoreTextViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ScoreTextView:[function(e,t,o){"use strict";cc._RF.push(t,"7bd0f5hs8VARYsgFprc1Aea","ScoreTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreTextView=void 0;var i=e("../../../../core/utils/assert"),s=e("../../../domain/state/events/ScoreUpdatedEvent"),a=e("../../core/view/DynamicTextView"),c=cc._decorator.ccclass,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.preInit=function(){e.prototype.preInit.call(this),i.assertNumber(this.context.targetScore,this,"initialValue")},t.prototype.eventType=function(){return s.ScoreUpdatedEvent},t.prototype.format=function(e){return e+"/"+this.context.targetScore},t=r([c],t)}(a.DynamicTextView);o.ScoreTextView=u,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../domain/state/events/ScoreUpdatedEvent":"ScoreUpdatedEvent","../../core/view/DynamicTextView":"DynamicTextView"}],ScoreUpdatedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"5fc46IhQk9N7YaoODiMNKUJ","ScoreUpdatedEvent");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreUpdatedEvent=void 0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("../../../../core/events/ValueChangedEvent").ValueChangedEvent);o.ScoreUpdatedEvent=r,cc._RF.pop()},{"../../../../core/events/ValueChangedEvent":"ValueChangedEvent"}],SearchService:[function(e,t,o){"use strict";cc._RF.push(t,"146bchEKatLLLIq9vBSpvaC","SearchService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.SearchService=void 0;var r=e("../../../../core/collections/Matrix"),i=e("../models/TileType"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.findCluster=function(e){for(var t=this.boardModel.get(e),o=[],n=new r.Matrix(this.boardModel.width,this.boardModel.height,function(){return!1}),s=[e];s.length>0&&t!==i.TileType.NONE;){var a=s.pop();a&&(n.get(a.x,a.y)||(n.set(a.x,a.y,!0),this.boardModel.get(a)===t&&(o.push(a),s.push.apply(s,this.findNeighbors(a)))))}return o},t.prototype.findNeighbors=function(e){for(var t=[],o=0,n=[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}];o<n.length;o++){var r=n[o];r.x<0||r.y<0||r.x>=this.boardModel.width||r.y>=this.boardModel.height||t.push(r)}return t},t.prototype.findDrops=function(){for(var e=[],t=this.boardModel.width-1;t>=0;t--)for(var o=0,n=this.boardModel.height-1;n>=0;n--)this.boardModel.empty({x:t,y:n})?o++:o>0&&e.push({from:{x:t,y:n},to:{x:t,y:n+o}});return e},t}(e("./IBoardService").BoardService);o.SearchService=s,cc._RF.pop()},{"../../../../core/collections/Matrix":"Matrix","../models/TileType":"TileType","./IBoardService":"IBoardService"}],ShakeAnimation:[function(e,t,o){"use strict";cc._RF.push(t,"9cee9jsuYtJc6y0sJNr32ou","ShakeAnimation"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShakeAnimation=void 0;var n=e("./AnimationType"),r=function(){function e(){this.type=n.AnimationType.SHAKE}return e.prototype.play=function(e){return new Promise(function(t){if(cc.isValid(e.node)){var o=e.node.rotation;cc.tween(e.node).to(.05,{rotation:o+e.amplitude}).to(.1,{rotation:o-e.amplitude}).to(.1,{rotation:o+e.amplitude}).to(.05,{rotation:o}).call(t).start()}else t()})},e}();o.ShakeAnimation=r,cc._RF.pop()},{"./AnimationType":"AnimationType"}],ShakeSettings:[function(e,t,o){"use strict";cc._RF.push(t,"e713e/x+YVACa7ott/cyQ50","ShakeSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],SpawnService:[function(e,t,o){"use strict";cc._RF.push(t,"c0001pCwYVP95cvO6tOSR2c","SpawnService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.SpawnService=void 0;var r=function(e){function t(t,o){var n=e.call(this,t)||this;return n._allowedTypes=o,n}return n(t,e),t.prototype.spawn=function(){for(var e=[],t=0;t<this.boardModel.width;t++)for(var o=0;o<this.boardModel.height;o++){var n={x:t,y:o};if(this.boardModel.empty(n)){var r={at:n,type:this.randomTile()};this.boardModel.spawn(r),e.push(r)}}return e},t.prototype.randomTile=function(){var e=this._allowedTypes;return e[Math.floor(Math.random()*e.length)]},t}(e("./IBoardService").BoardService);o.SpawnService=r,cc._RF.pop()},{"./IBoardService":"IBoardService"}],SubscriptionGroup:[function(e,t,o){"use strict";cc._RF.push(t,"18bfaE9+69Bu4GzKQB8eC60","SubscriptionGroup"),Object.defineProperty(o,"__esModule",{value:!0}),o.SubscriptionGroup=void 0;var n=function(){function e(){this._subscriptions=[]}return e.prototype.add=function(e){this._subscriptions.push(e)},e.prototype.clear=function(){for(var e=0,t=this._subscriptions;e<t.length;e++){t[e].unsubscribe()}this._subscriptions.length=0},e}();o.SubscriptionGroup=n,cc._RF.pop()},{}],Subscription:[function(e,t,o){"use strict";cc._RF.push(t,"e054aPiy9xJ/roTuUKhU0v3","Subscription"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileAssets:[function(e,t,o){"use strict";cc._RF.push(t,"4db3f6Nos5B9K7+VqraVTc/","TileAssets");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileAssets=void 0;var i=e("../../../../core/utils/assert"),s=e("../../../../core/utils/ensure"),a=e("../../../domain/board/models/TileType"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.red=null,t.green=null,t.blue=null,t.purple=null,t.yellow=null,t.bomb=null,t}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.validate=function(){this._map=new Map([[a.TileType.RED,s.ensureNotNull(this.red,this,"RED")],[a.TileType.GREEN,s.ensureNotNull(this.green,this,"GREEN")],[a.TileType.BLUE,s.ensureNotNull(this.blue,this,"BLUE")],[a.TileType.PURPLE,s.ensureNotNull(this.purple,this,"PURPLE")],[a.TileType.YELLOW,s.ensureNotNull(this.yellow,this,"YELLOW")],[a.TileType.BOMB,s.ensureNotNull(this.bomb,this,"BOMB")]])},t.prototype.get=function(e){var t=this._map.get(e);return i.assertNotNull(t,this,"Sprite for type "+a.TileType[e]),t},r([l(cc.SpriteFrame)],t.prototype,"red",void 0),r([l(cc.SpriteFrame)],t.prototype,"green",void 0),r([l(cc.SpriteFrame)],t.prototype,"blue",void 0),r([l(cc.SpriteFrame)],t.prototype,"purple",void 0),r([l(cc.SpriteFrame)],t.prototype,"yellow",void 0),r([l(cc.SpriteFrame)],t.prototype,"bomb",void 0),t=r([u],t)}(cc.Component);o.TileAssets=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/ensure":"ensure","../../../domain/board/models/TileType":"TileType"}],TileChange:[function(e,t,o){"use strict";cc._RF.push(t,"783f0yvqedNeZB4PrwoPht2","TileChange"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileClickRejectedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"0d4f7IkI9lLbalhgHIOBGAe","TileClickRejectedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileClickRejectedEvent=void 0;var n=function(){return function(e){this.position=e}}();o.TileClickRejectedEvent=n,cc._RF.pop()},{}],TileClickedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"be1e3ah8fJEB4PBG2B6hWya","TileClickedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileClickedEvent=void 0;var n=function(){return function(e){this.position=e}}();o.TileClickedEvent=n,cc._RF.pop()},{}],TileMove:[function(e,t,o){"use strict";cc._RF.push(t,"46b0eOlET1LrraSwia8vb+/","TileMove"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TilePosition:[function(e,t,o){"use strict";cc._RF.push(t,"e31ab1Szq1KkpQ2i09M9pA2","TilePosition"),Object.defineProperty(o,"__esModule",{value:!0}),o.TilePosition=void 0;var n=function(){function e(e,t){this.x=e,this.y=t}return e.key=function(e,t){return e.x+e.y*t},e}();o.TilePosition=n,cc._RF.pop()},{}],TileSpawn:[function(e,t,o){"use strict";cc._RF.push(t,"d8b33ZW3klA5YiCWrnTZWSz","TileSpawn"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileType:[function(e,t,o){"use strict";cc._RF.push(t,"ff92aR8Ym9CB7br3M3C8KnH","TileType"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileType=void 0,function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=3]="BLUE",e[e.PURPLE=4]="PURPLE",e[e.YELLOW=5]="YELLOW",e[e.BOMB=6]="BOMB",e[e.SUPER_BOMB=7]="SUPER_BOMB",e[e.HORIZONTAL_ROCKET=8]="HORIZONTAL_ROCKET",e[e.VERTICAL_ROCKET=9]="VERTICAL_ROCKET"}(o.TileType||(o.TileType={})),cc._RF.pop()},{}],TileViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"c7e41M2uOVIuYIyMt4LhB8p","TileViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"0eda0LA+Q5BwrB21iLZDWRq","TileView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileView=void 0;var i=e("../../../../core/utils/assert"),s=e("../../core/events/TileClickedEvent"),a=e("../../core/view/EventView"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),i.assertNotNull(this.sprite,this,"Sprite")},t.prototype.preInit=function(){e.prototype.preInit.call(this),i.assertNotNull(this.context.position,this,"boardModel")},t.prototype.onInit=function(){this.position=this.context.position},t.prototype.postInit=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onDispose=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onClick=function(){this.emit(new s.TileClickedEvent(this.position))},t.prototype.show=function(){this.node.active=!0,this.sprite.node.active=!0},t.prototype.hide=function(){this.node.active=!1,this.sprite.node.active=!1},t.prototype.set=function(e){this.sprite.spriteFrame=e},t.prototype.get=function(){return this.sprite.spriteFrame},r([l(cc.Sprite)],t.prototype,"sprite",void 0),t=r([u],t)}(a.EventView);o.TileView=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../core/events/TileClickedEvent":"TileClickedEvent","../../core/view/EventView":"EventView"}],ValueChangedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"323e3lkPd9Nzq1jCSpLjod2","ValueChangedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.ValueChangedEvent=void 0;var n=function(){return function(e){this.value=e}}();o.ValueChangedEvent=n,cc._RF.pop()},{}],ViewInstaller:[function(e,t,o){"use strict";cc._RF.push(t,"42448B5AjJOJLRYwcw+GVHC","ViewInstaller");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),r=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ViewInstaller=void 0;var i=e("../../../../core/utils/assert"),s=e("../animations/AnimationSystem"),a=e("../../board/view/BoardView"),c=e("../view/ContextView"),u=e("../../state/view/MovesTextView"),l=e("../../state/view/ScoreTextView"),p=cc._decorator,d=p.ccclass,f=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boardView=null,t.movesTextView=null,t.scoreTextView=null,t}return n(t,e),t.prototype.onLoad=function(){i.assertNotNull(this.boardView,this,"BoardView"),i.assertNotNull(this.movesTextView,this,"MovesTextView"),i.assertNotNull(this.scoreTextView,this,"ScoreTextView")},t.prototype.preInit=function(){i.assertNotNull(this.context,this,"viewContext")},t.prototype.onInit=function(){this.animationSystem=new s.AnimationSystem,this.boardView.init({eventBus:this.context.eventBus,animationSystem:this.animationSystem,boardWidth:this.context.boardWidth,boardHeight:this.context.boardHeight,initialBoard:this.context.initialBoard}),this.scoreTextView.init({eventBus:this.context.eventBus,initialValue:this.context.currentScore,targetScore:this.context.targetScore}),this.movesTextView.init({eventBus:this.context.eventBus,initialValue:this.context.movesLeft})},t.prototype.dispose=function(){this.boardView.dispose(),this.movesTextView.dispose(),this.scoreTextView.dispose()},r([f(a.BoardView)],t.prototype,"boardView",void 0),r([f(u.MovesTextView)],t.prototype,"movesTextView",void 0),r([f(l.ScoreTextView)],t.prototype,"scoreTextView",void 0),t=r([d],t)}(c.ContextView);o.ViewInstaller=h,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../board/view/BoardView":"BoardView","../../state/view/MovesTextView":"MovesTextView","../../state/view/ScoreTextView":"ScoreTextView","../animations/AnimationSystem":"AnimationSystem","../view/ContextView":"ContextView"}],assert:[function(e,t,o){"use strict";function n(e,t,o){var n;if(n="function"==typeof t?t.name:t.constructor.name,!e)throw new Error("["+n+"] "+o)}function r(e,t,o){n(null!==e&&void 0!==e,t,o+" must not be null nor undefined")}function i(e,t,o){n(Array.isArray(e),t,o+" must be an array")}function s(e,t,o){n(e.length>0,t,o+" must not be empty")}cc._RF.push(t,"3cb7d9OgnZEJaI/WU7/lNKX","assert"),Object.defineProperty(o,"__esModule",{value:!0}),o.assertNumber=o.assertObject=o.assertEnumValue=o.assertString=o.assertNonEmptyArray=o.assertArrayNotEmpty=o.assertArray=o.assertNotNull=o.assert=void 0,o.assert=n,o.assertNotNull=r,o.assertArray=i,o.assertArrayNotEmpty=s,o.assertNonEmptyArray=function(e,t,o){i(e,t,o),s(e,t,o)},o.assertString=function(e,t,o){n("string"==typeof e,t,o+" must be string")},o.assertEnumValue=function(e,t,o,r){var i=e[t];return n(void 0!==i,o,"Unknown "+r+': "'+t+'"'),i},o.assertObject=function(e,t,o){n("object"==typeof e,t,o+" must be object"),r(e,t,o)},o.assertNumber=function(e,t,o){n("number"==typeof e&&!Number.isNaN(e),t,o+" must be number")},cc._RF.pop()},{}],ensure:[function(e,t,o){"use strict";cc._RF.push(t,"4a80emCBIlPbY4kzmojZq/X","ensure"),Object.defineProperty(o,"__esModule",{value:!0}),o.ensureNotNull=o.ensureNumber=void 0;var n=e("./assert");o.ensureNumber=function(e,t,o){return n.assertNumber(e,t,o),e},o.ensureNotNull=function(e,t,o){return n.assertNotNull(e,t,o),e},cc._RF.pop()},{"./assert":"assert"}],random:[function(e,t,o){"use strict";cc._RF.push(t,"a5d9cezF4BFNIl1SShDyYsy","random"),Object.defineProperty(o,"__esModule",{value:!0}),o.Random=void 0;var n=function(){function e(){}return e.intRange=function(e,t){return e+Math.floor(Math.random()*(t-e))},e.floatRange=function(e,t){return e+Math.random()*(t-e)},e.float=function(){return Math.random()},e.pick=function(e){if(0===e.length)throw new Error("[Random] Cannot pick from empty array");return e[this.intRange(0,e.length)]},e}();o.Random=n,cc._RF.pop()},{}]},{},["Matrix","BaseConfigProvider","IConfig","IConfigProvider","IConfigValidator","JsonConfigProvider","EventBus","IEvent","Subscription","SubscriptionGroup","ValueChangedEvent","IDisposable","IInitializable","IValidatable","assert","ensure","random","GameSettings","BoardController","BoardRuntime","GameConfig","GameConfigLoader","GameConfigMode","GameConfigValidator","DefaultGameConfigProvider","DomainContext","PresentationContext","BaseController","GameEntry","GameStateController","BoardProcessedEvent","BoardProcessingEvent","TileClickRejectedEvent","BoardModel","TileChange","TileMove","TilePosition","TileSpawn","TileType","DestroyService","IBoardService","MoveService","SearchService","SpawnService","MovesUpdatedEvent","ScoreUpdatedEvent","GameStateModel","ScoreService","BoardViewContext","TileViewContext","BoardFxLayer","BoardMap","BoardView","TileView","AnimationSettings","AnimationSystem","AnimationType","DestructionAnimation","FadeAnimation","GravityFallAnimation","IAnimation","IAnimationSettings","ShakeAnimation","DestructionSettings","FadeSettings","GravityFallSettings","ShakeSettings","TileAssets","DynamicTextViewContext","EventViewContext","BoardSyncedEvent","TileClickedEvent","ViewInstaller","ContextView","DynamicTextView","EventView","MovesTextViewContext","ScoreTextViewContext","MovesTextView","ScoreTextView"]);