window.__require=function e(t,o,n){function i(s,a){if(!o[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var l=o[s]={exports:{}};t[s][0].call(l.exports,function(e){return i(t[s][1][e]||e)},l,l.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({AltitudeMap:[function(e,t,o){"use strict";cc._RF.push(t,"988ee61LrlLxI8UCWKJq6dH","AltitudeMap"),Object.defineProperty(o,"__esModule",{value:!0}),o.AltitudeMap=void 0;var n=function(){function e(){this._map=new Map}return e.prototype.add=function(e,t){this._map.set(e,t)},e.prototype.remove=function(e){this._map.set(e,null)},e.prototype.get=function(e){var t;return null!==(t=this._map.get(e))&&void 0!==t?t:null},e.prototype.reset=function(){this._map.clear()},e.prototype.forEach=function(e){this._map.forEach(function(t,o,n){return e(t,o)})},e}();o.AltitudeMap=n,cc._RF.pop()},{}],ApplicationGraph:[function(e,t,o){"use strict";cc._RF.push(t,"aec39C+01JLG6VYFxXRr/DH","ApplicationGraph"),Object.defineProperty(o,"__esModule",{value:!0}),o.ApplicationGraph=void 0;var n=e("./board/logic/controllers/BoardLogicController"),i=e("./board/runtime/controllers/BoardInteractivityController"),r=e("./board/runtime/models/BoardInteractivityModel"),s=e("./input/controllers/InputController"),a=e("./state/controllers/GameStateController"),c=function(){return function(e,t){this.interactivityModel=new r.BoardInteractivityModel,this.inputController=new s.InputController(e,t,this.interactivityModel),this.interactivityController=new i.BoardInteractivityController(e,t,this.interactivityModel),this.logicController=new n.BoardLogicController(e,t,this.interactivityModel),this.stateController=new a.GameStateController(e,t)}}();o.ApplicationGraph=c,cc._RF.pop()},{"./board/logic/controllers/BoardLogicController":"BoardLogicController","./board/runtime/controllers/BoardInteractivityController":"BoardInteractivityController","./board/runtime/models/BoardInteractivityModel":"BoardInteractivityModel","./input/controllers/InputController":"InputController","./state/controllers/GameStateController":"GameStateController"}],BaseBoardStrategy:[function(e,t,o){"use strict";cc._RF.push(t,"12833TLhD5N/Zl1TuAMQecp","BaseBoardStrategy"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseBoardStrategy=void 0;var n=function(){function e(e,t,o){this.interactivityModel=e,this.moveService=t,this.spawnService=o}return e.prototype.drop=function(e){var t=this;this.moveService.drop().forEach(function(o){t.destabilize(o.id),e.push(o)})},e.prototype.spawn=function(e){var t=this;this.spawnService.spawn().forEach(function(o){t.destabilize(o.id),e.push(o)})},e.prototype.destabilize=function(e){this.interactivityModel.addUnstable(e)},e.prototype.block=function(e){this.interactivityModel.addBlocker(e)},e}();o.BaseBoardStrategy=n,cc._RF.pop()},{}],BaseConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"ea6f1JcQhJESrskp1XVPg26","BaseConfigLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BaseConfigLoader=void 0;var i=e("../../core/config/ConfigLoader"),r=e("../../core/config/providers/JsonConfigProvider"),s=e("./ConfigMode"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.createProvider=function(e,t){switch(e){case s.ConfigMode.JSON:return new r.JsonConfigProvider(this.getJsonPath(),t);default:return this.getDefaultProvider()}},t}(i.ConfigLoader);o.BaseConfigLoader=a,cc._RF.pop()},{"../../core/config/ConfigLoader":"ConfigLoader","../../core/config/providers/JsonConfigProvider":"JsonConfigProvider","./ConfigMode":"ConfigMode"}],BaseConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"062f5ambD5N9JvTzMqt3cqH","BaseConfigProvider"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseConfigProvider=void 0;var n=e("../../utils/assert"),i=function(){function e(){}return e.prototype.get=function(){return n.assertNotNull(this.config,this,"config"),this.config},e}();o.BaseConfigProvider=i,cc._RF.pop()},{"../../utils/assert":"assert"}],BaseController:[function(e,t,o){"use strict";cc._RF.push(t,"badd4D/MYpB0pfYbiXf2xQf","BaseController"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventController=void 0;var n=e("../../../../core/eventbus/SubscriptionGroup"),i=e("../../../../core/utils/assert"),r=function(){function e(e){this.eventBus=e,this._subscriptions=new n.SubscriptionGroup,this._initialized=!1}return e.prototype.init=function(){this._initialized||(this._initialized=!0,this.preInit(),this.onInit())},e.prototype.preInit=function(){i.assertNotNull(this.eventBus,this,"eventBus")},e.prototype.dispose=function(){this._initialized&&this.onDispose()},e.prototype.onDispose=function(){this._subscriptions.clear()},e.prototype.on=function(e,t){var o=this.eventBus.on(e,t);this._subscriptions.add(o)},e.prototype.emit=function(e){this.eventBus.emit(e)},e}();o.EventController=r,cc._RF.pop()},{"../../../../core/eventbus/SubscriptionGroup":"SubscriptionGroup","../../../../core/utils/assert":"assert"}],BasePool:[function(e,t,o){"use strict";cc._RF.push(t,"55005DLlvNEvbrWa1FtZwbp","BasePool"),Object.defineProperty(o,"__esModule",{value:!0}),o.BasePool=void 0;var n=function(){return function(){this._pool=[]}}();o.BasePool=n,cc._RF.pop()},{}],BaseView:[function(e,t,o){"use strict";cc._RF.push(t,"4e16boehWZGFq/TtEp4k1+v","BaseView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BaseView=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.validate=function(){},t}(cc.Component);o.BaseView=i,cc._RF.pop()},{}],BoardInteractivityController:[function(e,t,o){"use strict";cc._RF.push(t,"67646Jq97VABIb+Zr3etu+M","BoardInteractivityController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoardInteractivityController=void 0;var i=e("../../../../presentation/board/events/VisualTileDestroyed"),r=e("../../../../presentation/board/events/VisualTileFlown"),s=e("../../../../presentation/board/events/VisualTileLanded"),a=e("../../../../presentation/board/events/VisualTileShaken"),c=e("../../../../presentation/board/events/VisualTileSwapped"),u=e("../../../../presentation/board/events/VisualTileTransformed"),l=function(e){function t(t,o,n){var i=e.call(this,t)||this;return i.onTileStabilized=function(e){i._interactivityModel.removeUnstable(e.id)},i._interactivityModel=n,i}return n(t,e),t.prototype.onInit=function(){var e=this;[s.VisualTileLanded,c.VisualTileSwapped,i.VisualTileDestroyed,a.VisualTileShaken,u.VisualTileTransformed,r.VisualTileFlown].forEach(function(t){e.on(t,e.onTileStabilized)})},t}(e("../../../common/controllers/BaseController").EventController);o.BoardInteractivityController=l,cc._RF.pop()},{"../../../../presentation/board/events/VisualTileDestroyed":"VisualTileDestroyed","../../../../presentation/board/events/VisualTileFlown":"VisualTileFlown","../../../../presentation/board/events/VisualTileLanded":"VisualTileLanded","../../../../presentation/board/events/VisualTileShaken":"VisualTileShaken","../../../../presentation/board/events/VisualTileSwapped":"VisualTileSwapped","../../../../presentation/board/events/VisualTileTransformed":"VisualTileTransformed","../../../common/controllers/BaseController":"BaseController"}],BoardInteractivityModel:[function(e,t,o){"use strict";cc._RF.push(t,"b7e4ebhOApNI5DYYYh6hM3R","BoardInteractivityModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardInteractivityModel=void 0;var n=function(){function e(){this._blockers=new Set,this._unstables=new Set}return e.prototype.lockedBoard=function(){return 0!==this._blockers.size},e.prototype.lockedTile=function(e){return this._unstables.has(e)},e.prototype.addBlocker=function(e){this._blockers.add(e)},e.prototype.addUnstable=function(e){this._unstables.add(e)},e.prototype.removeUnstable=function(e){this.deleteUnstable(e),this.deleteBlocker(e)},e.prototype.allUnstable=function(){return new Set(this._unstables)},e.prototype.deleteBlocker=function(e){this._blockers.delete(e)},e.prototype.deleteUnstable=function(e){this._unstables.delete(e)},e.prototype.clear=function(){this._blockers.clear(),this._unstables.clear()},e}();o.BoardInteractivityModel=n,cc._RF.pop()},{}],BoardKey:[function(e,t,o){"use strict";cc._RF.push(t,"e7833BfyBNJiZr6GHlnxgBl","BoardKey"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardKey=void 0;var n=e("../../domain/board/models/TileType"),i=function(){function e(){}return e.position=function(e){return e.x+":"+e.y},e.type=function(e){return""+n.TileType[e]},e}();o.BoardKey=i,cc._RF.pop()},{"../../domain/board/models/TileType":"TileType"}],BoardLogicController:[function(e,t,o){"use strict";cc._RF.push(t,"fe42e6btd9JBKrbJ18BDLQV","BoardLogicController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoardLogicController=void 0;var i=e("../../../../domain/board/events/BoardMutationsBatch"),r=e("../../../../domain/board/models/TileType"),s=e("../../../../domain/state/models/BoosterType"),a=e("../../../common/controllers/BaseController"),c=e("../../../input/intents/BombEmplaceIntent"),u=e("../../../input/intents/NormalIntent"),l=e("../../../input/intents/SwapIntent"),p=e("../../../state/events/BoosterIntentComplete"),d=e("../../../state/events/NormalIntentComplete"),h=e("../strategies/BoardStrategyFactory"),f=function(e){function t(t,o,n){var a=e.call(this,t)||this;return a.onNormalIntent=function(e){var t=a._strategyFactory.getStrategy(e.id).execute(e.id);a.sync(t),a.emit(t)},a.onSwapIntent=function(e){var t=new i.BoardMutationsBatch;a.swap(e.first,e.second).forEach(function(e){return t.push(e)}),a.emit(new p.BoosterIntentComplete(s.BoosterType.SWAP)),a.emit(t)},a.onBombEmplaceIntent=function(e){var t=new i.BoardMutationsBatch,o=a.emplace(e.id,r.TileType.BOMB);null!==o&&t.push(o),a.emit(new p.BoosterIntentComplete(s.BoosterType.BOMB)),a.emit(t)},a._boardInfo=o.boardInfo,a._interactivityModel=n,a._stateModel=o.stateModel,a._typeRepo=o.typeRepo,a._spawnService=o.spawnService,a._searchService=o.searchService,a._destroyService=o.destroyService,a._moveService=o.moveService,a._transformService=o.transformService,a._strategyFactory=new h.BoardStrategyFactory(a._boardInfo,a._interactivityModel,a._typeRepo,a._searchService,a._destroyService,a._transformService,a._moveService,a._spawnService),a}return n(t,e),t.prototype.onInit=function(){var e=this,t=this._spawnService.spawn(),o=new i.BoardMutationsBatch;t.forEach(function(t){o.push(t),e._interactivityModel.addBlocker(t.id)}),this.emit(o),this.on(u.NormalIntent,this.onNormalIntent),this.on(l.SwapIntent,this.onSwapIntent),this.on(c.BombEmplaceIntent,this.onBombEmplaceIntent)},t.prototype.swap=function(e,t){return this._interactivityModel.addUnstable(e),this._interactivityModel.addUnstable(t),this._moveService.swap(e,t)},t.prototype.emplace=function(e,t){return this._interactivityModel.addUnstable(e),this._transformService.tryTransform(e,[],t)},t.prototype.sync=function(e){var t=0,o=0;e.mutations.forEach(function(e){switch(e.kind){case"tile.transformed":e.transformed.length>0&&(t+=e.transformed.length+1);break;case"tile.destroy":"match"===e.cause?t+=e.destroyed.length:o+=e.destroyed.length}}),this.emit(new d.NormalIntentComplete(t,o))},t}(a.EventController);o.BoardLogicController=f,cc._RF.pop()},{"../../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","../../../../domain/board/models/TileType":"TileType","../../../../domain/state/models/BoosterType":"BoosterType","../../../common/controllers/BaseController":"BaseController","../../../input/intents/BombEmplaceIntent":"BombEmplaceIntent","../../../input/intents/NormalIntent":"NormalIntent","../../../input/intents/SwapIntent":"SwapIntent","../../../state/events/BoosterIntentComplete":"BoosterIntentComplete","../../../state/events/NormalIntentComplete":"NormalIntentComplete","../strategies/BoardStrategyFactory":"BoardStrategyFactory"}],BoardLogicModel:[function(e,t,o){"use strict";cc._RF.push(t,"41e01dqkI9LIKwApftjX2vt","BoardLogicModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardLogicModel=void 0;var n=e("../../../../core/collections/Matrix"),i=function(){function e(e,t){this.width=e,this.height=t,this._grid=new n.Matrix(this.width,this.height,function(){return null})}return e.prototype.register=function(e,t){this._grid.set(e.x,e.y,t)},e.prototype.move=function(e,t){var o=this._grid.get(e.x,e.y);o&&(this._grid.set(e.x,e.y,null),this._grid.set(t.x,t.y,o))},e.prototype.destroy=function(e){this._grid.get(e.x,e.y)&&this._grid.set(e.x,e.y,null)},e.prototype.swap=function(e,t){this._grid.swap(e.x,e.y,t.x,t.y)},e.prototype.get=function(e,t){return this._grid.get(e,t)},e.prototype.empty=function(e,t){return null===this._grid.get(e,t)},e}();o.BoardLogicModel=i,cc._RF.pop()},{"../../../../core/collections/Matrix":"Matrix"}],BoardMutationsBatch:[function(e,t,o){"use strict";cc._RF.push(t,"9d99fTbKVFF9pbnBqDTUx0L","BoardMutationsBatch"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardMutationsBatch=void 0;var n=function(){function e(){this.mutations=[]}return e.prototype.push=function(e){this.mutations.push(e)},e}();o.BoardMutationsBatch=n,cc._RF.pop()},{}],BoardPositionalModel:[function(e,t,o){"use strict";cc._RF.push(t,"c7bfc6tjhhEPZXQ/TdQm2xE","BoardPositionalModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardPositionalModel=void 0;var n=e("../../../application/board/BoardKey"),i=function(){function e(){this._map=new Map}return e.prototype.register=function(e,t){this._map.set(n.BoardKey.position(e),t)},e.prototype.get=function(e){return this._map.get(n.BoardKey.position(e))},e.prototype.remove=function(e){this._map.delete(n.BoardKey.position(e))},e}();o.BoardPositionalModel=i,cc._RF.pop()},{"../../../application/board/BoardKey":"BoardKey"}],BoardService:[function(e,t,o){"use strict";cc._RF.push(t,"84623Zdp3FDb4pT4zg1jwcO","BoardService"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardService=void 0;var n=function(){return function(e,t,o){this.logicModel=e,this.typeRepo=t,this.positionRepo=o}}();o.BoardService=n,cc._RF.pop()},{}],BoardStrategyFactory:[function(e,t,o){"use strict";cc._RF.push(t,"de312w3wdxGsY5yCncHuFcD","BoardStrategyFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardStrategyFactory=void 0;var n=e("../../../../domain/board/models/TileType"),i=e("./BombStrategy"),r=e("./NormalStrategy"),s=e("./RocketStrategy"),a=e("./SuperBombStrategy"),c=function(){function e(e,t,o,n,i,r,s,a){this._boardInfo=e,this._interactivityModel=t,this._typeRepo=o,this._searchService=n,this._destroyService=i,this._transformService=r,this._moveService=s,this._spawnService=a}return e.prototype.getStrategy=function(e){var t=this._typeRepo.get(e);switch(t){case n.TileType.RED:case n.TileType.GREEN:case n.TileType.BLUE:case n.TileType.PURPLE:case n.TileType.YELLOW:return new r.NormalStrategy(this._boardInfo,this._interactivityModel,this._searchService,this._destroyService,this._transformService,this._moveService,this._spawnService);case n.TileType.BOMB:return new i.BombStrategy(this._boardInfo,this._interactivityModel,this._destroyService,this._moveService,this._spawnService);case n.TileType.HORIZONTAL_ROCKET:case n.TileType.VERTICAL_ROCKET:return new s.RocketStrategy(t,this._interactivityModel,this._destroyService,this._moveService,this._spawnService);case n.TileType.SUPER_BOMB:return new a.SuperBombStrategy(this._interactivityModel,this._destroyService,this._moveService,this._spawnService);default:throw new Error("Unknown tile type: "+t)}},e}();o.BoardStrategyFactory=c,cc._RF.pop()},{"../../../../domain/board/models/TileType":"TileType","./BombStrategy":"BombStrategy","./NormalStrategy":"NormalStrategy","./RocketStrategy":"RocketStrategy","./SuperBombStrategy":"SuperBombStrategy"}],BoardViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"493d5P3Og5P2pe7KPcaugF9","BoardViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoardViewContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.visualConfig=t.visualConfig,o.tweenSystem=t.tweenSystem,o.boardCols=t.boardCols,o.boardRows=t.boardRows,o}return n(t,e),t}(e("../../common/context/EventViewContext").EventViewContext);o.BoardViewContext=i,cc._RF.pop()},{"../../common/context/EventViewContext":"EventViewContext"}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"bb883j+cbZB3Jz/i+gZlUKc","BoardView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardView=void 0;var r=e("../../../domain/board/events/BoardMutationsBatch"),s=e("../../common/assets/RocketAssets"),a=e("../../common/assets/ShardAssets"),c=e("../../common/assets/TileAssets"),u=e("../../common/view/EventView"),l=e("../context/BoardViewContext"),p=e("../events/GameLoaded"),d=e("./InitialBatchGate"),h=e("./TileVisualOrchestrator"),f=cc._decorator,_=f.ccclass,y=f.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.backgroundLayer=null,t.tileLayer=null,t.fxLayer=null,t.tiles=null,t.shards=null,t.rockets=null,t.flash=null,t.onBoardMutated=function(e){t._startupGate.started?t._visualOrchestrator.dispatch(e):t._startupGate.register(e)},t.onGameLoaded=function(e){t._startupGate.proceed()},t}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new l.BoardViewContext(e)}},t.prototype.onInit=function(){var e=this;this._visualOrchestrator=new h.TileVisualOrchestrator(this.context.eventBus,this.context.visualConfig,this.context.tweenSystem,this.context.boardCols,this.context.boardRows,this.backgroundLayer,this.tileLayer,this.fxLayer,this.tiles,this.shards,this.rockets,this.flash),this._startupGate=new d.InitialBatchGate(function(t){return e._visualOrchestrator.init(t)});var t=this.context.boardCols*this.context.visualConfig.tileWidth,o=this.context.boardRows*this.context.visualConfig.tileHeight;this.backgroundLayer.setContentSize(t+2*this.context.visualConfig.boardWidthPadding,o+2*this.context.visualConfig.boardHeightPadding),this.tileLayer.setContentSize(t,o),this.fxLayer.setContentSize(t,o),this.on(r.BoardMutationsBatch,this.onBoardMutated),this.on(p.GameLoaded,this.onGameLoaded)},t.prototype.onDispose=function(){this._visualOrchestrator.dispose()},i([y(cc.Node)],t.prototype,"backgroundLayer",void 0),i([y(cc.Node)],t.prototype,"tileLayer",void 0),i([y(cc.Node)],t.prototype,"fxLayer",void 0),i([y(c.TileAssets)],t.prototype,"tiles",void 0),i([y(a.ShardAssets)],t.prototype,"shards",void 0),i([y(s.RocketAssets)],t.prototype,"rockets",void 0),i([y(cc.Prefab)],t.prototype,"flash",void 0),t=i([_],t)}(u.EventView);o.BoardView=v,cc._RF.pop()},{"../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","../../common/assets/RocketAssets":"RocketAssets","../../common/assets/ShardAssets":"ShardAssets","../../common/assets/TileAssets":"TileAssets","../../common/view/EventView":"EventView","../context/BoardViewContext":"BoardViewContext","../events/GameLoaded":"GameLoaded","./InitialBatchGate":"InitialBatchGate","./TileVisualOrchestrator":"TileVisualOrchestrator"}],BoardVisualModel:[function(e,t,o){"use strict";cc._RF.push(t,"3ee0dXcdXhKYpOom0IludlY","BoardVisualModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoardVisualModel=void 0;var n=function(){function e(){this._map=new Map}return e.prototype.register=function(e){this._map.set(e.id,e)},e.prototype.get=function(e){return this._map.get(e)},e.prototype.remove=function(e){this._map.delete(e)},e}();o.BoardVisualModel=n,cc._RF.pop()},{}],BombEmplaceIntent:[function(e,t,o){"use strict";cc._RF.push(t,"d7c4c2w+9hHcJ/3kCyLGrh6","BombEmplaceIntent"),Object.defineProperty(o,"__esModule",{value:!0}),o.BombEmplaceIntent=void 0;var n=function(){return function(e){this.id=e}}();o.BombEmplaceIntent=n,cc._RF.pop()},{}],BombStrategy:[function(e,t,o){"use strict";cc._RF.push(t,"1c403TSqFVLBrKJ0zqbwA8q","BombStrategy");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BombStrategy=void 0;var i=e("../../../../domain/board/events/BoardMutationsBatch"),r=function(e){function t(t,o,n,i,r){var s=e.call(this,o,i,r)||this;return s._boardInfo=t,s._destroyService=n,s}return n(t,e),t.prototype.execute=function(e){var t=this,o=new i.BoardMutationsBatch,n=this._destroyService.destroyInRadius(e,this._boardInfo.bombRadius,"bomb");return null===n?o:(o.push(n),n.destroyed.forEach(function(e){return t.destabilize(e)}),this.drop(o),this.spawn(o),o)},t}(e("./BaseBoardStrategy").BaseBoardStrategy);o.BombStrategy=r,cc._RF.pop()},{"../../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","./BaseBoardStrategy":"BaseBoardStrategy"}],BoosterAssets:[function(e,t,o){"use strict";cc._RF.push(t,"2b7f4l0FadHlaR7bWf/zCBW","BoosterAssets");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterAssets=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../../core/utils/ensure"),a=e("../../../domain/state/models/BoosterType"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.swap=null,t.bomb=null,t}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.validate=function(){this._map=new Map([[a.BoosterType.SWAP,s.ensureNotNull(this.swap,this,"SWAP")],[a.BoosterType.BOMB,s.ensureNotNull(this.bomb,this,"BOMB")]])},t.prototype.getSprite=function(e){var t=this._map.get(e);return r.assertNotNull(t,this,"Sprite for type "+a.BoosterType[e]),t},i([l(cc.SpriteFrame)],t.prototype,"swap",void 0),i([l(cc.SpriteFrame)],t.prototype,"bomb",void 0),t=i([u],t)}(cc.Component);o.BoosterAssets=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/ensure":"ensure","../../../domain/state/models/BoosterType":"BoosterType"}],BoosterClicked:[function(e,t,o){"use strict";cc._RF.push(t,"dacedsLCkVJtrquPqqEamps","BoosterClicked"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterClicked=void 0;var n=function(){return function(e){this.type=e}}();o.BoosterClicked=n,cc._RF.pop()},{}],BoosterIntentComplete:[function(e,t,o){"use strict";cc._RF.push(t,"9a86a2keEhIy6DVt165ouNm","BoosterIntentComplete"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterIntentComplete=void 0;var n=function(){return function(e){this.type=e}}();o.BoosterIntentComplete=n,cc._RF.pop()},{}],BoosterSelected:[function(e,t,o){"use strict";cc._RF.push(t,"77ca6Vu4QxIpIGwwtkY1WAA","BoosterSelected"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterSelected=void 0;var n=function(){return function(e){this.type=e}}();o.BoosterSelected=n,cc._RF.pop()},{}],BoosterType:[function(e,t,o){"use strict";cc._RF.push(t,"3c793bmMw5KT6mmyB8Wrq1c","BoosterType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterType=void 0,function(e){e[e.NONE=0]="NONE",e[e.SWAP=1]="SWAP",e[e.BOMB=2]="BOMB"}(o.BoosterType||(o.BoosterType={})),cc._RF.pop()},{}],BoosterUsed:[function(e,t,o){"use strict";cc._RF.push(t,"5369aZVW8ZARrOjhprNugoF","BoosterUsed");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterUsed=void 0;var i=function(e){function t(t,o){var n=e.call(this,o)||this;return n.type=t,n}return n(t,e),t}(e("../../../../core/eventbus/ValueChangedEvent").ValueChangedEvent);o.BoosterUsed=i,cc._RF.pop()},{"../../../../core/eventbus/ValueChangedEvent":"ValueChangedEvent"}],BoosterViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"b5accGas6ZM3omH6ews3NJ+","BoosterViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterViewContext=void 0;var i=function(e){function t(t,o){var n=e.call(this,t)||this;n._type=o;var i=n.presentation.boosters.get(n._type);return n.setInitial(i),n}return n(t,e),t}(e("../../common/context/DynamicTextViewContext").DynamicTextViewContext);o.BoosterViewContext=i,cc._RF.pop()},{"../../common/context/DynamicTextViewContext":"DynamicTextViewContext"}],BoosterView:[function(e,t,o){"use strict";cc._RF.push(t,"5ee40kDXgNCXYG5ENBk6GL3","BoosterView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterView=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../application/input/intents/BoosterSelected"),a=e("../../../application/state/events/BoosterUsed"),c=e("../../../domain/state/models/BoosterType"),u=e("../../board/events/BoosterClicked"),l=e("../../common/assets/BoosterAssets"),p=e("../../common/view/DynamicTextView"),d=e("../context/BoosterViewContext"),h=cc._decorator,f=h.ccclass,_=h.property,y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetSprite=null,t.backgroundHighlight=null,t.assets=null,t.type=c.BoosterType.NONE,t._highlightState=!1,t.onBoosterSelected=function(e){t.highlight(e.type===t.type)},t}return n(t,e),t.prototype.contextFactory=function(){var e=this;return function(t){return new d.BoosterViewContext(t,e.type)}},t.prototype.onInit=function(){e.prototype.onInit.call(this),this.on(s.BoosterSelected,this.onBoosterSelected),this.highlight(!1)},t.prototype.validate=function(){e.prototype.validate.call(this),r.assertNotNull(this.targetSprite,this,"target"),r.assertNotNull(this.assets,this,"assets"),r.assert(this.type!==c.BoosterType.NONE,this,"booster type can't be NONE")},t.prototype.onClick=function(){this.emit(new u.BoosterClicked(this.type))},t.prototype.highlight=function(e){this.backgroundHighlight.active=e},t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=this.assets.getSprite(this.type);r.assertNotNull(t,this,"sprite"),this.targetSprite.spriteFrame=t},t.prototype.eventType=function(){return a.BoosterUsed},t.prototype.accept=function(e){return e.type===this.type},t.prototype.format=function(e){return e.toString()},i([_(cc.Sprite)],t.prototype,"targetSprite",void 0),i([_(cc.Node)],t.prototype,"backgroundHighlight",void 0),i([_(l.BoosterAssets)],t.prototype,"assets",void 0),i([_({type:cc.Enum(c.BoosterType)})],t.prototype,"type",void 0),t=i([f],t)}(p.DynamicTextView);o.BoosterView=y,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../application/input/intents/BoosterSelected":"BoosterSelected","../../../application/state/events/BoosterUsed":"BoosterUsed","../../../domain/state/models/BoosterType":"BoosterType","../../board/events/BoosterClicked":"BoosterClicked","../../common/assets/BoosterAssets":"BoosterAssets","../../common/view/DynamicTextView":"DynamicTextView","../context/BoosterViewContext":"BoosterViewContext"}],BurstMotion:[function(e,t,o){"use strict";cc._RF.push(t,"f5f75KYHdhDNaczZhkojcUc","BurstMotion");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BurstMotion=void 0;var r=e("../board/events/ShardFaded"),s=cc._decorator.ccclass,a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._eventBus=null,t._vx=0,t._vy=0,t._gravity=0,t._drag=1,t._av=0,t._duration=.5,t._fadeDelay=.7,t._shrinkScale=.2,t._elapsed=0,t._initialScale=1,t._fadeStartTime=0,t._running=!1,t}return n(t,e),t.prototype.play=function(e,t,o,n,i,r,s,a,c){this._eventBus=e,this._elapsed=0,this._running=!0,this._initialScale=this.node.scale,this._vx=t,this._vy=o,this._gravity=n,this._drag=i,this._av=r,this._duration=s,this._fadeDelay=a,this._shrinkScale=c,this._fadeStartTime=this._duration*this._fadeDelay,this.node.opacity=255},t.prototype.update=function(e){var t;if(this._running){if(this._elapsed+=e,this._elapsed>=this._duration)return null===(t=this._eventBus)||void 0===t||t.emit(new r.ShardFaded(this.node)),void(this._running=!1);this._vy-=this._gravity*e;var o=Math.pow(this._drag,60*e);if(this._vx*=o,this._vy*=o,this.node.x+=this._vx*e,this.node.y+=this._vy*e,this.node.angle+=this._av*e,this._elapsed>=this._fadeStartTime){var n=(this._elapsed-this._fadeStartTime)/(this._duration-this._fadeStartTime);this.node.opacity=255*(1-n),this.node.scale=cc.misc.lerp(this._initialScale,this._shrinkScale,n)}}},t=i([s],t)}(cc.Component);o.BurstMotion=a,cc._RF.pop()},{"../board/events/ShardFaded":"ShardFaded"}],BurstSettings:[function(e,t,o){"use strict";cc._RF.push(t,"b50e4KT3o1MnIKRTwzF+X7h","BurstSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],BurstTween:[function(e,t,o){"use strict";cc._RF.push(t,"c36e4v40tlLbZuTno/y2TSo","BurstTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.BurstTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.BURST}return e.prototype.build=function(e){return cc.tween(e.node).delay(e.duration)},e}();o.BurstTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],ColorRecord:[function(e,t,o){"use strict";cc._RF.push(t,"921e673GLNLxbPemaL16Gr7","ColorRecord");var n=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ColorRecord=void 0;var i=e("../../../domain/board/models/TileType"),r=cc._decorator,s=r.ccclass,a=r.property,c=function(){function e(){this.type=i.TileType.RED,this.color=cc.Color.WHITE}return n([a({type:cc.Enum(i.TileType)})],e.prototype,"type",void 0),n([a(cc.Color)],e.prototype,"color",void 0),e=n([s("ColorRecord")],e)}();o.ColorRecord=c,cc._RF.pop()},{"../../../domain/board/models/TileType":"TileType"}],ConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"4c42df3M+lCVb4rhi8GvaA4","ConfigLoader");var n=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.ConfigLoader=void 0;var r=function(){function e(){}return e.prototype.load=function(e){return n(this,void 0,Promise,function(){var t,o;return i(this,function(n){switch(n.label){case 0:return t=this.createValidator(),[4,(o=this.createProvider(e,t)).load()];case 1:return n.sent(),[2,o.get()]}})})},e}();o.ConfigLoader=r,cc._RF.pop()},{}],ConfigMode:[function(e,t,o){"use strict";cc._RF.push(t,"66980YuZY9M9oIcppGVJado","ConfigMode"),Object.defineProperty(o,"__esModule",{value:!0}),o.ConfigMode=void 0,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.JSON=1]="JSON"}(o.ConfigMode||(o.ConfigMode={})),cc._RF.pop()},{}],ContextView:[function(e,t,o){"use strict";cc._RF.push(t,"9c93bf+0u9PVaZ2BjXiiCzz","ContextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ContextView=void 0;var i=e("../../../../core/utils/assert"),r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._initialized=!1,t}return n(t,e),t.prototype.init=function(e){this._initialized||(i.assertNotNull(e,this,"context"),this.context=e,this.preInit(),this.onInit(),this.postInit(),this._initialized=!0)},t.prototype.preInit=function(){},t.prototype.onInit=function(){},t.prototype.postInit=function(){},t.prototype.dispose=function(){this._initialized&&(this.onDispose(),this._initialized=!1)},t.prototype.onDestroy=function(){this.dispose()},t.prototype.onDispose=function(){},t}(e("./BaseView").BaseView);o.ContextView=r,cc._RF.pop()},{"../../../../core/utils/assert":"assert","./BaseView":"BaseView"}],DefaultGameConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"0e7f8Ecjk9GCJWqdqp3Vi3B","DefaultGameConfigProvider");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DefaultGameConfigProvider=void 0;var s=e("../../../core/config/providers/BaseConfigProvider"),a=e("../../domain/board/models/TileType"),c=e("../../domain/state/models/BoosterType"),u=e("./ThresholdType"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.load=function(){return i(this,void 0,Promise,function(){var e,t;return r(this,function(o){return(e=[{type:u.ThresholdType.ROCKET,amount:4},{type:u.ThresholdType.BOMB,amount:6},{type:u.ThresholdType.SUPER_BOMB,amount:10}]).sort(function(e,t){return t.amount-e.amount}),t=new Map([[c.BoosterType.SWAP,3],[c.BoosterType.BOMB,3]]),this.config={board:{cols:8,rows:8,allowedTypes:[a.TileType.RED,a.TileType.GREEN,a.TileType.BLUE,a.TileType.PURPLE,a.TileType.YELLOW],clusterSize:3,bombRadius:1,specials:e},gameState:{targetScore:500,maxMoves:20,scoreMultiplier:5,boosters:t}},[2]})})},t}(s.BaseConfigProvider);o.DefaultGameConfigProvider=l,cc._RF.pop()},{"../../../core/config/providers/BaseConfigProvider":"BaseConfigProvider","../../domain/board/models/TileType":"TileType","../../domain/state/models/BoosterType":"BoosterType","./ThresholdType":"ThresholdType"}],DefaultVisualConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"6146fuI6fNI1brorxqqlqYa","DefaultVisualConfigProvider");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.DefaultVisualConfigProvider=void 0;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.load=function(){return i(this,void 0,Promise,function(){var e,t,o,n;return r(this,function(i){return e={minCount:6,maxCount:12,minUpVelocity:750,maxUpVelocity:1200,horizontalSpread:350,spawnRadius:120,minScale:.9,maxScale:1.3,minAngular:-900,maxAngular:900,gravity:3e3,dragMin:.94,dragMax:.985,duration:.9,fadeDelay:.7,shrinkScale:.9},t={gravity:3e3,delay:.01,bounce:10,bounceDuration:.08,settleDuration:.08},o={pullDistance:18,overshootDistance:6,pullDuration:.09,launchSpeed:1600,minLaunchDuration:.12,maxLaunchDuration:.28,settleDuration:.07,disappearDistance:25},n={speed:5},this.config={initialSpawnLine:8,normalSpawnLine:7,tileWidth:100,tileHeight:112,boardWidthPadding:42,boardHeightPadding:58,burst:e,drop:t,sling:o,rocket:n},[2]})})},t}(e("../../../core/config/providers/BaseConfigProvider").BaseConfigProvider);o.DefaultVisualConfigProvider=s,cc._RF.pop()},{"../../../core/config/providers/BaseConfigProvider":"BaseConfigProvider"}],DestroyMutation:[function(e,t,o){"use strict";cc._RF.push(t,"c27b3rlVkhKNZRjl5Sul8t4","DestroyMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DestroyService:[function(e,t,o){"use strict";cc._RF.push(t,"2017bzN6wxEHaE6OOFvY8CH","DestroyService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.DestroyService=void 0;var i=e("../events/mutations/TileMutationHelper"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.destroyNormalCluster=function(e,t,o){for(var n=[],r=0,s=e;r<s.length;r++){var a=s[r];this.tryDestroyTile(a)&&n.push(a)}return i.TileMutationHelper.destroyed(t,n,o)},t.prototype.destroyAll=function(e,t){for(var o=[],n=0;n<this.logicModel.width;n++)for(var r=0;r<this.logicModel.height;r++){var s=this.logicModel.get(n,r);null!==s&&(this.tryDestroyTile(s)&&o.push(s))}return i.TileMutationHelper.destroyed(e,o,t)},t.prototype.destroyInRow=function(e,t){var o=this.positionRepo.get(e);if(!o)return null;for(var n=[],r=0;r<this.logicModel.width;r++){var s=this.logicModel.get(r,o.y);null!==s&&(this.tryDestroyTile(s)&&n.push(s))}return 0===n.length?null:i.TileMutationHelper.destroyed(e,n,t)},t.prototype.destroyInCol=function(e,t){var o=this.positionRepo.get(e);if(!o)return null;for(var n=[],r=0;r<this.logicModel.height;r++){var s=this.logicModel.get(o.x,r);null!==s&&(this.tryDestroyTile(s)&&n.push(s))}return 0===n.length?null:i.TileMutationHelper.destroyed(e,n,t)},t.prototype.destroyInRadius=function(e,t,o){var n=this.positionRepo.get(e);if(!n)return null;for(var r=[],s=Math.max(0,n.x-t),a=Math.min(this.logicModel.width-1,n.x+t),c=Math.max(0,n.y-t),u=Math.min(this.logicModel.height-1,n.y+t),l=s;l<=a;l++)for(var p=c;p<=u;p++){var d=this.logicModel.get(l,p);d&&(this.tryDestroyTile(d)&&r.push(d))}return 0===r.length?null:i.TileMutationHelper.destroyed(e,r,o)},t.prototype.tryDestroyTile=function(e){var t=this.positionRepo.get(e);return!!t&&(this.logicModel.destroy(t),this.typeRepo.remove(e),this.positionRepo.remove(e),!0)},t}(e("./BoardService").BoardService);o.DestroyService=r,cc._RF.pop()},{"../events/mutations/TileMutationHelper":"TileMutationHelper","./BoardService":"BoardService"}],DestroyTween:[function(e,t,o){"use strict";cc._RF.push(t,"c98f3o5sHxEuoZWEnT0oT+2","DestroyTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.DestroyTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.DESTROY}return e.prototype.build=function(e){var t=e.node,o=t.scale,n=t.opacity;return cc.tween(t).to(e.squashDuration,{scale:o*e.squashScale},{easing:"sineOut"}).to(e.popDuration,{scale:o*e.popScale},{easing:"quadOut"}).parallel(cc.tween().to(e.shrinkDuration,{opacity:e.shrinkOpacity}),cc.tween().to(e.shrinkDuration,{scale:o*e.shrinkScale})).call(function(){t.scale=o,t.opacity=n})},e}();o.DestroyTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],DestructionSettings:[function(e,t,o){"use strict";cc._RF.push(t,"1cdf0mn/rJGZrEhGF/HLoC/","DestructionSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DomainGraph:[function(e,t,o){"use strict";cc._RF.push(t,"41165Rc0RxJUIBr1pAhMjhn","DomainGraph"),Object.defineProperty(o,"__esModule",{value:!0}),o.DomainGraph=void 0;var n=e("./board/models/BoardLogicModel"),i=e("./board/models/TileFactory"),r=e("./board/models/TilePositionRepo"),s=e("./board/models/TileTypeRepo"),a=e("./board/services/DestroyService"),c=e("./board/services/MoveService"),u=e("./board/services/SearchService"),l=e("./board/services/SpawnService"),p=e("./board/services/TransformService"),d=e("./state/models/GameStateModel"),h=e("./state/services/ScoreService"),f=function(){return function(e){this.boardInfo=e.board,this.stateInfo=e.gameState,this.logicModel=new n.BoardLogicModel(this.boardInfo.cols,this.boardInfo.rows),this.stateModel=new d.GameStateModel(this.stateInfo),this.typeRepo=new s.TileTypeRepo,this.positionRepo=new r.TilePositionRepo,this.tileFactory=new i.TileFactory,this.spawnService=new l.SpawnService(this.logicModel,this.typeRepo,this.positionRepo,this.tileFactory,this.boardInfo.allowedTypes),this.searchService=new u.SearchService(this.logicModel,this.typeRepo,this.positionRepo),this.destroyService=new a.DestroyService(this.logicModel,this.typeRepo,this.positionRepo),this.moveService=new c.MoveService(this.logicModel,this.typeRepo,this.positionRepo),this.transformService=new p.TransformService(this.logicModel,this.typeRepo,this.positionRepo),this.scoreService=new h.ScoreService(this.stateInfo.scoreMultiplier)}}();o.DomainGraph=f,cc._RF.pop()},{"./board/models/BoardLogicModel":"BoardLogicModel","./board/models/TileFactory":"TileFactory","./board/models/TilePositionRepo":"TilePositionRepo","./board/models/TileTypeRepo":"TileTypeRepo","./board/services/DestroyService":"DestroyService","./board/services/MoveService":"MoveService","./board/services/SearchService":"SearchService","./board/services/SpawnService":"SpawnService","./board/services/TransformService":"TransformService","./state/models/GameStateModel":"GameStateModel","./state/services/ScoreService":"ScoreService"}],DropMotion:[function(e,t,o){"use strict";cc._RF.push(t,"60f9f4FSChJn6r/q+Dv52SJ","DropMotion");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.DropMotion=void 0;var r,s=cc._decorator.ccclass;(function(e){e[e.IDLE=0]="IDLE",e[e.DELAY=1]="DELAY",e[e.DROP=2]="DROP",e[e.BOUNCE=3]="BOUNCE",e[e.SETTLE=4]="SETTLE",e[e.DONE=5]="DONE"})(r||(r={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._phase=r.IDLE,t._fromY=0,t._toY=0,t._delay=0,t._bounce=0,t._bounceDuration=0,t._settleDuration=0,t._gravity=0,t._dropDuration=0,t._elapsed=0,t._running=!1,t._phaseTime=0,t._onDropped=null,t}return n(t,e),t.prototype.quadIn=function(e){return e*e},t.prototype.quadOut=function(e){return e*(2-e)},t.prototype.play=function(e,t,o,n){this._gravity=n.gravity,this._fromY=e,this._toY=t;var i=Math.abs(t-e);this._dropDuration=Math.sqrt(2*i/n.gravity),this._delay=o,this._bounce=n.bounce,this._bounceDuration=n.bounceDuration,this._settleDuration=n.settleDuration,this.node.y=e,this._elapsed=0,this._phaseTime=0,this._running=!0,this._phase=o>0?r.DELAY:r.DROP},Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),t.prototype.onDropped=function(e){this._onDropped=e},t.prototype.update=function(e){var t;if(this._running)switch(this._elapsed+=e,this._phaseTime+=e,this._phase){case r.DELAY:this._phaseTime>=this._delay&&(this._phase=r.DROP,this._phaseTime=0);break;case r.DROP:var o=Math.min(this._phaseTime/this._dropDuration,1),n=this.quadIn(o);this.node.y=this._fromY+(this._toY-this._fromY)*n,o>=1&&(this._phase=r.BOUNCE,this._phaseTime=0);break;case r.BOUNCE:o=Math.min(this._phaseTime/this._bounceDuration,1),n=this.quadOut(o);this.node.y=this._toY+this._bounce*n,o>=1&&(this._phase=r.SETTLE,this._phaseTime=0);break;case r.SETTLE:o=Math.min(this._phaseTime/this._settleDuration,1),n=this.quadIn(o);this.node.y=this._toY+this._bounce*(1-n),o>=1&&(this.node.y=this._toY,this._phase=r.DONE,this._running=!1,null===(t=this._onDropped)||void 0===t||t.call(this),this._onDropped=null)}},t=i([s],t)}(cc.Component);o.DropMotion=a,cc._RF.pop()},{}],DropSettings:[function(e,t,o){"use strict";cc._RF.push(t,"d5b03ewPeJO5b6A2qxGH0/F","DropSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],DropTween:[function(e,t,o){"use strict";cc._RF.push(t,"fafc8YvYKlCDpzTXkIP9ROC","DropTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.DropTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.DROP}return e.prototype.build=function(e){return cc.tween(e.node).delay(e.duration)},e}();o.DropTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],DynamicTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"243ecVuTBJBlo2DFPE2Htsc","DynamicTextViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.DynamicTextViewContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.initial=-1,o}return n(t,e),t.prototype.setInitial=function(e){this.initial=null!==e&&void 0!==e?e:-1},t}(e("./EventViewContext").EventViewContext);o.DynamicTextViewContext=i,cc._RF.pop()},{"./EventViewContext":"EventViewContext"}],DynamicTextView:[function(e,t,o){"use strict";cc._RF.push(t,"0f168cD/SdDKqVh9wvhZVsP","DynamicTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.DynamicTextView=void 0;var r=e("../../../../core/utils/assert"),s=e("./EventView"),a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetLabel=null,t.onValueChanged=function(e){t.accept(e)&&t.render(e.value)},t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),r.assertNotNull(this.targetLabel,this,"targetLabel")},t.prototype.preInit=function(){e.prototype.preInit.call(this),r.assertNumber(this.context.initial,this,"initialValue")},t.prototype.onInit=function(){this.on(this.eventType(),this.onValueChanged)},t.prototype.postInit=function(){this.render(this.context.initial)},t.prototype.accept=function(e){return!0},t.prototype.render=function(e){this.targetLabel.string=this.format(e)},i([u(cc.Label)],t.prototype,"targetLabel",void 0),t=i([c],t)}(s.EventView);o.DynamicTextView=l,cc._RF.pop()},{"../../../../core/utils/assert":"assert","./EventView":"EventView"}],EventBus:[function(e,t,o){"use strict";cc._RF.push(t,"4dd3bCOr0RC6b0g0I2ZgBu1","EventBus"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventBus=void 0;var n=function(){function e(){this._listeners=new Map}return e.prototype.on=function(e,t){var o,n=this,i=null!==(o=this._listeners.get(e))&&void 0!==o?o:[];return i.push(t),this._listeners.set(e,i),{unsubscribe:function(){return n.off(e,t)}}},e.prototype.off=function(e,t){var o=this._listeners.get(e);if(o){var n=o.indexOf(t);-1!==n&&o.splice(n,1)}},e.prototype.emit=function(e){var t=this._listeners.get(e.constructor);if(t)for(var o=0,n=t;o<n.length;o++){(0,n[o])(e)}},e.prototype.clear=function(){this._listeners.clear()},e.prototype.waitForRemaining=function(e,t){var o=this;return new Promise(function(n){var i=t,r=o.on(e,function(){--i<=0&&(r.unsubscribe(),n())})})},e.prototype.waitForSpecific=function(e){var t=this;return new Promise(function(o){var n=t.on(e,function(e){n.unsubscribe(),o(e)})})},e}();o.EventBus=n,cc._RF.pop()},{}],EventViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"c34d1GkKTNIir2ulEw3eXmO","EventViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.EventViewContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.eventBus=t.eventBus,o}return n(t,e),t}(e("../view/PresentationViewContext").PresentationViewContext);o.EventViewContext=i,cc._RF.pop()},{"../view/PresentationViewContext":"PresentationViewContext"}],EventView:[function(e,t,o){"use strict";cc._RF.push(t,"9dc55NMdhVDNaqP2Y3DA+nU","EventView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.EventView=void 0;var i=e("../../../../core/eventbus/SubscriptionGroup"),r=e("../../../../core/utils/assert"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._subscriptions=new i.SubscriptionGroup,t}return n(t,e),t.prototype.preInit=function(){r.assertNotNull(this.context.eventBus,this,"eventBus")},t.prototype.onDispose=function(){this._subscriptions.clear()},t.prototype.on=function(e,t){var o=this.context.eventBus.on(e,t);this._subscriptions.add(o)},t.prototype.emit=function(e){this.context.eventBus.emit(e)},t}(e("./PresentationView").PresentationView);o.EventView=s,cc._RF.pop()},{"../../../../core/eventbus/SubscriptionGroup":"SubscriptionGroup","../../../../core/utils/assert":"assert","./PresentationView":"PresentationView"}],FadeSettings:[function(e,t,o){"use strict";cc._RF.push(t,"a2c91O6FmtG0rsgupz9InLy","FadeSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],FadeTween:[function(e,t,o){"use strict";cc._RF.push(t,"34a2dq1IHlDTZMhESV3iwgA","FadeTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.FadeTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.FADE}return e.prototype.build=function(e){return cc.tween(e.node).delay(e.delay).to(e.duration,{opacity:e.opacity},{easing:"quadOut"})},e}();o.FadeTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],FlashSettings:[function(e,t,o){"use strict";cc._RF.push(t,"ce14a7MiV9JjKi/YJUb6NOO","FlashSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],FlashTween:[function(e,t,o){"use strict";cc._RF.push(t,"7a5bdfwNbNNyLEQtCKA8K0x","FlashTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.FlashTween=void 0;var n=e("../../../../../core/utils/random"),i=e("./TweenType"),r=function(){function e(){this.type=i.TweenType.FLASH}return e.prototype.build=function(e){var t=n.Random.floatRange(0,360);e.node.angle=t;var o=n.Random.floatRange(-20,20);return cc.tween(e.node).parallel(cc.tween().to(e.durationIn,{opacity:e.peakOpacity,scale:e.node.scale*e.scaleIn}).to(e.durationOut,{opacity:0,scale:e.node.scale*e.scaleOut}),cc.tween().to(e.durationIn+e.durationOut,{angle:t+o}))},e}();o.FlashTween=r,cc._RF.pop()},{"../../../../../core/utils/random":"random","./TweenType":"TweenType"}],GameConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"2ed19M0P9lLlIQPuWAJuIRx","GameConfigLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigLoader=void 0;var i=e("../BaseConfigLoader"),r=e("./DefaultGameConfigProvider"),s=e("./GameConfigValidator"),a=e("../../settings/GameSettings"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getJsonPath=function(){return a.GameSettings.GAME_CONFIG},t.prototype.createValidator=function(){return new s.GameConfigValidator},t.prototype.getDefaultProvider=function(){return new r.DefaultGameConfigProvider},t}(i.BaseConfigLoader);o.GameConfigLoader=c,cc._RF.pop()},{"../../settings/GameSettings":"GameSettings","../BaseConfigLoader":"BaseConfigLoader","./DefaultGameConfigProvider":"DefaultGameConfigProvider","./GameConfigValidator":"GameConfigValidator"}],GameConfigValidator:[function(e,t,o){"use strict";cc._RF.push(t,"041e3xL6eVI+o3GAT8qc0ku","GameConfigValidator"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigValidator=void 0;var n=e("../../../core/utils/ensure"),i=e("../../domain/board/models/TileType"),r=e("../../domain/state/models/BoosterType"),s=e("./ThresholdType"),a=function(){function e(){}return e.prototype.validate=function(e){for(var t=this,o=n.ensureObject(e,this,"raw"),a=n.ensureObject(o.board,this,"board"),c=n.ensureNumber(a.cols,this,"board.cols"),u=n.ensureNumber(a.rows,this,"board.rows"),l=n.ensureNonEmptyArray(a.allowedTypes,this,"board.allowedTypes").map(function(e,o){return n.ensureEnumValue(i.TileType,e,t,"board.allowedTypes"+o)}),p=n.ensureNumber(a.clusterSize,this,"board.cluster"),d=n.ensureNumber(a.bombRadius,this,"board.bombRadius"),h=n.ensureObject(a.specials,this,"board.specials"),f=[],_=0,y=Object.entries(h);_<y.length;_++){var v=y[_],m=v[0],b=v[1],w={type:n.ensureEnumValue(s.ThresholdType,m,this,"board.specials."+m),amount:V=n.ensureNumber(b,this,"board.specials."+b)};f.push(w)}f.sort(function(e,t){return t.amount-e.amount});for(var g={cols:c,rows:u,allowedTypes:l,clusterSize:p,bombRadius:d,specials:f},T=n.ensureObject(o.gameState,this,"gameState"),S=n.ensureNumber(T.targetScore,this,"gameState.targetScore"),R=n.ensureNumber(T.maxMoves,this,"gameState.maxMoves"),O=n.ensureNumber(T.scoreMultiplier,this,"gameState.scoreMultiplier"),B=n.ensureObject(T.boosters,this,"gameStateData.boosters"),P=new Map,M=0,F=Object.entries(B);M<F.length;M++){var C=F[M],x=(m=C[0],b=C[1],n.ensureEnumValue(r.BoosterType,m,this,"gameState.boosters."+m)),V=n.ensureNumber(b,this,"gameState.boosters."+m);P.set(x,V)}return{board:g,gameState:{targetScore:S,maxMoves:R,scoreMultiplier:O,boosters:P}}},e}();o.GameConfigValidator=a,cc._RF.pop()},{"../../../core/utils/ensure":"ensure","../../domain/board/models/TileType":"TileType","../../domain/state/models/BoosterType":"BoosterType","./ThresholdType":"ThresholdType"}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"1b26eLVJPZKR4fSnAImer1v","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GameContext:[function(e,t,o){"use strict";cc._RF.push(t,"64bc0LEG7ZINbxYKyD+r/S/","GameContext"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameContext=void 0;var n=e("../../core/eventbus/EventBus"),i=e("../application/ApplicationGraph"),r=e("../domain/DomainGraph"),s=e("../presentation/PresentationGraph"),a=function(){return function(e,t){this.eventBus=new n.EventBus,this.domain=new r.DomainGraph(e),this.application=new i.ApplicationGraph(this.eventBus,this.domain),this.presentation=new s.PresentationGraph(this.eventBus,t,e,this.domain)}}();o.GameContext=a,cc._RF.pop()},{"../../core/eventbus/EventBus":"EventBus","../application/ApplicationGraph":"ApplicationGraph","../domain/DomainGraph":"DomainGraph","../presentation/PresentationGraph":"PresentationGraph"}],GameEntry:[function(e,t,o){"use strict";cc._RF.push(t,"b0ca3TD77RJ4Zf8PJxueHcl","GameEntry");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GameEntry=void 0;var r=e("../bootstrap/GameSession"),s=e("../presentation/PresentationInstaller"),a=cc._decorator,c=a.ccclass,u=a.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.presentationInstaller=null,t}return n(t,e),t.prototype.start=function(){this.session=new r.GameSession(this.presentationInstaller),this.session.start()},t.prototype.onDestroy=function(){var e;null===(e=this.session)||void 0===e||e.dispose()},i([u(s.PresentationInstaller)],t.prototype,"presentationInstaller",void 0),t=i([c],t)}(cc.Component);o.GameEntry=l,cc._RF.pop()},{"../bootstrap/GameSession":"GameSession","../presentation/PresentationInstaller":"PresentationInstaller"}],GameLoaded:[function(e,t,o){"use strict";cc._RF.push(t,"4c71fuomwxKX5Y7qzfsikM6","GameLoaded"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameLoaded=void 0;var n=function(){return function(){}}();o.GameLoaded=n,cc._RF.pop()},{}],GameOverPopupContext:[function(e,t,o){"use strict";cc._RF.push(t,"09452f1NxREfoQiE8oKEnrv","GameOverPopupContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.GameOverPopupContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.tweenSystem=t.tweenSystem,o}return n(t,e),t}(e("../../common/context/EventViewContext").EventViewContext);o.GameOverPopupContext=i,cc._RF.pop()},{"../../common/context/EventViewContext":"EventViewContext"}],GameOverPopup:[function(e,t,o){"use strict";cc._RF.push(t,"cd3f0SAS6lDlaaeqMPmeS2d","GameOverPopup");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GameOverPopup=void 0;var r=e("../../../application/state/events/StateUpdate"),s=e("../../../domain/state/models/GameStateType"),a=e("../../board/events/GameRestartRequest"),c=e("../../common/animations/TweenSettings"),u=e("../../common/view/EventView"),l=e("../context/GameOverPopupContext"),p=e("./ScreenFade"),d=cc._decorator,h=d.ccclass,f=d.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.screenFade=null,t.wonRoot=null,t.lostRoot=null,t._state=s.GameStateType.NONE,t.onStateUpdate=function(e){t._state=e.value,t.show()},t}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new l.GameOverPopupContext(e)}},t.prototype.onInit=function(){this.node.active=!1,this.on(r.StateUpdate,this.onStateUpdate)},t.prototype.request=function(){this.screenFade.fadeOut(),this.emit(new a.GameRestartRequset)},t.prototype.show=function(){this._state!==s.GameStateType.WON&&this._state!==s.GameStateType.LOST||(this.node.active=!0,this.wonRoot.active=this._state===s.GameStateType.WON,this.lostRoot.active=this._state===s.GameStateType.LOST,this.startAnimation())},t.prototype.hide=function(){this.node.active=!1},t.prototype.startAnimation=function(){this.screenFade.fadeIn(),this.context.tweenSystem.build(c.TweenSettings.fade(this.node,0,.25,255)).start()},i([f(p.ScreenFade)],t.prototype,"screenFade",void 0),i([f(cc.Node)],t.prototype,"wonRoot",void 0),i([f(cc.Node)],t.prototype,"lostRoot",void 0),t=i([h],t)}(u.EventView);o.GameOverPopup=_,cc._RF.pop()},{"../../../application/state/events/StateUpdate":"StateUpdate","../../../domain/state/models/GameStateType":"GameStateType","../../board/events/GameRestartRequest":"GameRestartRequest","../../common/animations/TweenSettings":"TweenSettings","../../common/view/EventView":"EventView","../context/GameOverPopupContext":"GameOverPopupContext","./ScreenFade":"ScreenFade"}],GameRestartRequest:[function(e,t,o){"use strict";cc._RF.push(t,"fe7d9SbtqpINZT0mpkE9ll6","GameRestartRequest"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameRestartRequset=void 0;var n=function(){return function(){}}();o.GameRestartRequset=n,cc._RF.pop()},{}],GameSession:[function(e,t,o){"use strict";cc._RF.push(t,"14553TxHilH26iAYlc6GOpK","GameSession");var n=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameSession=void 0;var r=e("../config/game/GameConfigLoader"),s=e("../config/visual/VisualConfigLoader"),a=e("../presentation/board/events/GameRestartRequest"),c=e("../settings/GameSettings"),u=e("./GameContext"),l=function(){function e(e){var t=this;this._presentationInstaller=e,this._lifecycle=[],this.restart=function(){t.dispose(),t.start()}}return e.prototype.start=function(){return n(this,void 0,Promise,function(){var e,t,o;return i(this,function(n){switch(n.label){case 0:return e=c.GameSettings.CONFIG_MODE,[4,(new r.GameConfigLoader).load(e)];case 1:return t=n.sent(),[4,(new s.VisualConfigLoader).load(e)];case 2:return o=n.sent(),this._gameContext=new u.GameContext(t,o),this._presentationInstaller.prepare(this._gameContext.presentation),this._lifecycle=[this._presentationInstaller,this._gameContext.application.inputController,this._gameContext.application.interactivityController,this._gameContext.application.stateController,this._gameContext.application.logicController],this._gameContext.eventBus.on(a.GameRestartRequset,this.restart),this.init(),[2]}})})},e.prototype.init=function(){this._lifecycle.forEach(function(e){return e.init()})},e.prototype.dispose=function(){var e;null===(e=this._gameContext)||void 0===e||e.eventBus.clear(),this._gameContext=null,this._lifecycle.forEach(function(e){return e.dispose()}),this._lifecycle=[]},e}();o.GameSession=l,cc._RF.pop()},{"../config/game/GameConfigLoader":"GameConfigLoader","../config/visual/VisualConfigLoader":"VisualConfigLoader","../presentation/board/events/GameRestartRequest":"GameRestartRequest","../settings/GameSettings":"GameSettings","./GameContext":"GameContext"}],GameSettings:[function(e,t,o){"use strict";cc._RF.push(t,"6d565FyS8BE1bBzNxD+96YT","GameSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameSettings=void 0;var n=e("../config/ConfigMode");o.GameSettings={CONFIG_MODE:n.ConfigMode.JSON,GAME_CONFIG:"configs/game-config",VISUAL_CONFIG:"configs/visual-config"},cc._RF.pop()},{"../config/ConfigMode":"ConfigMode"}],GameStateController:[function(e,t,o){"use strict";cc._RF.push(t,"8abc8oftaBD6qCBxj9JRRs9","GameStateController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.GameStateController=void 0;var i=e("../events/NormalIntentComplete"),r=e("../events/MovesUpdate"),s=e("../events/ScoreUpdate"),a=e("../events/StateUpdate"),c=e("../../../domain/state/models/GameStateType"),u=e("../../common/controllers/BaseController"),l=e("../events/BoosterIntentComplete"),p=e("../events/BoosterUsed"),d=function(e){function t(t,o){var n=e.call(this,t)||this;return n.onNormalComplete=function(e){var t=n._gameStateModel.state,o=n._gameStateModel.currentScore,i=n._gameStateModel.movesLeft;n.calculateScore(e),n._gameStateModel.currentScore>=n._gameStateModel.targetScore&&n._gameStateModel.setState(c.GameStateType.WON),n._gameStateModel.useMove(),0===n._gameStateModel.movesLeft&&n._gameStateModel.state!==c.GameStateType.WON&&n._gameStateModel.setState(c.GameStateType.LOST),o!==n._gameStateModel.currentScore&&n.emit(new s.ScoreUpdate(n._gameStateModel.currentScore)),i!==n._gameStateModel.movesLeft&&n.emit(new r.MovesUpdate(n._gameStateModel.movesLeft)),t!==n._gameStateModel.state&&n.emit(new a.StateUpdate(n._gameStateModel.state))},n.onBoosterComplete=function(e){n._gameStateModel.useBooster(e.type);var t=n._gameStateModel.getBooster(e.type);n.emit(new p.BoosterUsed(e.type,t))},n._stateInfo=o.stateInfo,n._gameStateModel=o.stateModel,n._scoreService=o.scoreService,n}return n(t,e),t.prototype.onInit=function(){this._gameStateModel.setState(c.GameStateType.PLAYING),this.on(i.NormalIntentComplete,this.onNormalComplete),this.on(l.BoosterIntentComplete,this.onBoosterComplete)},t.prototype.calculateScore=function(e){this._gameStateModel.addScore(this._scoreService.calculateCluster(e.clusterDestroys)),this._gameStateModel.addScore(this._scoreService.calculateCollateral(e.collateralDestroys))},t}(u.EventController);o.GameStateController=d,cc._RF.pop()},{"../../../domain/state/models/GameStateType":"GameStateType","../../common/controllers/BaseController":"BaseController","../events/BoosterIntentComplete":"BoosterIntentComplete","../events/BoosterUsed":"BoosterUsed","../events/MovesUpdate":"MovesUpdate","../events/NormalIntentComplete":"NormalIntentComplete","../events/ScoreUpdate":"ScoreUpdate","../events/StateUpdate":"StateUpdate"}],GameStateModel:[function(e,t,o){"use strict";cc._RF.push(t,"99471UrmwxBoYieGRlv584Z","GameStateModel"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameStateModel=void 0;var n=e("./GameStateType"),i=function(){function e(e){this.targetScore=e.targetScore,this.maxMoves=e.maxMoves,this._movesLeft=this.maxMoves,this._currentScore=0,this._stateType=n.GameStateType.NONE,this._boosters=new Map(e.boosters)}return Object.defineProperty(e.prototype,"movesLeft",{get:function(){return this._movesLeft},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentScore",{get:function(){return this._currentScore},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._stateType},enumerable:!1,configurable:!0}),e.prototype.addScore=function(e){this._currentScore+=e},e.prototype.useMove=function(){this._movesLeft--},e.prototype.setState=function(e){this._stateType=e},e.prototype.useBooster=function(e){var t=this._boosters.get(e);t&&0!==t&&this._boosters.set(e,--t)},e.prototype.getBooster=function(e){var t=this._boosters.get(e);return null!==t&&void 0!==t?t:0},e}();o.GameStateModel=i,cc._RF.pop()},{"./GameStateType":"GameStateType"}],GameStateType:[function(e,t,o){"use strict";cc._RF.push(t,"1d988esIF9J9rI4hJixXE/p","GameStateType"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameStateType=void 0,function(e){e[e.NONE=0]="NONE",e[e.PLAYING=1]="PLAYING",e[e.WON=2]="WON",e[e.LOST=3]="LOST"}(o.GameStateType||(o.GameStateType={})),cc._RF.pop()},{}],IClickable:[function(e,t,o){"use strict";cc._RF.push(t,"ff21cgjevxFhb2kg32wVlEK","IClickable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"58c4c78lEFJBK0t7vKUhhpW","IConfigProvider"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IConfigValidator:[function(e,t,o){"use strict";cc._RF.push(t,"fd0b3vkXQdNkKrm68/euUS2","IConfigValidator"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IConfig:[function(e,t,o){"use strict";cc._RF.push(t,"8a20aZkj7NIib5OJO2YOEVQ","IConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IDisposable:[function(e,t,o){"use strict";cc._RF.push(t,"0d1f2BKAyRKradOcgIbpJtI","IDisposable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IEvent:[function(e,t,o){"use strict";cc._RF.push(t,"8fa1c68GtVNRKFHm/nx3oTX","IEvent"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IHighlightable:[function(e,t,o){"use strict";cc._RF.push(t,"16b5eavOJ1H45y531jzUj0G","IHighlightable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IInitializable:[function(e,t,o){"use strict";cc._RF.push(t,"ee3c8BQs6BEYJwkQjEK6TMK","IInitializable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ILifecycle:[function(e,t,o){"use strict";cc._RF.push(t,"3f690Z62XBB6oxO6CI8lNvX","ILifecycle"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IPopup:[function(e,t,o){"use strict";cc._RF.push(t,"a312cKwmBlPr7RieDvOt0RW","IPopup"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ITileMutation:[function(e,t,o){"use strict";cc._RF.push(t,"c60783Eqi1MiapB+UH7tYPw","ITileMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ITweenSettings:[function(e,t,o){"use strict";cc._RF.push(t,"651bbPMAMtJFrMr+hApoZfB","ITweenSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ITween:[function(e,t,o){"use strict";cc._RF.push(t,"220bdQQ2z1EdpCtBl1xwWsI","ITween"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IValidatable:[function(e,t,o){"use strict";cc._RF.push(t,"16605S+cj5B/rtndFr9BxXG","IValidatable"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],InitialBatchGate:[function(e,t,o){"use strict";cc._RF.push(t,"3a640fnMUpFI7/j8CU9yM9i","InitialBatchGate"),Object.defineProperty(o,"__esModule",{value:!0}),o.InitialBatchGate=void 0;var n=function(){function e(e){this.start=e,this._started=!1,this._loaded=!1,this._initialBatch=null}return Object.defineProperty(e.prototype,"started",{get:function(){return this._started},enumerable:!1,configurable:!0}),e.prototype.proceed=function(){this._loaded=!0,this.tryStart()},e.prototype.register=function(e){this._started||this._initialBatch||(this._initialBatch=e,this.tryStart())},e.prototype.tryStart=function(){this._started||this._loaded&&this._initialBatch&&(this.start(this._initialBatch),this._started=!0,this._initialBatch=null)},e}();o.InitialBatchGate=n,cc._RF.pop()},{}],InputController:[function(e,t,o){"use strict";cc._RF.push(t,"29411PwUChCmK6p3jmyM11G","InputController");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.InputController=void 0;var i,r=e("../../../domain/state/models/BoosterType"),s=e("../../../domain/state/models/GameStateType"),a=e("../../../presentation/board/events/BoosterClicked"),c=e("../../../presentation/board/events/VisualTileClicked"),u=e("../../common/controllers/BaseController"),l=e("../intents/BombEmplaceIntent"),p=e("../intents/BoosterSelected"),d=e("../intents/NormalIntent"),h=e("../intents/SwapIntent"),f=e("../intents/SwapSelected");(function(e){e[e.NORMAL=0]="NORMAL",e[e.SWAP_FIRST=1]="SWAP_FIRST",e[e.SWAP_SECOND=2]="SWAP_SECOND",e[e.BOMB=3]="BOMB"})(i||(i={}));var _=function(e){function t(t,o,n){var s,a=e.call(this,t)||this;return a._mode=i.NORMAL,a._activeBooster=r.BoosterType.NONE,a._firstTile=null,a._tileHandlers=((s={})[i.NORMAL]=function(e){a.emit(new d.NormalIntent(e))},s[i.SWAP_FIRST]=function(e){a._firstTile=e,a._mode=i.SWAP_SECOND,a.emit(new f.SwapSelected(e,!0))},s[i.SWAP_SECOND]=function(e){a._firstTile&&e!==a._firstTile?(a.emit(new f.SwapSelected(e,!0)),a.emit(new h.SwapIntent(a._firstTile,e)),a.reset()):a.reset()},s[i.BOMB]=function(e){a.emit(new l.BombEmplaceIntent(e)),a.reset()},s),a.onBoosterClicked=function(e){if(a.clickAllowed)if(a._activeBooster!==e.type&&0!==a._stateModel.getBooster(e.type)){switch(a.reset(),e.type){case r.BoosterType.SWAP:a._mode=i.SWAP_FIRST;break;case r.BoosterType.BOMB:a._mode=i.BOMB;break;default:return}a._activeBooster=e.type,a.emit(new p.BoosterSelected(e.type))}else a.reset()},a.onTileClicked=function(e){a.clickAllowed()&&null!==e.id&&(a._interactivityModel.lockedTile(e.id)||a._tileHandlers[a._mode](e.id))},a._interactivityModel=n,a._stateModel=o.stateModel,a}return n(t,e),t.prototype.onInit=function(){this.on(c.VisualTileClicked,this.onTileClicked),this.on(a.BoosterClicked,this.onBoosterClicked)},t.prototype.reset=function(){null!==this._firstTile&&this.emit(new f.SwapSelected(this._firstTile,!1)),this._firstTile=null,this._mode=i.NORMAL,this._activeBooster=r.BoosterType.NONE,this.emit(new p.BoosterSelected(r.BoosterType.NONE))},t.prototype.clickAllowed=function(){return this._stateModel.state===s.GameStateType.PLAYING&&!this._interactivityModel.lockedBoard()},t}(u.EventController);o.InputController=_,cc._RF.pop()},{"../../../domain/state/models/BoosterType":"BoosterType","../../../domain/state/models/GameStateType":"GameStateType","../../../presentation/board/events/BoosterClicked":"BoosterClicked","../../../presentation/board/events/VisualTileClicked":"VisualTileClicked","../../common/controllers/BaseController":"BaseController","../intents/BombEmplaceIntent":"BombEmplaceIntent","../intents/BoosterSelected":"BoosterSelected","../intents/NormalIntent":"NormalIntent","../intents/SwapIntent":"SwapIntent","../intents/SwapSelected":"SwapSelected"}],InputMode:[function(e,t,o){"use strict";cc._RF.push(t,"dcff2Iw+cRIF6kow4kX8X4X","InputMode"),Object.defineProperty(o,"__esModule",{value:!0}),o.InputMode=void 0,function(e){e[e.NORMAL=0]="NORMAL",e[e.SWAP_FIRST=1]="SWAP_FIRST",e[e.SWAP_SECOND=2]="SWAP_SECOND",e[e.BOMB_SELECT=3]="BOMB_SELECT"}(o.InputMode||(o.InputMode={})),cc._RF.pop()},{}],JsonConfigProvider:[function(e,t,o){"use strict";cc._RF.push(t,"f53f10PjOVPJaepW1ma/Plz","JsonConfigProvider");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.JsonConfigProvider=void 0;var s=function(e){function t(t,o){var n=e.call(this)||this;return n._path=t,n._validator=o,n}return n(t,e),t.prototype.load=function(){return i(this,void 0,Promise,function(){var e;return r(this,function(t){switch(t.label){case 0:return[4,this.loadJsonAsset(this._path)];case 1:return e=t.sent(),this.config=this._validator.validate(e.json),[2]}})})},t.prototype.loadJsonAsset=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.JsonAsset,function(n,i){n||!i?o(new Error("[JsonGameConfigProvider] Failed to load: "+e+"\n"+n)):t(i)})})},t}(e("./BaseConfigProvider").BaseConfigProvider);o.JsonConfigProvider=s,cc._RF.pop()},{"./BaseConfigProvider":"BaseConfigProvider"}],LoadingScreenContext:[function(e,t,o){"use strict";cc._RF.push(t,"1dc16OUG8VPJbUSGv2p7UVO","LoadingScreenContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingScreenContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.tweenSystem=t.tweenSystem,o}return n(t,e),t}(e("../../common/context/EventViewContext").EventViewContext);o.LoadingScreenContext=i,cc._RF.pop()},{"../../common/context/EventViewContext":"EventViewContext"}],LoadingScreen:[function(e,t,o){"use strict";cc._RF.push(t,"8eae532yq1D6LNGk23cWIws","LoadingScreen");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.LoadingScreen=void 0;var r=e("../../board/events/GameLoaded"),s=e("../../board/events/PresentationReady"),a=e("../../common/animations/TweenSettings"),c=e("../../common/view/EventView"),u=e("../context/LoadingScreenContext"),l=cc._decorator,p=l.ccclass,d=l.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.screenDelay=5,t.screenFadeOutDuration=.2,t.dots=[],t.dotsFadeInDuration=.5,t.dotsBetweenDelay=.15,t.dotsFadeOutDuration=.3,t.dotPauseBetweenLoops=.2,t.onPresentationReady=function(){t.fadeScreen()},t}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new u.LoadingScreenContext(e)}},t.prototype.onInit=function(){this.node.active=!0,this.node.opacity=255,this.resetDots(),this.startAnimation(),this.on(s.PresentationReady,this.onPresentationReady)},t.prototype.resetDots=function(){for(var e=0,t=this.dots;e<t.length;e++){t[e].opacity=0}},t.prototype.startAnimation=function(){var e=this;this._tween=cc.tween();for(var t=function(t){var n=o.dots[t];o._tween.delay(o.dotsBetweenDelay),o._tween.call(function(){return e.fadeDot(n)})},o=this,n=0;n<this.dots.length;n++)t(n);this._tween.delay(this.dotPauseBetweenLoops),this._tween=cc.tween(this.node).repeatForever(this._tween).start(),this.context.tweenSystem.track(this._tween)},t.prototype.fadeDot=function(e){this.context.tweenSystem.track(cc.tween(e).set({opacity:0}).to(this.dotsFadeInDuration,{opacity:255}).to(this.dotsFadeOutDuration,{opacity:0}).start())},t.prototype.fadeScreen=function(){var e=this;this.context.tweenSystem.build(a.TweenSettings.fade(this.node,this.screenDelay,this.screenFadeOutDuration,0)).call(function(){e._tween=null,e.emit(new r.GameLoaded)}).start()},i([d],t.prototype,"screenDelay",void 0),i([d],t.prototype,"screenFadeOutDuration",void 0),i([d([cc.Node])],t.prototype,"dots",void 0),i([d],t.prototype,"dotsFadeInDuration",void 0),i([d],t.prototype,"dotsBetweenDelay",void 0),i([d],t.prototype,"dotsFadeOutDuration",void 0),i([d],t.prototype,"dotPauseBetweenLoops",void 0),t=i([p],t)}(c.EventView);o.LoadingScreen=h,cc._RF.pop()},{"../../board/events/GameLoaded":"GameLoaded","../../board/events/PresentationReady":"PresentationReady","../../common/animations/TweenSettings":"TweenSettings","../../common/view/EventView":"EventView","../context/LoadingScreenContext":"LoadingScreenContext"}],Matrix:[function(e,t,o){"use strict";cc._RF.push(t,"320baWGsBZEno88utR9Y4nE","Matrix"),Object.defineProperty(o,"__esModule",{value:!0}),o.Matrix=void 0;var n=function(){function e(e,t,o){this._width=e,this._height=t,this._data=new Array(t);for(var n=0;n<t;n++){for(var i=new Array(e),r=0;r<e;r++)i[r]=o(r,n);this._data[n]=i}}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.get=function(e,t){return this._data[t][e]},e.prototype.set=function(e,t,o){this._data[t][e]=o},e.prototype.swap=function(e,t,o,n){var i=this._data[t][e];this._data[t][e]=this._data[n][o],this._data[n][o]=i},e.prototype.forEach=function(e){for(var t=0;t<this._height;t++)for(var o=0;o<this._width;o++)e(this._data[t][o],o,t)},e}();o.Matrix=n,cc._RF.pop()},{}],MoveMutation:[function(e,t,o){"use strict";cc._RF.push(t,"c748dEbGxhGwqihrghOVN1Z","MoveMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],MoveService:[function(e,t,o){"use strict";cc._RF.push(t,"180c6G6rN9G/Iwx7rb1B39H","MoveService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.MoveService=void 0;var i=e("../events/mutations/TileMutationHelper"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.move=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t],i=this.logicModel.get(n.from.x,n.from.y);i&&(this.logicModel.move(n.from,n.to),this.positionRepo.move(i,n.to))}},t.prototype.swap=function(e,t){var o=[],n=this.positionRepo.get(e),r=this.positionRepo.get(t);if(n&&r){this.positionRepo.move(e,r),this.positionRepo.move(t,n),this.logicModel.swap(n,r);var s=i.TileMutationHelper.moved(e,n,r,"swap"),a=i.TileMutationHelper.moved(t,r,n,"swap");o.push(s,a)}return o},t.prototype.drop=function(){for(var e=[],t=this.logicModel.width-1;t>=0;t--)for(var o=0,n=this.logicModel.height-1;n>=0;n--)if(this.logicModel.empty(t,n))o++;else if(o>0){var r=this.logicModel.get(t,n);if(!r)continue;var s={x:t,y:n+o},a=i.TileMutationHelper.moved(r,{x:t,y:n},s,"drop");e.push(a)}return this.move(e),e},t}(e("./BoardService").BoardService);o.MoveService=r,cc._RF.pop()},{"../events/mutations/TileMutationHelper":"TileMutationHelper","./BoardService":"BoardService"}],MovesTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"edbdcH0xDlCDLhdQ15+puc6","MovesTextViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.MovesTextViewContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.setInitial(o.presentation.movesLeft),o}return n(t,e),t}(e("../../common/context/DynamicTextViewContext").DynamicTextViewContext);o.MovesTextViewContext=i,cc._RF.pop()},{"../../common/context/DynamicTextViewContext":"DynamicTextViewContext"}],MovesTextView:[function(e,t,o){"use strict";cc._RF.push(t,"d8aafGKJJ1BEZQfGSesrZxi","MovesTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.MovesTextView=void 0;var r=e("../../../application/state/events/MovesUpdate"),s=e("../../common/view/DynamicTextView"),a=e("../context/MovesTextViewContext"),c=cc._decorator.ccclass,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new a.MovesTextViewContext(e)}},t.prototype.eventType=function(){return r.MovesUpdate},t.prototype.format=function(e){return e.toString()},t=i([c],t)}(s.DynamicTextView);o.MovesTextView=u,cc._RF.pop()},{"../../../application/state/events/MovesUpdate":"MovesUpdate","../../common/view/DynamicTextView":"DynamicTextView","../context/MovesTextViewContext":"MovesTextViewContext"}],MovesUpdate:[function(e,t,o){"use strict";cc._RF.push(t,"f20c8i/AGdNGrvGH7yFGpYF","MovesUpdate");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.MovesUpdate=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("../../../../core/eventbus/ValueChangedEvent").ValueChangedEvent);o.MovesUpdate=i,cc._RF.pop()},{"../../../../core/eventbus/ValueChangedEvent":"ValueChangedEvent"}],NodePool:[function(e,t,o){"use strict";cc._RF.push(t,"79821SOFVZE2KP+FuCglcR7","NodePool");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.NodePool=void 0;var i=function(e){function t(t,o,n){var i=e.call(this)||this;i._prefab=t,i._parent=o;for(var r=0;r<n;r++){var s=i.create();s.active=!1,i._pool[r]=s}return i}return n(t,e),t.prototype.dispose=function(){this._pool.forEach(function(e){return e.destroy()}),this._pool=[]},t.prototype.pull=function(){var e=this._pool.pop();return e&&cc.isValid(e)||(e=this.create()),e.setParent(this._parent),e},t.prototype.release=function(e){e&&(cc.Tween.stopAllByTarget(e),e.active=!1,e.removeFromParent(),this._pool.push(e))},t.prototype.create=function(){var e=cc.instantiate(this._prefab);return e.setPosition(0,0),e.setScale(1,1),e.angle=0,e.opacity=255,e.active=!1,e},t}(e("./BasePool").BasePool);o.NodePool=i,cc._RF.pop()},{"./BasePool":"BasePool"}],NormalIntentComplete:[function(e,t,o){"use strict";cc._RF.push(t,"af6c5H8KkdCg7fgoFHI9oqw","NormalIntentComplete"),Object.defineProperty(o,"__esModule",{value:!0}),o.NormalIntentComplete=void 0;var n=function(){return function(e,t){this.clusterDestroys=e,this.collateralDestroys=t}}();o.NormalIntentComplete=n,cc._RF.pop()},{}],NormalIntent:[function(e,t,o){"use strict";cc._RF.push(t,"4d5a9vukmlPZ79M+S4sAe9V","NormalIntent"),Object.defineProperty(o,"__esModule",{value:!0}),o.NormalIntent=void 0;var n=function(){return function(e){this.id=e}}();o.NormalIntent=n,cc._RF.pop()},{}],NormalStrategy:[function(e,t,o){"use strict";cc._RF.push(t,"4a769kFTmNMmqsywhqgPkMQ","NormalStrategy");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.NormalStrategy=void 0;var i=e("../../../../domain/board/events/BoardMutationsBatch"),r=e("../../../../domain/board/events/mutations/TileMutationHelper"),s=e("../../../../domain/board/models/TileType"),a=e("./BaseBoardStrategy"),c=e("./SpecialResolver"),u=function(e){function t(t,o,n,i,r,s,a){var c=e.call(this,o,s,a)||this;return c._boardInfo=t,c._searchService=n,c._destroyService=i,c._transformService=r,c}return n(t,e),t.prototype.execute=function(e){var t=new i.BoardMutationsBatch,o=this._searchService.findCluster(e,this.interactivityModel);if(!o||o.length<this._boardInfo.clusterSize)return this.interactivityModel.addUnstable(e),t.push(r.TileMutationHelper.shaked(e)),t;for(var n=new c.SpecialResolver,a=s.TileType.EMPTY,u=0,l=this._boardInfo.specials;u<l.length;u++){var p=l[u];if(o.length>=p.amount){a=n.resolve(p.type);break}}return a!==s.TileType.EMPTY?this.transform(t,e,o,a):this.destroy(t,e,o),this.drop(t),this.spawn(t),t},t.prototype.transform=function(e,t,o,n){var i=this,r=this._transformService.tryTransform(t,o,n);null!==r&&(e.push(r),r.transformed.forEach(function(e){i._destroyService.tryDestroyTile(e)&&(i.destabilize(e),i.block(e))}),this.destabilize(t),this.block(t))},t.prototype.destroy=function(e,t,o){var n=this,i=this._destroyService.destroyNormalCluster(o,t,"match");null!==i&&(e.push(i),o.forEach(function(e){return n.destabilize(e)}))},t}(a.BaseBoardStrategy);o.NormalStrategy=u,cc._RF.pop()},{"../../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","../../../../domain/board/events/mutations/TileMutationHelper":"TileMutationHelper","../../../../domain/board/models/TileType":"TileType","./BaseBoardStrategy":"BaseBoardStrategy","./SpecialResolver":"SpecialResolver"}],PresentationGraph:[function(e,t,o){"use strict";cc._RF.push(t,"b00e7lZWJ1AmJODY9VBFYxz","PresentationGraph"),Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationGraph=void 0;var n=e("./common/animations/tweens/TweenSystem"),i=function(){return function(e,t,o,i){this.visualConfig=t,this.eventBus=e,this.tweenSystem=new n.TweenSystem,this.movesLeft=i.stateModel.movesLeft,this.targetScore=i.stateModel.targetScore,this.currentScore=i.stateModel.currentScore,this.boardCols=o.board.cols,this.boardRows=o.board.rows,this.boosters=o.gameState.boosters}}();o.PresentationGraph=i,cc._RF.pop()},{"./common/animations/tweens/TweenSystem":"TweenSystem"}],PresentationInstaller:[function(e,t,o){"use strict";cc._RF.push(t,"749e11emX9Nl6hA3CVBKdmW","PresentationInstaller");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationInstaller=void 0;var r=e("./board/events/PresentationReady"),s=e("./common/view/BaseView"),a=e("./common/view/PresentationView"),c=cc._decorator.ccclass,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.prepare=function(e){this._presentation=e},t.prototype.init=function(){this._views=this.node.getComponentsInChildren(a.PresentationView);for(var e=0,t=this._views;e<t.length;e++){var o=t[e],n=o.contextFactory()(this._presentation);o.init(n)}this._presentation.eventBus.emit(new r.PresentationReady)},t.prototype.dispose=function(){this._presentation.tweenSystem.dispose(),this._views.forEach(function(e){return e.dispose()}),this._views=[]},t=i([c],t)}(s.BaseView);o.PresentationInstaller=u,cc._RF.pop()},{"./board/events/PresentationReady":"PresentationReady","./common/view/BaseView":"BaseView","./common/view/PresentationView":"PresentationView"}],PresentationReady:[function(e,t,o){"use strict";cc._RF.push(t,"4016b5BZYJKQ4tAffi0vSpn","PresentationReady"),Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationReady=void 0;var n=function(){return function(){}}();o.PresentationReady=n,cc._RF.pop()},{}],PresentationViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"1bd3aCzf0lCNKJsSMxSjFYb","PresentationViewContext"),Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationViewContext=void 0;var n=function(){return function(e){this.presentation=e}}();o.PresentationViewContext=n,cc._RF.pop()},{}],PresentationView:[function(e,t,o){"use strict";cc._RF.push(t,"73a291rN4xDypg1nxgLXNpC","PresentationView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.PresentationView=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("./ContextView").ContextView);o.PresentationView=i,cc._RF.pop()},{"./ContextView":"ContextView"}],PulseSettings:[function(e,t,o){"use strict";cc._RF.push(t,"e1d02YJ/J5DD6cey4kitaix","PulseSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],PulseTween:[function(e,t,o){"use strict";cc._RF.push(t,"02210k1e4JHTKgXmPFXW2dT","PulseTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.PulseTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.PULSE}return e.prototype.build=function(e){return cc.tween(e.node).to(e.durationIn,{scale:e.node.scale*e.scaleIn}).to(e.durationOut,{scale:e.node.scale*e.scaleOut})},e}();o.PulseTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],RocketAssets:[function(e,t,o){"use strict";cc._RF.push(t,"62b4eGW8dpO2K3qvg+ek1Qb","RocketAssets");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.RocketAssets=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../../core/utils/ensure"),a=e("../../../domain/board/models/TileType"),c=e("../../fx/RocketType"),u=cc._decorator,l=u.ccclass,p=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rocket=null,t.left=null,t.right=null,t.up=null,t.down=null,t}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.validate=function(){this._rockets=new Map([[c.RocketDirection.LEFT,s.ensureNotNull(this.left,this,"LEFT")],[c.RocketDirection.RIGHT,s.ensureNotNull(this.right,this,"RIGHT")],[c.RocketDirection.UP,s.ensureNotNull(this.up,this,"UP")],[c.RocketDirection.DOWN,s.ensureNotNull(this.down,this,"DOWN")]])},t.prototype.getPrefab=function(){return this.rocket},t.prototype.getSprite=function(e){var t=this._rockets.get(e);return r.assertNotNull(t,this,"Sprite for type "+a.TileType[e]),t},i([p(cc.Prefab)],t.prototype,"rocket",void 0),i([p(cc.SpriteFrame)],t.prototype,"left",void 0),i([p(cc.SpriteFrame)],t.prototype,"right",void 0),i([p(cc.SpriteFrame)],t.prototype,"up",void 0),i([p(cc.SpriteFrame)],t.prototype,"down",void 0),t=i([l],t)}(cc.Component);o.RocketAssets=d,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/ensure":"ensure","../../../domain/board/models/TileType":"TileType","../../fx/RocketType":"RocketType"}],RocketCrossed:[function(e,t,o){"use strict";cc._RF.push(t,"0b780d1KcFLpaw7e69BaS//","RocketCrossed"),Object.defineProperty(o,"__esModule",{value:!0}),o.RocketCrossed=void 0;var n=function(){return function(e){this.position=e}}();o.RocketCrossed=n,cc._RF.pop()},{}],RocketFxHolder:[function(e,t,o){"use strict";cc._RF.push(t,"a7de3GC9ytFN6CQSEGc7Tyd","RocketFxHolder"),Object.defineProperty(o,"__esModule",{value:!0}),o.RocketFxHolder=void 0;var n=e("../../common/view/NodePool"),i=e("../../utils/calc"),r=e("../events/RocketOutOfBounds"),s=e("./RocketView"),a=function(){function e(e,t,o,i,s,a,c,u){var l=this;this.onRocketOutOfBound=function(e){l._rocketPool.release(e.node)},this._eventBus=e,this._rocketInfo=t,this._rockets=o,this._boardCols=s,this._boardRows=a,this._nodeWidth=c,this._nodeHeight=u,this._rocketPool=new n.NodePool(o.getPrefab(),i,this._boardCols*this._boardRows),this._eventBus.on(r.RocketOutOfBounds,this.onRocketOutOfBound)}return e.prototype.dispose=function(){this._rocketPool.dispose(),this._eventBus.off(r.RocketOutOfBounds,this.onRocketOutOfBound)},e.prototype.play=function(e,t){var o=this._rocketPool.pull().getComponent(s.RocketView);o.init(this._rockets),o.set(t),o.show();var n=i.getLocal(e,this._boardCols,this._boardRows,this._nodeWidth,this._nodeHeight);o.node.setPosition(n.clone()),o.rocket.play(this._eventBus,t,e,this._boardCols,this._boardRows,this._nodeWidth,this._nodeHeight,this._rocketInfo)},e}();o.RocketFxHolder=a,cc._RF.pop()},{"../../common/view/NodePool":"NodePool","../../utils/calc":"calc","../events/RocketOutOfBounds":"RocketOutOfBounds","./RocketView":"RocketView"}],RocketMotion:[function(e,t,o){"use strict";cc._RF.push(t,"98727VUjlpPHJpWqkdfFB0A","RocketMotion");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.RocketMotion=void 0;var r=e("../board/events/RocketCrossed"),s=e("../board/events/RocketOutOfBounds"),a=e("../utils/calc"),c=e("./RocketType"),u=cc._decorator.ccclass,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._eventBus=null,t._direction=cc.Vec2.ZERO,t._boardCols=0,t._boardRows=0,t._nodeWidth=0,t._nodeHeight=0,t._speed=0,t._running=!1,t}return n(t,e),t.prototype.play=function(e,t,o,n,i,r,s,a){this._eventBus=e,this._direction=this.direction(t),this._lastLogical=o,this._boardCols=n,this._boardRows=i,this._nodeWidth=r,this._nodeHeight=s,this._speed=a.speed,this._running=!0,this._logicalDir=t},t.prototype.update=function(e){var t,o;if(this._running){var n=cc.v3(this._direction.mul(this._speed*e));this.node.setPosition(this.node.position.add(n));var i=a.getLogical(cc.v2(this.node.position),this._boardCols,this._boardRows,this._nodeWidth,this._nodeHeight);a.logicalEquals(i,this._lastLogical)||(this._lastLogical=i,null===(t=this._eventBus)||void 0===t||t.emit(new r.RocketCrossed(i)),a.outOfBounds(i,this._boardCols,this._boardRows)&&(null===(o=this._eventBus)||void 0===o||o.emit(new s.RocketOutOfBounds(this.node)),this._running=!1))}},t.prototype.direction=function(e){switch(e){case c.RocketDirection.LEFT:return cc.v2(-1,0);case c.RocketDirection.RIGHT:return cc.v2(1,0);case c.RocketDirection.UP:return cc.v2(0,1);case c.RocketDirection.DOWN:return cc.v2(0,-1)}},t=i([u],t)}(cc.Component);o.RocketMotion=l,cc._RF.pop()},{"../board/events/RocketCrossed":"RocketCrossed","../board/events/RocketOutOfBounds":"RocketOutOfBounds","../utils/calc":"calc","./RocketType":"RocketType"}],RocketOutOfBounds:[function(e,t,o){"use strict";cc._RF.push(t,"d8820jDibtMnbwZ0JGUFR3n","RocketOutOfBounds"),Object.defineProperty(o,"__esModule",{value:!0}),o.RocketOutOfBounds=void 0;var n=function(){return function(e){this.node=e}}();o.RocketOutOfBounds=n,cc._RF.pop()},{}],RocketStrategy:[function(e,t,o){"use strict";cc._RF.push(t,"b5b7f2sOPpPzb+N2IMSMga1","RocketStrategy");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.RocketStrategy=void 0;var i=e("../../../../domain/board/events/BoardMutationsBatch"),r=e("../../../../domain/board/models/TileType"),s=function(e){function t(t,o,n,i,r){var s=e.call(this,o,i,r)||this;return s._type=t,s._destroyService=n,s}return n(t,e),t.prototype.execute=function(e){var t=this,o=new i.BoardMutationsBatch,n=null;switch(this._type){case r.TileType.HORIZONTAL_ROCKET:n=this._destroyService.destroyInRow(e,"horizontal_rocket");break;case r.TileType.VERTICAL_ROCKET:n=this._destroyService.destroyInCol(e,"vertical_rocket")}return null===n?o:(o.push(n),n.destroyed.forEach(function(e){t.block(e),t.destabilize(e)}),this.drop(o),this.spawn(o),o)},t}(e("./BaseBoardStrategy").BaseBoardStrategy);o.RocketStrategy=s,cc._RF.pop()},{"../../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","../../../../domain/board/models/TileType":"TileType","./BaseBoardStrategy":"BaseBoardStrategy"}],RocketType:[function(e,t,o){"use strict";cc._RF.push(t,"b2ebdTYtBBJbJkP7XJx6ndP","RocketType"),Object.defineProperty(o,"__esModule",{value:!0}),o.RocketDirection=void 0,function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"}(o.RocketDirection||(o.RocketDirection={})),cc._RF.pop()},{}],RocketView:[function(e,t,o){"use strict";cc._RF.push(t,"e15f0uULvFI5rXnmXKl9lA+","RocketView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.RocketView=void 0;var r=e("../../../../core/utils/assert"),s=e("../../common/view/BaseView"),a=e("../../fx/RocketMotion"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainSprite=null,t.rocket=null,t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),r.assertNotNull(this.mainSprite,this,"Sprite"),r.assertNotNull(this.rocket,this,"RocketMotion")},t.prototype.init=function(e){this._rockets=e},t.prototype.show=function(){this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.set=function(e){this.mainSprite.spriteFrame=this._rockets.getSprite(e)},i([l(cc.Sprite)],t.prototype,"mainSprite",void 0),i([l(a.RocketMotion)],t.prototype,"rocket",void 0),t=i([u],t)}(s.BaseView);o.RocketView=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../common/view/BaseView":"BaseView","../../fx/RocketMotion":"RocketMotion"}],SafeDropMap:[function(e,t,o){"use strict";cc._RF.push(t,"c37022szChNwLd+74Hk4RN5","SafeDropMap"),Object.defineProperty(o,"__esModule",{value:!0}),o.SafeDropMap=void 0;var n=function(){function e(){this._map=new Map}return e.prototype.add=function(e,t){var o,n=null!==(o=this._map.get(e))&&void 0!==o?o:new Set;n.add(t),this._map.set(e,n)},e.prototype.subtract=function(e){this._map.forEach(function(t,o){t.has(e)&&t.delete(e)})},e.prototype.get=function(e){var t=this._map.get(e);return t?t.size:0},e.prototype.reset=function(){this._map.clear()},e.prototype.forEach=function(e){this._map.forEach(function(t,o,n){return e(t,o)})},e}();o.SafeDropMap=n,cc._RF.pop()},{}],ScoreService:[function(e,t,o){"use strict";cc._RF.push(t,"ed1f8pLuO9IALBgNsqVtvjL","ScoreService"),Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreService=void 0;var n=function(){function e(e){this._scoreMultiplier=e}return e.prototype.calculateCluster=function(e){return e*e*this._scoreMultiplier},e.prototype.calculateCollateral=function(e){return e*this._scoreMultiplier*this._scoreMultiplier},e}();o.ScoreService=n,cc._RF.pop()},{}],ScoreTextViewContext:[function(e,t,o){"use strict";cc._RF.push(t,"7af9aTEbmRII6sX9caFBjRn","ScoreTextViewContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreTextViewContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.targetScore=t.targetScore,o.setInitial(o.presentation.currentScore),o}return n(t,e),t}(e("../../common/context/DynamicTextViewContext").DynamicTextViewContext);o.ScoreTextViewContext=i,cc._RF.pop()},{"../../common/context/DynamicTextViewContext":"DynamicTextViewContext"}],ScoreTextView:[function(e,t,o){"use strict";cc._RF.push(t,"7bd0f5hs8VARYsgFprc1Aea","ScoreTextView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreTextView=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../application/state/events/ScoreUpdate"),a=e("../../common/view/DynamicTextView"),c=e("../context/ScoreTextViewContext"),u=cc._decorator.ccclass,l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new c.ScoreTextViewContext(e)}},t.prototype.eventType=function(){return s.ScoreUpdate},t.prototype.preInit=function(){e.prototype.preInit.call(this),r.assertNumber(this.context.targetScore,this,"initialValue")},t.prototype.format=function(e){return e+"/"+this.context.targetScore},t=i([u],t)}(a.DynamicTextView);o.ScoreTextView=l,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../application/state/events/ScoreUpdate":"ScoreUpdate","../../common/view/DynamicTextView":"DynamicTextView","../context/ScoreTextViewContext":"ScoreTextViewContext"}],ScoreUpdate:[function(e,t,o){"use strict";cc._RF.push(t,"3e8dfpLtNhJHZcLU8Cfc54R","ScoreUpdate");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreUpdate=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("../../../../core/eventbus/ValueChangedEvent").ValueChangedEvent);o.ScoreUpdate=i,cc._RF.pop()},{"../../../../core/eventbus/ValueChangedEvent":"ValueChangedEvent"}],ScreenFadeContext:[function(e,t,o){"use strict";cc._RF.push(t,"58c2cXsmpBJkYC/qp+muhhw","ScreenFadeContext");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.ScreenFadeContext=void 0;var i=function(e){function t(t){var o=e.call(this,t)||this;return o.tweenSystem=t.tweenSystem,o}return n(t,e),t}(e("../../common/view/PresentationViewContext").PresentationViewContext);o.ScreenFadeContext=i,cc._RF.pop()},{"../../common/view/PresentationViewContext":"PresentationViewContext"}],ScreenFade:[function(e,t,o){"use strict";cc._RF.push(t,"4830fiy4tdETKoUvZ0kXBD2","ScreenFade");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ScreenFade=void 0;var r=e("../../common/animations/TweenSettings"),s=e("../../common/view/PresentationView"),a=e("../context/ScreenFadeContext"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetOpacity=140,t}return n(t,e),t.prototype.contextFactory=function(){return function(e){return new a.ScreenFadeContext(e)}},t.prototype.onInit=function(){this.node.active=!1},t.prototype.fadeIn=function(){this.node.opacity=0,this.node.active=!0,this.context.tweenSystem.build(r.TweenSettings.fade(this.node,0,.25,this.targetOpacity)).start()},t.prototype.fadeOut=function(){var e=this;this.context.tweenSystem.build(r.TweenSettings.fade(this.node,0,.1,0)).call(function(){return e.node.active=!1}).start()},i([l],t.prototype,"targetOpacity",void 0),t=i([u],t)}(s.PresentationView);o.ScreenFade=p,cc._RF.pop()},{"../../common/animations/TweenSettings":"TweenSettings","../../common/view/PresentationView":"PresentationView","../context/ScreenFadeContext":"ScreenFadeContext"}],SearchService:[function(e,t,o){"use strict";cc._RF.push(t,"146bchEKatLLLIq9vBSpvaC","SearchService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.SearchService=void 0;var i=e("../../../../core/collections/Matrix"),r=e("../models/TileType"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.findCluster=function(e,t){var o=this.typeRepo.get(e),n=this.positionRepo.get(e);if(null===o||null===n)return[];for(var s=[],a=new i.Matrix(this.logicModel.width,this.logicModel.height,function(){return!1}),c=[n];c.length>0&&o!==r.TileType.EMPTY;){var u=c.pop();if(u&&!a.get(u.x,u.y)){a.set(u.x,u.y,!0);var l=this.logicModel.get(u.x,u.y);l&&(t.lockedTile(l)||this.typeRepo.get(l)!==o||(s.push(l),c.push.apply(c,this.findNeighbors(u))))}}return s},t.prototype.findNeighbors=function(e){for(var t=[],o=0,n=[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}];o<n.length;o++){var i=n[o];i.x<0||i.y<0||i.x>=this.logicModel.width||i.y>=this.logicModel.height||t.push(i)}return t},t}(e("./BoardService").BoardService);o.SearchService=s,cc._RF.pop()},{"../../../../core/collections/Matrix":"Matrix","../models/TileType":"TileType","./BoardService":"BoardService"}],ShakeMutation:[function(e,t,o){"use strict";cc._RF.push(t,"9e1c5iEi/ZGgolZH+swQlhn","ShakeMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ShakeSettings:[function(e,t,o){"use strict";cc._RF.push(t,"e713e/x+YVACa7ott/cyQ50","ShakeSettings"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ShakeTween:[function(e,t,o){"use strict";cc._RF.push(t,"82609dFDHRKJZdRjD/ogRNx","ShakeTween"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShakeTween=void 0;var n=e("./TweenType"),i=function(){function e(){this.type=n.TweenType.SHAKE}return e.prototype.build=function(e){var t=e.node.angle;return cc.tween(e.node).to(e.duration,{angle:t+e.amplitude}).to(2*e.duration,{angle:t-e.amplitude}).to(2*e.duration,{angle:t+e.amplitude}).to(e.duration,{angle:t})},e}();o.ShakeTween=i,cc._RF.pop()},{"./TweenType":"TweenType"}],ShardAssets:[function(e,t,o){"use strict";cc._RF.push(t,"d807c/ZvdlLxIOeuPL7Pjdl","ShardAssets");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ShardAssets=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../../core/utils/random"),a=e("./ColorRecord"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefab=null,t.sprites=[],t.colorRecords=[],t.colorMap=new Map,t}return n(t,e),t.prototype.onLoad=function(){for(var e=0,t=this.colorRecords;e<t.length;e++){var o=t[e];this.colorMap.set(o.type,o.color)}},t.prototype.getPrefab=function(){return this.prefab},t.prototype.getSprite=function(){return this.sprites[s.Random.intRange(0,this.sprites.length)]},t.prototype.getColor=function(e){var t=this.colorMap.get(e);return r.assertNotNull(t,this,"color"),t},i([l(cc.Prefab)],t.prototype,"prefab",void 0),i([l([cc.SpriteFrame])],t.prototype,"sprites",void 0),i([l([a.ColorRecord])],t.prototype,"colorRecords",void 0),t=i([u],t)}(cc.Component);o.ShardAssets=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/random":"random","./ColorRecord":"ColorRecord"}],ShardFaded:[function(e,t,o){"use strict";cc._RF.push(t,"4a353zA4utFgonYIdDrl4k0","ShardFaded"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShardFaded=void 0;var n=function(){return function(e){this.node=e}}();o.ShardFaded=n,cc._RF.pop()},{}],ShardView:[function(e,t,o){"use strict";cc._RF.push(t,"d7d2doF0utPpJ2y6Za7sCb9","ShardView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ShardView=void 0;var r=e("../../../../core/utils/assert"),s=e("../../common/view/BaseView"),a=e("../../fx/BurstMotion"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainSprite=null,t.burst=null,t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),r.assertNotNull(this.mainSprite,this,"Sprite"),r.assertNotNull(this.burst,this,"BurstMotion")},t.prototype.init=function(e){this._shards=e},t.prototype.show=function(){this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.set=function(e){this.node.color=this._shards.getColor(e),this.mainSprite.spriteFrame=this._shards.getSprite()},i([l(cc.Sprite)],t.prototype,"mainSprite",void 0),i([l(a.BurstMotion)],t.prototype,"burst",void 0),t=i([u],t)}(s.BaseView);o.ShardView=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../common/view/BaseView":"BaseView","../../fx/BurstMotion":"BurstMotion"}],SlingMotion:[function(e,t,o){"use strict";cc._RF.push(t,"5898dONlE9K35U3j3tqtx03","SlingMotion");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.SlingMotion=void 0;var r,s=cc._decorator.ccclass;(function(e){e[e.IDLE=0]="IDLE",e[e.PULL=1]="PULL",e[e.LAUNCH=2]="LAUNCH",e[e.SETTLE=3]="SETTLE",e[e.DONE=4]="DONE"})(r||(r={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._phase=r.IDLE,t._pullDuration=0,t._launchDuration=0,t._disappearDistance=0,t._phaseTime=0,t._running=!1,t._baseScale=1,t._onSlinged=null,t}return n(t,e),t.prototype.smooth=function(e){return e*e*(3-2*e)},t.prototype.cubicOut=function(e){return 1-Math.pow(1-e,3)},t.prototype.cubicInOut=function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},t.prototype.play=function(e,t,o){this._from=e.clone(),this._to=t.clone(),this._pullDuration=o.pullDuration,this._launchDuration=o.minLaunchDuration,this._disappearDistance=o.disappearDistance;var n=t.sub(e).normalize();this._pull=e.sub(n.mul(o.pullDistance)),this.node.setPosition(e),this._phase=r.PULL,this._phaseTime=0,this._running=!0},Object.defineProperty(t.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),t.prototype.onSlinged=function(e){this._onSlinged=e},t.prototype.update=function(e){var t;if(this._running)switch(this._phaseTime+=e,this._phase){case r.PULL:var o=Math.min(this._phaseTime/this._pullDuration,1),n=this.smooth(o),i=this._from.lerp(this._pull,n);this.node.setPosition(i),o>=1&&(this._phase=r.LAUNCH,this._phaseTime=0);break;case r.LAUNCH:o=Math.min(this._phaseTime/this._launchDuration,1),n=this.cubicInOut(o);var s=this._pull.lerp(this._to,n);this.node.setPosition(s);var a=this.node.position.sub(cc.v3(this._to)).mag();(o>=1||a<this._disappearDistance)&&(this._phase=r.SETTLE,this._phaseTime=0);break;case r.SETTLE:this.node.setPosition(this._to),this.node.scale=this._baseScale,this._phase=r.DONE,this._running=!1,null===(t=this._onSlinged)||void 0===t||t.call(this),this._onSlinged=null}},t=i([s],t)}(cc.Component);o.SlingMotion=a,cc._RF.pop()},{}],SpawnMutation:[function(e,t,o){"use strict";cc._RF.push(t,"5f2540CwEdKvqcTNte0CGK6","SpawnMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],SpawnService:[function(e,t,o){"use strict";cc._RF.push(t,"c0001pCwYVP95cvO6tOSR2c","SpawnService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.SpawnService=void 0;var i=e("./BoardService"),r=e("../events/mutations/TileMutationHelper"),s=function(e){function t(t,o,n,i,r){var s=e.call(this,t,o,n)||this;return s.factory=i,s.types=r,s}return n(t,e),t.prototype.spawn=function(){for(var e=[],t=0;t<this.logicModel.width;t++)for(var o=0;o<this.logicModel.height;o++){var n=this.logicModel.get(t,o);if(!n){var i={x:t,y:o},s=this.randomType();n=this.factory.create(),this.logicModel.register({x:t,y:o},n),this.typeRepo.register(n,s),this.positionRepo.move(n,i);var a=r.TileMutationHelper.spawned(n,i,s);e.push(a)}}return e},t.prototype.randomType=function(){return this.types[Math.floor(Math.random()*this.types.length)]},t}(i.BoardService);o.SpawnService=s,cc._RF.pop()},{"../events/mutations/TileMutationHelper":"TileMutationHelper","./BoardService":"BoardService"}],SpecialResolver:[function(e,t,o){"use strict";cc._RF.push(t,"7907f0pPFtOOL3czcjAy85g","SpecialResolver"),Object.defineProperty(o,"__esModule",{value:!0}),o.SpecialResolver=void 0;var n=e("../../../../config/game/ThresholdType"),i=e("../../../../domain/board/models/TileType"),r=function(){function e(){}return e.prototype.resolve=function(e){switch(e){case n.ThresholdType.ROCKET:return Math.random()<.5?i.TileType.HORIZONTAL_ROCKET:i.TileType.VERTICAL_ROCKET;case n.ThresholdType.BOMB:return i.TileType.BOMB;case n.ThresholdType.SUPER_BOMB:return i.TileType.SUPER_BOMB}},e}();o.SpecialResolver=r,cc._RF.pop()},{"../../../../config/game/ThresholdType":"ThresholdType","../../../../domain/board/models/TileType":"TileType"}],StateUpdate:[function(e,t,o){"use strict";cc._RF.push(t,"208665ba/5JK5m6vliEUHPH","StateUpdate");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.StateUpdate=void 0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(e("../../../../core/eventbus/ValueChangedEvent").ValueChangedEvent);o.StateUpdate=i,cc._RF.pop()},{"../../../../core/eventbus/ValueChangedEvent":"ValueChangedEvent"}],SubscriptionGroup:[function(e,t,o){"use strict";cc._RF.push(t,"18bfaE9+69Bu4GzKQB8eC60","SubscriptionGroup"),Object.defineProperty(o,"__esModule",{value:!0}),o.SubscriptionGroup=void 0;var n=function(){function e(){this._subscriptions=[]}return e.prototype.add=function(e){this._subscriptions.push(e)},e.prototype.clear=function(){for(var e=0,t=this._subscriptions;e<t.length;e++){t[e].unsubscribe()}this._subscriptions.length=0},e}();o.SubscriptionGroup=n,cc._RF.pop()},{}],Subscription:[function(e,t,o){"use strict";cc._RF.push(t,"e054aPiy9xJ/roTuUKhU0v3","Subscription"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],SuperBombStrategy:[function(e,t,o){"use strict";cc._RF.push(t,"2d090hlAxVGC4ac/xOvC3dG","SuperBombStrategy");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.SuperBombStrategy=void 0;var i=e("../../../../domain/board/events/BoardMutationsBatch"),r=function(e){function t(t,o,n,i){var r=e.call(this,t,n,i)||this;return r._destroyService=o,r}return n(t,e),t.prototype.execute=function(e){var t=this,o=new i.BoardMutationsBatch,n=this._destroyService.destroyAll(e,"superbomb");return null===n?o:(o.push(n),n.destroyed.forEach(function(e){return t.destabilize(e)}),this.drop(o),this.spawn(o),o)},t}(e("./BaseBoardStrategy").BaseBoardStrategy);o.SuperBombStrategy=r,cc._RF.pop()},{"../../../../domain/board/events/BoardMutationsBatch":"BoardMutationsBatch","./BaseBoardStrategy":"BaseBoardStrategy"}],SwapIntent:[function(e,t,o){"use strict";cc._RF.push(t,"f563f2lI9tPnosZori8vyhf","SwapIntent"),Object.defineProperty(o,"__esModule",{value:!0}),o.SwapIntent=void 0;var n=function(){return function(e,t){this.first=e,this.second=t}}();o.SwapIntent=n,cc._RF.pop()},{}],SwapSelected:[function(e,t,o){"use strict";cc._RF.push(t,"74cfawa2kRC/pLoLGe8O1gq","SwapSelected"),Object.defineProperty(o,"__esModule",{value:!0}),o.SwapSelected=void 0;var n=function(){return function(e,t){this.id=e,this.state=t}}();o.SwapSelected=n,cc._RF.pop()},{}],ThresholdType:[function(e,t,o){"use strict";cc._RF.push(t,"68b6dd/ydJIU75f/f/YTH8N","ThresholdType"),Object.defineProperty(o,"__esModule",{value:!0}),o.ThresholdType=void 0,function(e){e[e.ROCKET=0]="ROCKET",e[e.BOMB=1]="BOMB",e[e.SUPER_BOMB=2]="SUPER_BOMB"}(o.ThresholdType||(o.ThresholdType={})),cc._RF.pop()},{}],TileAssets:[function(e,t,o){"use strict";cc._RF.push(t,"4db3f6Nos5B9K7+VqraVTc/","TileAssets");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileAssets=void 0;var r=e("../../../../core/utils/assert"),s=e("../../../../core/utils/ensure"),a=e("../../../domain/board/models/TileType"),c=cc._decorator,u=c.ccclass,l=c.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tile=null,t.empty=null,t.red=null,t.green=null,t.blue=null,t.purple=null,t.yellow=null,t.bomb=null,t.horizontalRocket=null,t.verticalRocket=null,t.superBomb=null,t.normalHighlight=null,t.bombHighlight=null,t.horizontalRocketHighlight=null,t.verticalRocketHighlight=null,t.superBombHighlight=null,t}return n(t,e),t.prototype.onLoad=function(){this.validate()},t.prototype.validate=function(){this._mainSprites=new Map([[a.TileType.EMPTY,s.ensureNotNull(this.empty,this,"EMPTY")],[a.TileType.RED,s.ensureNotNull(this.red,this,"RED")],[a.TileType.GREEN,s.ensureNotNull(this.green,this,"GREEN")],[a.TileType.BLUE,s.ensureNotNull(this.blue,this,"BLUE")],[a.TileType.PURPLE,s.ensureNotNull(this.purple,this,"PURPLE")],[a.TileType.YELLOW,s.ensureNotNull(this.yellow,this,"YELLOW")],[a.TileType.BOMB,s.ensureNotNull(this.bomb,this,"BOMB")],[a.TileType.HORIZONTAL_ROCKET,s.ensureNotNull(this.horizontalRocket,this,"HORIZONTAL_ROCKET")],[a.TileType.VERTICAL_ROCKET,s.ensureNotNull(this.verticalRocket,this,"VERTICAL_ROCKET")],[a.TileType.SUPER_BOMB,s.ensureNotNull(this.superBomb,this,"SUPER_BOMB")]]),this._highlightSprites=new Map([[a.TileType.EMPTY,s.ensureNotNull(this.empty,this,"EMPTY")],[a.TileType.RED,s.ensureNotNull(this.normalHighlight,this,"NORMAL_HIGHLIGHT")],[a.TileType.GREEN,s.ensureNotNull(this.normalHighlight,this,"NORMAL_HIGHLIGHT")],[a.TileType.BLUE,s.ensureNotNull(this.normalHighlight,this,"NORMAL_HIGHLIGHT")],[a.TileType.PURPLE,s.ensureNotNull(this.normalHighlight,this,"NORMAL_HIGHLIGHT")],[a.TileType.YELLOW,s.ensureNotNull(this.normalHighlight,this,"NORMAL_HIGHLIGHT")],[a.TileType.BOMB,s.ensureNotNull(this.bombHighlight,this,"BOMB_HIGHLIGHT")],[a.TileType.HORIZONTAL_ROCKET,s.ensureNotNull(this.horizontalRocketHighlight,this,"HORIZONTAL_ROCKET_HIGHLIGHT")],[a.TileType.VERTICAL_ROCKET,s.ensureNotNull(this.verticalRocketHighlight,this,"VERTICAL_ROCKET_HIGHLIGHT")],[a.TileType.SUPER_BOMB,s.ensureNotNull(this.superBombHighlight,this,"SUPER_BOMB_HIGHLIGHT")]])},t.prototype.getPrefab=function(){return this.tile},t.prototype.getMainSprite=function(e){var t=this._mainSprites.get(e);return r.assertNotNull(t,this,"Sprite for type "+a.TileType[e]),t},t.prototype.getHighlightSprite=function(e){var t=this._highlightSprites.get(e);return r.assertNotNull(t,this,"Sprite for type "+a.TileType[e]),t},i([l(cc.Prefab)],t.prototype,"tile",void 0),i([l(cc.SpriteFrame)],t.prototype,"empty",void 0),i([l(cc.SpriteFrame)],t.prototype,"red",void 0),i([l(cc.SpriteFrame)],t.prototype,"green",void 0),i([l(cc.SpriteFrame)],t.prototype,"blue",void 0),i([l(cc.SpriteFrame)],t.prototype,"purple",void 0),i([l(cc.SpriteFrame)],t.prototype,"yellow",void 0),i([l(cc.SpriteFrame)],t.prototype,"bomb",void 0),i([l(cc.SpriteFrame)],t.prototype,"horizontalRocket",void 0),i([l(cc.SpriteFrame)],t.prototype,"verticalRocket",void 0),i([l(cc.SpriteFrame)],t.prototype,"superBomb",void 0),i([l(cc.SpriteFrame)],t.prototype,"normalHighlight",void 0),i([l(cc.SpriteFrame)],t.prototype,"bombHighlight",void 0),i([l(cc.SpriteFrame)],t.prototype,"horizontalRocketHighlight",void 0),i([l(cc.SpriteFrame)],t.prototype,"verticalRocketHighlight",void 0),i([l(cc.SpriteFrame)],t.prototype,"superBombHighlight",void 0),t=i([u],t)}(cc.Component);o.TileAssets=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../../../core/utils/ensure":"ensure","../../../domain/board/models/TileType":"TileType"}],TileDestructionFxHolder:[function(e,t,o){"use strict";cc._RF.push(t,"3fc33hy+cBKaKNntQ5war44","TileDestructionFxHolder"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileDestructionFxHolder=void 0;var n=e("../../../../core/utils/random"),i=e("../../common/view/NodePool"),r=e("../events/ShardFaded"),s=e("./ShardView"),a=function(){function e(e,t,o,n,s){var a=this;this.onShardFaded=function(e){a._shardPool.release(e.node)},this._eventBus=e,this._burstInfo=t,this._shards=o,this._shardPool=new i.NodePool(o.getPrefab(),n,s*t.maxCount),this._eventBus.on(r.ShardFaded,this.onShardFaded)}return e.prototype.dispose=function(){this._shardPool.dispose(),this._eventBus.off(r.ShardFaded,this.onShardFaded)},e.prototype.play=function(e,t){for(var o=n.Random.intRange(this._burstInfo.minCount,this._burstInfo.maxCount),i=0;i<o;i++){var r=this._shardPool.pull().getComponent(s.ShardView);r.init(this._shards);var a=cc.v3(n.Random.floatRange(-this._burstInfo.spawnRadius,this._burstInfo.spawnRadius),n.Random.floatRange(-this._burstInfo.spawnRadius,this._burstInfo.spawnRadius),0);r.set(t),r.show(),r.node.setPosition(e.clone().add(a)),r.node.scale=n.Random.floatRange(this._burstInfo.minScale,this._burstInfo.maxScale);var c=n.Random.floatRange(-this._burstInfo.horizontalSpread,this._burstInfo.horizontalSpread)*Math.PI/180,u=n.Random.floatRange(this._burstInfo.minUpVelocity,this._burstInfo.maxUpVelocity),l=Math.sin(c)*u,p=Math.cos(c)*u,d=this._burstInfo.gravity,h=n.Random.floatRange(this._burstInfo.dragMin,this._burstInfo.dragMax),f=n.Random.floatRange(this._burstInfo.minAngular,this._burstInfo.maxAngular),_=this._burstInfo.duration,y=this._burstInfo.fadeDelay,v=this._burstInfo.shrinkScale;r.burst.play(this._eventBus,l,p,d,h,f,_,y,v)}},e}();o.TileDestructionFxHolder=a,cc._RF.pop()},{"../../../../core/utils/random":"random","../../common/view/NodePool":"NodePool","../events/ShardFaded":"ShardFaded","./ShardView":"ShardView"}],TileFactory:[function(e,t,o){"use strict";cc._RF.push(t,"f5173b4yopNF56G2A/Gy+sM","TileFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileFactory=void 0;var n=function(){function e(){this._nextId=0}return e.prototype.create=function(){return"tile_"+this._nextId++},e}();o.TileFactory=n,cc._RF.pop()},{}],TileFlashFxHolder:[function(e,t,o){"use strict";cc._RF.push(t,"cc770Mu7o9INJQ2/pFP0hYM","TileFlashFxHolder"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileFlashFxHolder=void 0;var n=e("../../common/animations/TweenSettings"),i=e("../../common/view/NodePool"),r=function(){function e(e,t,o,n){this._tweenSystem=e,this._prefab=t,this._flashPool=new i.NodePool(this._prefab,o,n)}return e.prototype.dispose=function(){this._flashPool.dispose()},e.prototype.play=function(e){var t=this,o=this._flashPool.pull();o.active=!0,o.setPosition(e),o.scale=1,o.opacity=0,this._tweenSystem.build(n.TweenSettings.flash(o)).call(function(){return t._flashPool.release(o)}).start()},e}();o.TileFlashFxHolder=r,cc._RF.pop()},{"../../common/animations/TweenSettings":"TweenSettings","../../common/view/NodePool":"NodePool"}],TileMutationHelper:[function(e,t,o){"use strict";cc._RF.push(t,"ca548z/0P5D9YGKLCo3XCci","TileMutationHelper"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileMutationHelper=void 0;var n=function(){function e(){}return e.shaked=function(e){return{kind:"tile.shaked",id:e}},e.destroyed=function(e,t,o){return{kind:"tile.destroy",id:e,destroyed:t,cause:o}},e.moved=function(e,t,o,n){return{kind:"tile.moved",id:e,from:t,to:o,cause:n}},e.spawned=function(e,t,o){return{kind:"tile.spawned",id:e,at:t,type:o}},e.transformed=function(e,t,o,n){return{kind:"tile.transformed",id:e,center:t,transformed:o,type:n}},e}();o.TileMutationHelper=n,cc._RF.pop()},{}],TilePositionRepo:[function(e,t,o){"use strict";cc._RF.push(t,"c1a25OU2p5GKqQooxzDoelD","TilePositionRepo"),Object.defineProperty(o,"__esModule",{value:!0}),o.TilePositionRepo=void 0;var n=function(){function e(){this._repo=new Map}return e.prototype.move=function(e,t){this._repo.set(e,{x:t.x,y:t.y})},e.prototype.get=function(e){var t=this._repo.get(e);return t?{x:t.x,y:t.y}:null},e.prototype.remove=function(e){this._repo.delete(e)},e}();o.TilePositionRepo=n,cc._RF.pop()},{}],TilePosition:[function(e,t,o){"use strict";cc._RF.push(t,"e31ab1Szq1KkpQ2i09M9pA2","TilePosition"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TileTypeRepo:[function(e,t,o){"use strict";cc._RF.push(t,"a379f6EbHxCE4BXyytkk2Ka","TileTypeRepo"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileTypeRepo=void 0;var n=function(){function e(){this._repo=new Map}return e.prototype.register=function(e,t){this._repo.set(e,t)},e.prototype.get=function(e){var t=this._repo.get(e);return t||null},e.prototype.remove=function(e){this._repo.delete(e)},e}();o.TileTypeRepo=n,cc._RF.pop()},{}],TileType:[function(e,t,o){"use strict";cc._RF.push(t,"ff92aR8Ym9CB7br3M3C8KnH","TileType"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileType=void 0,function(e){e[e.EMPTY=0]="EMPTY",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=3]="BLUE",e[e.PURPLE=4]="PURPLE",e[e.YELLOW=5]="YELLOW",e[e.BOMB=6]="BOMB",e[e.SUPER_BOMB=7]="SUPER_BOMB",e[e.HORIZONTAL_ROCKET=8]="HORIZONTAL_ROCKET",e[e.VERTICAL_ROCKET=9]="VERTICAL_ROCKET"}(o.TileType||(o.TileType={})),cc._RF.pop()},{}],TileViewHolder:[function(e,t,o){"use strict";cc._RF.push(t,"7c652yRrktK96Jo7chUMkGs","TileViewHolder"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileViewHolder=void 0;var n=e("../../../../core/utils/assert"),i=e("../../common/view/NodePool"),r=e("./TileView"),s=function(){function e(e,t,o){this._tiles=e,this._map=new Map,this._pool=new i.NodePool(this._tiles.getPrefab(),t,o)}return e.prototype.dispose=function(){this._pool.dispose()},e.prototype.pull=function(e,t){var o=this._pool.pull().getComponent(r.TileView);return n.assertNotNull(o,this,"pool is broken"),o.init(this._tiles),o.set(t),this._map.set(e,o),o},e.prototype.release=function(e){var t=this._map.get(e);t&&(this._pool.release(t.node),t.hide(),this._map.delete(e))},e}();o.TileViewHolder=s,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../common/view/NodePool":"NodePool","./TileView":"TileView"}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"0eda0LA+Q5BwrB21iLZDWRq","TileView");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileView=void 0;var r=e("../../../../core/utils/assert"),s=e("../../common/view/BaseView"),a=e("../../fx/DropMotion"),c=e("../../fx/SlingMotion"),u=cc._decorator,l=u.ccclass,p=u.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mainSprite=null,t.highlightRoot=null,t.highlightSprite=null,t.drop=null,t.sling=null,t}return n(t,e),t.prototype.validate=function(){e.prototype.validate.call(this),r.assertNotNull(this.mainSprite,this,"Sprite"),r.assertNotNull(this.drop,this,"DropMotion"),r.assertNotNull(this.sling,this,"SlingMotion")},t.prototype.init=function(e){this._assets=e},t.prototype.highlight=function(e){this.highlightRoot.active=e},t.prototype.show=function(){this.node.active=!0},t.prototype.hide=function(){this.node.active=!1},t.prototype.set=function(e){this.mainSprite.spriteFrame=this._assets.getMainSprite(e),this.highlightSprite.spriteFrame=this._assets.getHighlightSprite(e)},t.prototype.stabilize=function(){this.highlight(!1),this.node.setScale(1,1),this.node.angle=0,this.node.opacity=255,this.node.active=!0},i([p(cc.Sprite)],t.prototype,"mainSprite",void 0),i([p(cc.Node)],t.prototype,"highlightRoot",void 0),i([p(cc.Sprite)],t.prototype,"highlightSprite",void 0),i([p(a.DropMotion)],t.prototype,"drop",void 0),i([p(c.SlingMotion)],t.prototype,"sling",void 0),t=i([l],t)}(s.BaseView);o.TileView=d,cc._RF.pop()},{"../../../../core/utils/assert":"assert","../../common/view/BaseView":"BaseView","../../fx/DropMotion":"DropMotion","../../fx/SlingMotion":"SlingMotion"}],TileVisualAgentFactory:[function(e,t,o){"use strict";cc._RF.push(t,"e178a4bXWpLJoM3hUJ+TCHM","TileVisualAgentFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileVisualAgentFactory=void 0;var n=e("./TileVisualAgent"),i=function(){function e(e,t,o,n,i,r,s,a,c,u,l){this._visualConfig=e,this._eventBus=t,this._tweenSystem=o,this._pool=n,this._boardCols=i,this._boardRows=r,this._tilesLayer=s,this._fxLayer=a,this._destructionFx=c,this._rocketFx=u,this._flashFx=l}return e.prototype.create=function(e,t){var o=this._pool.pull(e,t);return new n.TileVisualAgent(this._visualConfig,this._eventBus,this._tweenSystem,e,o,t,this._boardCols,this._boardRows,this._tilesLayer,this._fxLayer,this._destructionFx,this._rocketFx,this._flashFx)},e}();o.TileVisualAgentFactory=i,cc._RF.pop()},{"./TileVisualAgent":"TileVisualAgent"}],TileVisualAgent:[function(e,t,o){"use strict";cc._RF.push(t,"0d826Kcf5hPF5BGQIQZpQiO","TileVisualAgent"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileVisualAgent=void 0;var n=e("../../common/animations/TweenSettings"),i=e("../../fx/RocketType"),r=e("../../utils/calc"),s=e("../events/VisualTileClicked"),a=e("../events/VisualTileDestroyed"),c=e("../events/VisualTileFlown"),u=e("../events/VisualTileLanded"),l=e("../events/VisualTileShaken"),p=e("../events/VisualTileSwapped"),d=e("../events/VisualTileTransformed"),h=function(){function e(e,t,o,n,i,r,s,a,c,u,l,p,d){this._visualConfig=e,this._eventBus=t,this._tweenSystem=o,this._id=n,this._view=i,this._type=r,this._boardCols=s,this._boardRows=a,this._nodeWidth=i.node.width,this._nodeHeight=i.node.height,this._tilesLayer=c,this._fxLayer=u,this._destructionFx=l,this._rocketFx=p,this._flashFx=d}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"busy",{get:function(){return this._view.drop.running||this._view.sling.running},enumerable:!1,configurable:!0}),e.prototype.spawn=function(e,t,o,n){var i=this;this._position=t;var r=this.local(t),s=this.local(o);this.prepare(r,o),this.subscribe(),this._view.drop.onDropped(function(){return i.landed(o)}),this._view.drop.play(r.y,s.y,n,this._visualConfig.drop)},e.prototype.drop=function(e,t){var o=this,n=this._view.node.position,i=this.local(e);this._view.drop.onDropped(function(){return o.landed(e)}),this._view.drop.play(n.y,i.y,t,this._visualConfig.drop)},e.prototype.swap=function(e){var t=this;this.sling(e,function(e){return t.swapped(e)})},e.prototype.fly=function(e){var t=this;this.highlight(!0),this.sling(e,function(e){return t.flown()})},e.prototype.sling=function(e,t){var o=cc.v2(this._view.node.position),n=this.local(e);this._view.sling.onSlinged(function(){return t(e)}),this._view.sling.play(o,n,this._visualConfig.sling)},e.prototype.destroy=function(){var e=this._view.node.position;this._destructionFx.play(e,this._type),this._flashFx.play(e),this.destroyed()},e.prototype.shake=function(){var e=this;this._tweenSystem.build(n.TweenSettings.shake(this._view.node)).call(function(){e._eventBus.emit(new l.VisualTileShaken(e._id))}).start()},e.prototype.transform=function(e){var t=this;this._type=e,this._view.set(e),this._tweenSystem.build(n.TweenSettings.pulse(this._view.node)).call(function(){t._eventBus.emit(new d.VisualTileTransformed(t._id))}).start()},e.prototype.launch=function(e){switch(e){case"horizontal_rocket":this._rocketFx.play(this.position,i.RocketDirection.LEFT),this._rocketFx.play(this.position,i.RocketDirection.RIGHT);break;case"vertical_rocket":this._rocketFx.play(this.position,i.RocketDirection.UP),this._rocketFx.play(this.position,i.RocketDirection.DOWN)}this.destroyed()},e.prototype.highlight=function(e){this._view.highlight(e),this._view.node.setParent(e?this._fxLayer:this._tilesLayer)},e.prototype.onClick=function(){this.busy||this._eventBus.emit(new s.VisualTileClicked(this.id))},e.prototype.prepare=function(e,t){this._view.stabilize(),this._view.node.setPosition(e),this._view.node.setSiblingIndex(t.y*this._boardCols+t.x),this._view.show()},e.prototype.hide=function(){this._view.hide()},e.prototype.subscribe=function(){this._view.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},e.prototype.unsubscribe=function(){this._view.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},e.prototype.landed=function(e){this._position=e,this._eventBus.emit(new u.VisualTileLanded(this._id,e))},e.prototype.swapped=function(e){this._position=e,this.highlight(!1),this._eventBus.emit(new p.VisualTileSwapped(this._id))},e.prototype.flown=function(){this.destroyed(),this._eventBus.emit(new c.VisualTileFlown(this._id))},e.prototype.destroyed=function(){this.highlight(!1),this.hide(),this.unsubscribe(),this._eventBus.emit(new a.VisualTileDestroyed(this._id))},e.prototype.local=function(e){return r.getLocal(e,this._boardCols,this._boardRows,this._nodeWidth,this._nodeHeight)},e}();o.TileVisualAgent=h,cc._RF.pop()},{"../../common/animations/TweenSettings":"TweenSettings","../../fx/RocketType":"RocketType","../../utils/calc":"calc","../events/VisualTileClicked":"VisualTileClicked","../events/VisualTileDestroyed":"VisualTileDestroyed","../events/VisualTileFlown":"VisualTileFlown","../events/VisualTileLanded":"VisualTileLanded","../events/VisualTileShaken":"VisualTileShaken","../events/VisualTileSwapped":"VisualTileSwapped","../events/VisualTileTransformed":"VisualTileTransformed"}],TileVisualOrchestrator:[function(e,t,o){"use strict";cc._RF.push(t,"79985Ho6MlB3pAuxEpEnlOu","TileVisualOrchestrator");var n=this&&this.__awaiter||function(e,t,o,n){function i(e){return e instanceof o?e:new o(function(t){t(e)})}return new(o||(o=Promise))(function(o,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){e.done?o(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.TileVisualOrchestrator=void 0;var r=e("../../../../core/eventbus/SubscriptionGroup"),s=e("../../../application/input/intents/SwapSelected"),a=e("../events/RocketCrossed"),c=e("../events/RocketOutOfBounds"),u=e("../events/VisualTileDestroyed"),l=e("../events/VisualTileFlown"),p=e("../events/VisualTileLanded"),d=e("./BoardPositionalModel"),h=e("./BoardVisualModel"),f=e("./RocketFxHolder"),_=e("./SafeDropMap"),y=e("./TileDestructionFxHolder"),v=e("./TileFlashFxHolder"),m=e("./TileViewHolder"),b=e("./TileVisualAgentFactory"),w=function(){function e(e,t,o,n,i,c,l,w,g,T,S,R){var O=this;this.onTileLanded=function(e){O._safeDropMap.subtract(e.id);var t=O._visualModel.get(e.id);t&&O._positionalModel.register(e.position,t)},this.onTileDestroyed=function(e){O._safeDropMap.subtract(e.id);var t=O._visualModel.get(e.id);t&&(O._positionalModel.remove(t.position),O._visualModel.remove(t.id),O._tilePool.release(t.id))},this.onSwapSelected=function(e){O.highlightTile(e.id,e.state)},this.onRocketCrossed=function(e){var t=O._positionalModel.get(e.position);t&&t.destroy()},this._eventBus=e,this._visualConfig=t,this._tweenSystem=o,this._boardCols=n,this._boardRows=i,this._backgroundLayer=c,this._tileLayer=l,this._fxLayer=w,this._tiles=g,this._shards=T,this._rockets=S,this._flash=R,this._visualModel=new h.BoardVisualModel,this._positionalModel=new d.BoardPositionalModel,this._safeDropMap=new _.SafeDropMap,this._tilePool=new m.TileViewHolder(this._tiles,this._tileLayer,this._boardCols*this._boardRows),this._destructionFx=new y.TileDestructionFxHolder(this._eventBus,this._visualConfig.burst,this._shards,this._fxLayer,this._boardCols*this._boardRows),this._flashFx=new v.TileFlashFxHolder(this._tweenSystem,this._flash,this._backgroundLayer,this._boardCols*this._boardRows),this._rocketFx=new f.RocketFxHolder(this._eventBus,this._visualConfig.rocket,this._rockets,this._fxLayer,this._boardCols,this._boardRows,this._visualConfig.tileWidth,this._visualConfig.tileHeight),this._visualAgentFactory=new b.TileVisualAgentFactory(this._visualConfig,this._eventBus,this._tweenSystem,this._tilePool,this._boardCols,this._boardRows,this._tileLayer,this._fxLayer,this._destructionFx,this._rocketFx,this._flashFx),this._disposables=[this._tilePool,this._destructionFx,this._flashFx],this._layers=[this._tileLayer,this._fxLayer],this._subscriptions=new r.SubscriptionGroup,this._subscriptions.add(this._eventBus.on(p.VisualTileLanded,this.onTileLanded)),this._subscriptions.add(this._eventBus.on(u.VisualTileDestroyed,this.onTileDestroyed)),this._subscriptions.add(this._eventBus.on(s.SwapSelected,this.onSwapSelected)),this._subscriptions.add(this._eventBus.on(a.RocketCrossed,this.onRocketCrossed))}return e.prototype.dispose=function(){this._subscriptions.clear(),this._disposables.forEach(function(e){return e.dispose()}),this._layers.forEach(function(e){return e.destroyAllChildren()})},e.prototype.init=function(e){var t=this;e.mutations.forEach(function(e){if("tile.spawned"===e.kind){var o=t._visualAgentFactory.create(e.id,e.type);t._visualModel.register(o);var n={x:e.at.x,y:-e.at.y-t._visualConfig.initialSpawnLine};t._positionalModel.register(e.at,o),o.spawn(e.type,n,e.at,t.getDropDelay(n))}})},e.prototype.dispatch=function(e){return n(this,void 0,Promise,function(){var t;return i(this,function(o){switch(o.label){case 0:return t=this.splitPhases(e),this.playShakes(t.shakes),[4,this.playTransforms(t.transforms)];case 1:return o.sent(),[4,this.playDestroys(t.destroys)];case 2:return o.sent(),this.playMoves(t.moves),this.playSpawns(t.spawns),[2]}})})},e.prototype.splitPhases=function(e){for(var t=[],o=[],n=[],i=[],r=[],s=0,a=e.mutations;s<a.length;s++){var c=a[s];switch(c.kind){case"tile.shaked":t.push(c);break;case"tile.transformed":o.push(c);break;case"tile.destroy":n.push(c);break;case"tile.moved":i.push(c);break;case"tile.spawned":r.push(c)}}return{shakes:t,transforms:o,destroys:n,moves:i,spawns:r}},e.prototype.playShakes=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t],i=this._visualModel.get(n.id);if(i){i.shake();break}}},e.prototype.playTransforms=function(e){return n(this,void 0,Promise,function(){var t,o,n,r,s,a=this;return i(this,function(c){switch(c.label){case 0:t=function(e){var t;return i(this,function(n){switch(n.label){case 0:return e.transformed.forEach(function(t){var o=a._visualModel.get(t);o&&o.fly(e.center)}),(t=o._visualModel.get(e.id))?(t.highlight(!0),e.transformed.length>0?[4,o._eventBus.waitForRemaining(l.VisualTileFlown,e.transformed.length)]:[3,2]):[2,"continue"];case 1:n.sent(),n.label=2;case 2:return t.highlight(!1),t.transform(e.type),[2]}})},o=this,n=0,r=e,c.label=1;case 1:return n<r.length?(s=r[n],[5,t(s)]):[3,4];case 2:c.sent(),c.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},e.prototype.playDestroys=function(e){return n(this,void 0,Promise,function(){var t,o,n,r,s=this;return i(this,function(i){switch(i.label){case 0:t=0,o=e,i.label=1;case 1:if(!(t<o.length))return[3,6];switch(n=o[t],n.cause){case"bomb":case"match":case"superbomb":return[3,2];case"horizontal_rocket":case"vertical_rocket":return[3,3]}return[3,5];case 2:return n.destroyed.forEach(function(e){var t=s._visualModel.get(e);t&&t.destroy()}),[3,5];case 3:return(r=this._visualModel.get(n.id))?(r.launch(n.cause),[4,this._eventBus.waitForRemaining(c.RocketOutOfBounds,2)]):[3,5];case 4:i.sent(),i.label=5;case 5:return t++,[3,1];case 6:return[2]}})})},e.prototype.playMoves=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t],i=this._visualModel.get(n.id);if(i)switch(n.cause){case"drop":i.drop(n.to,this.getDropDelay(n.from)),this._positionalModel.register(n.to,i);break;case"swap":i.swap(n.to),this._positionalModel.register(n.to,i)}}},e.prototype.playSpawns=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t],i=this._visualAgentFactory.create(n.id,n.type);this._visualModel.register(i),this._positionalModel.register(n.at,i),this._safeDropMap.add(n.at.x,i.id)}for(var r=0,s=e;r<s.length;r++){n=s[r],i=this._visualModel.get(n.id);var a=this._safeDropMap.get(n.at.x);if(i){var c={x:n.at.x,y:n.at.y-a-this._visualConfig.normalSpawnLine};i.spawn(n.type,c,n.at,this.getDropDelay(c))}}},e.prototype.highlightTile=function(e,t){var o=this._visualModel.get(e);o&&o.highlight(t)},e.prototype.getDropDelay=function(e){return(this._boardRows-e.y)*this._visualConfig.drop.delay},e}();o.TileVisualOrchestrator=w,cc._RF.pop()},{"../../../../core/eventbus/SubscriptionGroup":"SubscriptionGroup","../../../application/input/intents/SwapSelected":"SwapSelected","../events/RocketCrossed":"RocketCrossed","../events/RocketOutOfBounds":"RocketOutOfBounds","../events/VisualTileDestroyed":"VisualTileDestroyed","../events/VisualTileFlown":"VisualTileFlown","../events/VisualTileLanded":"VisualTileLanded","./BoardPositionalModel":"BoardPositionalModel","./BoardVisualModel":"BoardVisualModel","./RocketFxHolder":"RocketFxHolder","./SafeDropMap":"SafeDropMap","./TileDestructionFxHolder":"TileDestructionFxHolder","./TileFlashFxHolder":"TileFlashFxHolder","./TileViewHolder":"TileViewHolder","./TileVisualAgentFactory":"TileVisualAgentFactory"}],TransformService:[function(e,t,o){"use strict";cc._RF.push(t,"d68b1iqo1NKKLdySDGQF756","TransformService");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.TransformService=void 0;var i=e("../events/mutations/TileMutationHelper"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.tryTransform=function(e,t,o){var n=this.positionRepo.get(e);if(!n)return null;this.typeRepo.register(e,o);var r=t.filter(function(t){return t!==e});return i.TileMutationHelper.transformed(e,n,r,o)},t}(e("./BoardService").BoardService);o.TransformService=r,cc._RF.pop()},{"../events/mutations/TileMutationHelper":"TileMutationHelper","./BoardService":"BoardService"}],TransformationMutation:[function(e,t,o){"use strict";cc._RF.push(t,"00eb781v59D9IUZsta05k/z","TransformationMutation"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TweenHelper:[function(e,t,o){"use strict";cc._RF.push(t,"2ee8fX9cuhK1rpLwq9wgYPG","TweenHelper"),Object.defineProperty(o,"__esModule",{value:!0}),o.TweenHelper=void 0;var n=e("../../../../core/utils/assert"),i=e("./tweens/DestroyTween"),r=e("./tweens/ShakeTween"),s=e("./tweens/DropTween"),a=e("./tweens/FadeTween"),c=e("./tweens/BurstTween"),u=e("./tweens/FlashTween"),l=e("./tweens/PulseTween"),p=function(){function e(){this._tweens=new Map,this.register()}return e.prototype.register=function(){this.add(new i.DestroyTween),this.add(new a.FadeTween),this.add(new s.DropTween),this.add(new r.ShakeTween),this.add(new c.BurstTween),this.add(new u.FlashTween),this.add(new l.PulseTween)},e.prototype.add=function(e){this._tweens.set(e.type,e)},e.prototype.build=function(e){var t=this._tweens.get(e.type);return n.assertNotNull(t,this,"tween"),t.build(e)},e}();o.TweenHelper=p,cc._RF.pop()},{"../../../../core/utils/assert":"assert","./tweens/BurstTween":"BurstTween","./tweens/DestroyTween":"DestroyTween","./tweens/DropTween":"DropTween","./tweens/FadeTween":"FadeTween","./tweens/FlashTween":"FlashTween","./tweens/PulseTween":"PulseTween","./tweens/ShakeTween":"ShakeTween"}],TweenSettings:[function(e,t,o){"use strict";cc._RF.push(t,"0181cXWOh9Oia7D8sqe+9Xy","TweenSettings"),Object.defineProperty(o,"__esModule",{value:!0}),o.TweenSettings=void 0;var n=e("./tweens/TweenType"),i=function(){function e(){}return e.fade=function(e,t,o,i){return{type:n.TweenType.FADE,node:e,delay:t,duration:o,opacity:i}},e.drop=function(e,t){return{type:n.TweenType.DROP,node:e,duration:t}},e.destroy=function(e){return{type:n.TweenType.DESTROY,node:e,squashDuration:.05,squashScale:.95,popDuration:.03,popScale:1.2,shrinkDuration:.3,shrinkOpacity:0,shrinkScale:.2}},e.shake=function(e){return{type:n.TweenType.SHAKE,node:e,duration:.05,amplitude:8}},e.burst=function(e,t){return{type:n.TweenType.BURST,node:e,duration:t}},e.flash=function(e){return{type:n.TweenType.FLASH,node:e,durationIn:.3,scaleIn:1.4,durationOut:.4,scaleOut:2,peakOpacity:125}},e.pulse=function(e){return{type:n.TweenType.PULSE,node:e,durationIn:.125,scaleIn:1.2,durationOut:.125,scaleOut:1}},e}();o.TweenSettings=i,cc._RF.pop()},{"./tweens/TweenType":"TweenType"}],TweenSystem:[function(e,t,o){"use strict";cc._RF.push(t,"c0517IszVpO7YNyI08eZTCO","TweenSystem"),Object.defineProperty(o,"__esModule",{value:!0}),o.TweenSystem=void 0;var n=e("../TweenHelper"),i=function(){function e(){this._active=new Set,this._helper=new n.TweenHelper}return e.prototype.build=function(e){var t=this._helper.build(e);return this.track(t),t},e.prototype.track=function(e){this._active.add(e)},e.prototype.dispose=function(){this.killAll()},e.prototype.killAll=function(){this._active.forEach(function(e){return e.stop()}),this._active.clear()},e}();o.TweenSystem=i,cc._RF.pop()},{"../TweenHelper":"TweenHelper"}],TweenType:[function(e,t,o){"use strict";cc._RF.push(t,"4816dhJDk9IGJvlwlnEfHAF","TweenType"),Object.defineProperty(o,"__esModule",{value:!0}),o.TweenType=void 0,function(e){e[e.FADE=0]="FADE",e[e.DESTROY=1]="DESTROY",e[e.DROP=2]="DROP",e[e.SPAWN=3]="SPAWN",e[e.SHAKE=4]="SHAKE",e[e.BURST=5]="BURST",e[e.FLASH=6]="FLASH",e[e.PULSE=7]="PULSE"}(o.TweenType||(o.TweenType={})),cc._RF.pop()},{}],ValueChangedEvent:[function(e,t,o){"use strict";cc._RF.push(t,"323e3lkPd9Nzq1jCSpLjod2","ValueChangedEvent"),Object.defineProperty(o,"__esModule",{value:!0}),o.ValueChangedEvent=void 0;var n=function(){return function(e){this.value=e}}();o.ValueChangedEvent=n,cc._RF.pop()},{}],VisualConfigLoader:[function(e,t,o){"use strict";cc._RF.push(t,"e50a2oB6P5I3LE8/vlH/qdn","VisualConfigLoader");var n=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(o,"__esModule",{value:!0}),o.VisualConfigLoader=void 0;var i=e("../../settings/GameSettings"),r=e("../BaseConfigLoader"),s=e("./DefaultVisualConfigProvider"),a=e("./VisualConfigValidator"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.getJsonPath=function(){return i.GameSettings.VISUAL_CONFIG},t.prototype.createValidator=function(){return new a.VisualConfigValidator},t.prototype.getDefaultProvider=function(){return new s.DefaultVisualConfigProvider},t}(r.BaseConfigLoader);o.VisualConfigLoader=c,cc._RF.pop()},{"../../settings/GameSettings":"GameSettings","../BaseConfigLoader":"BaseConfigLoader","./DefaultVisualConfigProvider":"DefaultVisualConfigProvider","./VisualConfigValidator":"VisualConfigValidator"}],VisualConfigValidator:[function(e,t,o){"use strict";cc._RF.push(t,"ddcd1tnRPpEvq6CNyVNi8FC","VisualConfigValidator"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualConfigValidator=void 0;var n=e("../../../core/utils/ensure"),i=function(){function e(){}return e.prototype.validate=function(e){var t=n.ensureObject(e,this,"data"),o=n.ensureNumber(t.initialSpawnLine,this,"data.initialSpawnLine"),i=n.ensureNumber(t.normalSpawnLine,this,"data.normalSpawnLine"),r=n.ensureNumber(t.tileWidth,this,"data.nodeWidth"),s=n.ensureNumber(t.tileHeight,this,"data.nodeHeight"),a=n.ensureNumber(t.boardWidthPadding,this,"data.boardWidthPadding"),c=n.ensureNumber(t.boardHeightPadding,this,"data.boardWidthPadding"),u=n.ensureObject(t.burst,this,"data.burstData"),l=n.ensureNumber(u.minCount,this,"burstData.minCount"),p=n.ensureNumber(u.maxCount,this,"burstData.maxCount"),d=n.ensureNumber(u.minUpVelocity,this,"burstData.minUpVelocity"),h=n.ensureNumber(u.maxUpVelocity,this,"burstData.maxUpVelocity"),f=n.ensureNumber(u.horizontalSpread,this,"burstData.horizontalSpread"),_=n.ensureNumber(u.spawnRadius,this,"burstData.spawnRadius"),y=n.ensureNumber(u.minScale,this,"burstData.minScale"),v=n.ensureNumber(u.maxScale,this,"burstData.maxScale"),m=n.ensureNumber(u.minAngular,this,"burstData.minAngular"),b=n.ensureNumber(u.maxAngular,this,"burstData.maxAngular"),w=n.ensureNumber(u.gravity,this,"burstData.burstGravity"),g=n.ensureNumber(u.dragMin,this,"burstData.dragMin"),T=n.ensureNumber(u.dragMax,this,"burstData.dragMax"),S=n.ensureNumber(u.duration,this,"burstData.duration"),R=n.ensureNumber(u.fadeDelay,this,"burstData.fadeDelay"),O=n.ensureNumber(u.shrinkScale,this,"burstData.shrinkScale"),B=n.ensureObject(t.drop,this,"data.dropData"),P=n.ensureNumber(B.gravity,this,"data.gravity"),M=n.ensureNumber(B.delay,this,"dropData.delay"),F=n.ensureNumber(B.bounce,this,"dropData.bounce"),C=n.ensureNumber(B.bounceDuration,this,"dropData.bounceDuration"),x=n.ensureNumber(B.settleDuration,this,"dropData.settleDuration"),V=n.ensureObject(t.sling,this,"data.slingData"),D=n.ensureNumber(V.pullDistance,this,"slingData.pullDistance"),j=n.ensureNumber(V.overshootDistance,this,"slingData.overshootDistance"),N=n.ensureNumber(V.pullDuration,this,"slingData.pullDuration"),I=n.ensureNumber(V.launchSpeed,this,"slingData.launchSpeed"),E=n.ensureNumber(V.minLaunchDuration,this,"slingData.minLaunchDuration"),k=n.ensureNumber(V.maxLaunchDuration,this,"slingData.maxLaunchDuration"),L=n.ensureNumber(V.settleDuration,this,"slingData.settleDuration"),G=n.ensureNumber(V.disappearDistance,this,"slingData.disappearDistance"),A=n.ensureObject(t.rocket,this,"data.rocket");return{initialSpawnLine:o,normalSpawnLine:i,tileWidth:r,tileHeight:s,boardWidthPadding:a,boardHeightPadding:c,burst:{minCount:l,maxCount:p,minUpVelocity:d,maxUpVelocity:h,horizontalSpread:f,spawnRadius:_,minScale:y,maxScale:v,minAngular:m,maxAngular:b,gravity:w,dragMin:g,dragMax:T,duration:S,fadeDelay:R,shrinkScale:O},drop:{gravity:P,delay:M,bounce:F,bounceDuration:C,settleDuration:x},sling:{pullDistance:D,overshootDistance:j,pullDuration:N,launchSpeed:I,minLaunchDuration:E,maxLaunchDuration:k,settleDuration:L,disappearDistance:G},rocket:{speed:n.ensureNumber(A.speed,this,"rocketData.speed")}}},e}();o.VisualConfigValidator=i,cc._RF.pop()},{"../../../core/utils/ensure":"ensure"}],VisualConfig:[function(e,t,o){"use strict";cc._RF.push(t,"25d26/EYZxAhKvwNvzom8R5","VisualConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],VisualPhases:[function(e,t,o){"use strict";cc._RF.push(t,"3a2ddFGFkxBPZebcHWOEsqn","VisualPhases"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],VisualTileClicked:[function(e,t,o){"use strict";cc._RF.push(t,"c081cneN9VFJ6TlSo11wQM8","VisualTileClicked"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileClicked=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileClicked=n,cc._RF.pop()},{}],VisualTileDestroyed:[function(e,t,o){"use strict";cc._RF.push(t,"571a43upJFOpLGsEYQ1XXcu","VisualTileDestroyed"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileDestroyed=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileDestroyed=n,cc._RF.pop()},{}],VisualTileFlown:[function(e,t,o){"use strict";cc._RF.push(t,"4989eMHVoVOe5iGtI3iQGFY","VisualTileFlown"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileFlown=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileFlown=n,cc._RF.pop()},{}],VisualTileLanded:[function(e,t,o){"use strict";cc._RF.push(t,"052ebmrRydH9qnRJWl++HXK","VisualTileLanded"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileLanded=void 0;var n=function(){return function(e,t){this.id=e,this.position=t}}();o.VisualTileLanded=n,cc._RF.pop()},{}],VisualTileShaken:[function(e,t,o){"use strict";cc._RF.push(t,"e1ff7LH8LhDNYpPfTsiWuoQ","VisualTileShaken"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileShaken=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileShaken=n,cc._RF.pop()},{}],VisualTileSwapped:[function(e,t,o){"use strict";cc._RF.push(t,"052d68PQG1E/pfKbaHbhDnq","VisualTileSwapped"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileSwapped=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileSwapped=n,cc._RF.pop()},{}],VisualTileTransformed:[function(e,t,o){"use strict";cc._RF.push(t,"fe29a+c7v5MTbAggeXQJgXv","VisualTileTransformed"),Object.defineProperty(o,"__esModule",{value:!0}),o.VisualTileTransformed=void 0;var n=function(){return function(e){this.id=e}}();o.VisualTileTransformed=n,cc._RF.pop()},{}],algorithms:[function(e,t,o){"use strict";cc._RF.push(t,"f5e52IzeiFOF7YptTC83Tpo","algorithms"),Object.defineProperty(o,"__esModule",{value:!0}),o.intersection=void 0,o.intersection=function(e,t,o){var n=new Set(t),i=new Set(o);return e.filter(function(e){return n.has(e)&&i.has(e)})},cc._RF.pop()},{}],assert:[function(e,t,o){"use strict";function n(e,t,o){var n;if(n="function"==typeof t?t.name:t.constructor.name,!e)throw new Error("["+n+"] "+o)}function i(e,t,o){n(null!==e&&void 0!==e,t,o+" must not be null nor undefined")}function r(e,t,o){n(Array.isArray(e),t,o+" must be an array")}function s(e,t,o){n(e.length>0,t,o+" must not be empty")}cc._RF.push(t,"3cb7d9OgnZEJaI/WU7/lNKX","assert"),Object.defineProperty(o,"__esModule",{value:!0}),o.assertNumber=o.assertObject=o.assertString=o.assertNonEmptyArray=o.assertArrayNotEmpty=o.assertArray=o.assertNotNull=o.assert=void 0,o.assert=n,o.assertNotNull=i,o.assertArray=r,o.assertArrayNotEmpty=s,o.assertNonEmptyArray=function(e,t,o){r(e,t,o),s(e,t,o)},o.assertString=function(e,t,o){n("string"==typeof e,t,o+" must be string")},o.assertObject=function(e,t,o){n("object"==typeof e,t,o+" must be object"),i(e,t,o)},o.assertNumber=function(e,t,o){n("number"==typeof e&&!Number.isNaN(e),t,o+" must be number")},cc._RF.pop()},{}],calc:[function(e,t,o){"use strict";function n(e,t,o,n){var i=-(e-1)*o/2,r=(t-1)*n/2;return cc.v2(i,r)}cc._RF.push(t,"64e8aSSlcZIUo+/VlXg2quw","calc"),Object.defineProperty(o,"__esModule",{value:!0}),o.logicalEquals=o.outOfBounds=o.getLogical=o.getSpeed=o.getOrigin=o.getLocal=void 0,o.getLocal=function(e,t,o,i,r){var s=n(t,o,i,r);return cc.v2(s.x+e.x*i,s.y-e.y*r)},o.getOrigin=n,o.getSpeed=function(e,t){return e*t},o.getLogical=function(e,t,o,i,r){var s=n(t,o,i,r);return{x:Math.round((e.x-s.x)/i),y:Math.round((s.y-e.y)/r)}},o.outOfBounds=function(e,t,o){return e.x<-1||e.y<-1||e.x>t||e.y>o},o.logicalEquals=function(e,t){return e.x===t.x&&e.y===t.y},cc._RF.pop()},{}],ensure:[function(e,t,o){"use strict";cc._RF.push(t,"4a80emCBIlPbY4kzmojZq/X","ensure"),Object.defineProperty(o,"__esModule",{value:!0}),o.ensureEnumValue=o.ensureNonEmptyArray=o.ensureObject=o.ensureNotNull=o.ensureNumber=void 0;var n=e("./assert");o.ensureNumber=function(e,t,o){return n.assertNumber(e,t,o),e},o.ensureNotNull=function(e,t,o){return n.assertNotNull(e,t,o),e},o.ensureObject=function(e,t,o){return n.assertObject(e,t,o),e},o.ensureNonEmptyArray=function(e,t,o){return n.assertNotNull(e,t,o),n.assertNonEmptyArray(e,t,o),e},o.ensureEnumValue=function(e,t,o,i){var r=e[t];return n.assert(void 0!==r,o,"Unknown "+i+': "'+t+'"'),r},cc._RF.pop()},{"./assert":"assert"}],maths:[function(e,t,o){"use strict";cc._RF.push(t,"9c4a3hnjJVJE6Mq37M5kQQD","maths"),Object.defineProperty(o,"__esModule",{value:!0}),o.clamp=void 0,o.clamp=function(e,t,o){return Math.min(t,Math.max(e,o))},cc._RF.pop()},{}],random:[function(e,t,o){"use strict";cc._RF.push(t,"a5d9cezF4BFNIl1SShDyYsy","random"),Object.defineProperty(o,"__esModule",{value:!0}),o.Random=void 0;var n=function(){function e(){}return e.intRange=function(e,t){return e+Math.floor(Math.random()*(t-e))},e.floatRange=function(e,t){return e+Math.random()*(t-e)},e.float=function(){return Math.random()},e.pick=function(e){if(0===e.length)throw new Error("[Random] Cannot pick from empty array");return e[this.intRange(0,e.length)]},e}();o.Random=n,cc._RF.pop()},{}]},{},["Matrix","ConfigLoader","IConfig","IConfigValidator","BaseConfigProvider","IConfigProvider","JsonConfigProvider","EventBus","IEvent","Subscription","SubscriptionGroup","ValueChangedEvent","IDisposable","IInitializable","ILifecycle","IValidatable","algorithms","assert","ensure","maths","random","ApplicationGraph","BoardKey","BoardLogicController","BaseBoardStrategy","BoardStrategyFactory","BombStrategy","NormalStrategy","RocketStrategy","SpecialResolver","SuperBombStrategy","BoardInteractivityController","BoardInteractivityModel","BaseController","InputMode","InputController","BombEmplaceIntent","BoosterSelected","NormalIntent","SwapIntent","SwapSelected","GameStateController","BoosterIntentComplete","BoosterUsed","MovesUpdate","NormalIntentComplete","ScoreUpdate","StateUpdate","GameContext","GameSession","BaseConfigLoader","ConfigMode","DefaultGameConfigProvider","GameConfig","GameConfigLoader","GameConfigValidator","ThresholdType","DefaultVisualConfigProvider","VisualConfig","VisualConfigLoader","VisualConfigValidator","DomainGraph","BoardMutationsBatch","DestroyMutation","ITileMutation","MoveMutation","ShakeMutation","SpawnMutation","TileMutationHelper","TransformationMutation","BoardLogicModel","TileFactory","TilePosition","TilePositionRepo","TileType","TileTypeRepo","BoardService","DestroyService","MoveService","SearchService","SpawnService","TransformService","BoosterType","GameStateModel","GameStateType","ScoreService","GameEntry","PresentationGraph","PresentationInstaller","BoardViewContext","BoosterClicked","GameLoaded","GameRestartRequest","PresentationReady","RocketCrossed","RocketOutOfBounds","ShardFaded","VisualTileClicked","VisualTileDestroyed","VisualTileFlown","VisualTileLanded","VisualTileShaken","VisualTileSwapped","VisualTileTransformed","AltitudeMap","BoardPositionalModel","BoardView","BoardVisualModel","InitialBatchGate","RocketFxHolder","RocketView","SafeDropMap","ShardView","TileDestructionFxHolder","TileFlashFxHolder","TileView","TileViewHolder","TileVisualAgent","TileVisualAgentFactory","TileVisualOrchestrator","VisualPhases","TweenHelper","TweenSettings","BurstSettings","DestructionSettings","DropSettings","FadeSettings","FlashSettings","ITweenSettings","PulseSettings","ShakeSettings","BurstTween","DestroyTween","DropTween","FadeTween","FlashTween","ITween","PulseTween","ShakeTween","TweenSystem","TweenType","BoosterAssets","ColorRecord","RocketAssets","ShardAssets","TileAssets","DynamicTextViewContext","EventViewContext","BasePool","BaseView","ContextView","DynamicTextView","EventView","IClickable","IHighlightable","NodePool","PresentationView","PresentationViewContext","BurstMotion","DropMotion","RocketMotion","RocketType","SlingMotion","MovesTextViewContext","ScoreTextViewContext","MovesTextView","ScoreTextView","BoosterViewContext","GameOverPopupContext","LoadingScreenContext","ScreenFadeContext","BoosterView","GameOverPopup","IPopup","LoadingScreen","ScreenFade","calc","GameSettings"]);